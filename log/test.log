  [1m[35m (449.6ms)[0m  [1m[35mDROP DATABASE IF EXISTS "app_test"[0m
  [1m[35m (1182.7ms)[0m  [1m[35mCREATE DATABASE "app_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.4ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "accounts" CASCADE[0m
  [1m[35m (100.4ms)[0m  [1m[35mCREATE TABLE "accounts" ("id" bigserial primary key, "balance" integer DEFAULT 0, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL, "owner_id" integer, "owner_type" character varying)[0m
  [1m[35m (0.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "agencies" CASCADE[0m
  [1m[35m (97.6ms)[0m  [1m[35mCREATE TABLE "agencies" ("id" bigserial primary key, "business_name" character varying, "location" character varying, "user_id" bigint, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL)[0m
  [1m[35m (62.1ms)[0m  [1m[35mCREATE  INDEX  "index_agencies_on_user_id" ON "agencies"  ("user_id")[0m
  [1m[35m (0.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "transaktions" CASCADE[0m
  [1m[35m (89.3ms)[0m  [1m[35mCREATE TABLE "transaktions" ("id" bigserial primary key, "account_id" bigint, "trans_set" character varying, "balance" float, "trans_type" character varying, "amount" float, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL)[0m
  [1m[35m (52.5ms)[0m  [1m[35mCREATE  INDEX  "index_transaktions_on_account_id" ON "transaktions"  ("account_id")[0m
  [1m[35m (0.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "users" CASCADE[0m
  [1m[35m (85.8ms)[0m  [1m[35mCREATE TABLE "users" ("id" bigserial primary key, "email" character varying DEFAULT '' NOT NULL, "encrypted_password" character varying DEFAULT '' NOT NULL, "reset_password_token" character varying, "reset_password_sent_at" timestamp, "remember_created_at" timestamp, "phone_number" character varying, "full_name" character varying, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL, "jti" character varying DEFAULT '' NOT NULL)[0m
  [1m[35m (54.8ms)[0m  [1m[35mCREATE UNIQUE INDEX  "index_users_on_email" ON "users"  ("email")[0m
  [1m[35m (47.1ms)[0m  [1m[35mCREATE UNIQUE INDEX  "index_users_on_jti" ON "users"  ("jti")[0m
  [1m[35m (47.1ms)[0m  [1m[35mCREATE UNIQUE INDEX  "index_users_on_phone_number" ON "users"  ("phone_number")[0m
  [1m[35m (47.0ms)[0m  [1m[35mCREATE UNIQUE INDEX  "index_users_on_reset_password_token" ON "users"  ("reset_password_token")[0m
  [1m[35m (7.1ms)[0m  [1m[35mALTER TABLE "agencies" ADD CONSTRAINT "fk_rails_2b1d253475"
FOREIGN KEY ("user_id")
  REFERENCES "users" ("id")
[0m
  [1m[35m (6.9ms)[0m  [1m[35mALTER TABLE "transaktions" ADD CONSTRAINT "fk_rails_4a689f62f6"
FOREIGN KEY ("account_id")
  REFERENCES "accounts" ("id")
[0m
  [1m[35m (81.7ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[35m (1.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (12.6ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20190402130003)[0m
  [1m[35m (7.9ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20190325125401),
(20190326123830),
(20190320090349),
(20190326094204),
(20190327093807),
(20190320100604),
(20190320135338),
(20190327125103);

[0m
  [1m[35m (89.1ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (1.0ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.6ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "test"], ["created_at", "2019-04-17 08:20:18.853661"], ["updated_at", "2019-04-17 08:20:18.853661"]]
  [1m[35m (8.6ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
-------------------------------------
AgencyTest: test_should_create_agency
-------------------------------------
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "agencies"[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "usera@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234567"], ["LIMIT", 1]]
  [1m[36mUser Create (1.3ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "usera@domain.com"], ["encrypted_password", "$2a$04$.hp85A/xINiLjuk4lOKt6uvuGAosd1MNTPtwKDuik1LH9bK1/FhyC"], ["phone_number", "0701234567"], ["full_name", "first user"], ["created_at", "2019-04-17 08:20:19.130166"], ["updated_at", "2019-04-17 08:20:19.130166"], ["jti", "bb15b12c-8305-4758-9e82-26aa764644e2"]]
  [1m[36mAccount Create (1.2ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 08:20:19.168516"], ["updated_at", "2019-04-17 08:20:19.168516"], ["owner_id", 1], ["owner_type", "User"]]
  [1m[36mAccount Load (0.5ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 1], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAgency Create (2.0ms)[0m  [1m[32mINSERT INTO "agencies" ("business_name", "location", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["business_name", "Well chosen"], ["location", "kwa stima"], ["user_id", 1], ["created_at", "2019-04-17 08:20:19.176184"], ["updated_at", "2019-04-17 08:20:19.176184"]]
  [1m[36mAgency Load (0.5ms)[0m  [1m[34mSELECT  "agencies".* FROM "agencies" WHERE "agencies"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mAccount Load (0.4ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 1], ["owner_type", "Agency"], ["LIMIT", 1]]
  [1m[36mAccount Create (0.5ms)[0m  [1m[32mINSERT INTO "accounts" ("balance", "created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["balance", 100000], ["created_at", "2019-04-17 08:20:19.184482"], ["updated_at", "2019-04-17 08:20:19.184482"], ["owner_id", 1], ["owner_type", "Agency"]]
  [1m[36mAccount Load (0.4ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 1], ["owner_type", "Agency"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "agencies"[0m
  [1m[35m (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------
AgencyTest: test_should_have_a_single_account
---------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "userb@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234568"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "userb@domain.com"], ["encrypted_password", "$2a$04$VqfbcRI8SmVgiPwov1Fmmuvebct6TCxB9MyoPtDie7GbShpih0WYa"], ["phone_number", "0701234568"], ["full_name", "first user"], ["created_at", "2019-04-17 08:20:19.196327"], ["updated_at", "2019-04-17 08:20:19.196327"], ["jti", "c27155de-f5fb-4e95-a139-74301e6c8d9f"]]
  [1m[36mAccount Create (0.7ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 08:20:19.199258"], ["updated_at", "2019-04-17 08:20:19.199258"], ["owner_id", 2], ["owner_type", "User"]]
  [1m[36mAccount Load (0.6ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 2], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAgency Create (0.8ms)[0m  [1m[32mINSERT INTO "agencies" ("business_name", "location", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["business_name", "Well chosen"], ["location", "kwa stima"], ["user_id", 2], ["created_at", "2019-04-17 08:20:19.203856"], ["updated_at", "2019-04-17 08:20:19.203856"]]
  [1m[36mAgency Load (0.6ms)[0m  [1m[34mSELECT  "agencies".* FROM "agencies" WHERE "agencies"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mAccount Load (0.5ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 2], ["owner_type", "Agency"], ["LIMIT", 1]]
  [1m[36mAccount Create (0.5ms)[0m  [1m[32mINSERT INTO "accounts" ("balance", "created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["balance", 100000], ["created_at", "2019-04-17 08:20:19.208724"], ["updated_at", "2019-04-17 08:20:19.208724"], ["owner_id", 2], ["owner_type", "Agency"]]
  [1m[36mAccount Load (0.4ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 2], ["owner_type", "Agency"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "accounts"[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAgency Load (0.5ms)[0m  [1m[34mSELECT  "agencies".* FROM "agencies" WHERE "agencies"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mAccount Load (0.5ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 2], ["owner_type", "Agency"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "accounts"[0m
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------
AgencyTest: test_should_have_an_account_after_creation
------------------------------------------------------
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "accounts" WHERE "accounts"."owner_type" = $1[0m  [["owner_type", "Agency"]]
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "userc@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234569"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "userc@domain.com"], ["encrypted_password", "$2a$04$fM39UKXYeKI/rMWM8lcUg.z817TfiVmTdNSxi3/xcaMO718h.D2JC"], ["phone_number", "0701234569"], ["full_name", "first user"], ["created_at", "2019-04-17 08:20:19.226042"], ["updated_at", "2019-04-17 08:20:19.226042"], ["jti", "14ef1aa8-847c-4675-b379-362f670a63e6"]]
  [1m[36mAccount Create (0.5ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 08:20:19.228306"], ["updated_at", "2019-04-17 08:20:19.228306"], ["owner_id", 3], ["owner_type", "User"]]
  [1m[36mAccount Load (0.3ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 3], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAgency Create (0.7ms)[0m  [1m[32mINSERT INTO "agencies" ("business_name", "location", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["business_name", "Well chosen"], ["location", "kwa stima"], ["user_id", 3], ["created_at", "2019-04-17 08:20:19.231116"], ["updated_at", "2019-04-17 08:20:19.231116"]]
  [1m[36mAgency Load (0.5ms)[0m  [1m[34mSELECT  "agencies".* FROM "agencies" WHERE "agencies"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mAccount Load (0.3ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 3], ["owner_type", "Agency"], ["LIMIT", 1]]
  [1m[36mAccount Create (0.6ms)[0m  [1m[32mINSERT INTO "accounts" ("balance", "created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["balance", 100000], ["created_at", "2019-04-17 08:20:19.234783"], ["updated_at", "2019-04-17 08:20:19.234783"], ["owner_id", 3], ["owner_type", "Agency"]]
  [1m[36mAccount Load (0.3ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 3], ["owner_type", "Agency"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "accounts" WHERE "accounts"."owner_type" = $1[0m  [["owner_type", "Agency"]]
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------
AgencyTest: test_should_not_save_agency_with_missing_details
------------------------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.4ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
-----------------------------------
StatementMailerTest: test_mail_sent
-----------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "userd@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234570"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "userd@domain.com"], ["encrypted_password", "$2a$04$/t6zq7uWf1nNUCTXU5aCIuAi9Y4tfbH6NFuvGMbI8pMgbpKr1BlJO"], ["phone_number", "0701234570"], ["full_name", "first user"], ["created_at", "2019-04-17 08:20:20.396403"], ["updated_at", "2019-04-17 08:20:20.396403"], ["jti", "acc8765f-1308-4f4a-9f98-86acba6f3be9"]]
  [1m[36mAccount Create (0.4ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 08:20:20.398198"], ["updated_at", "2019-04-17 08:20:20.398198"], ["owner_id", 4], ["owner_type", "User"]]
  [1m[36mAccount Load (0.3ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 4], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "usere@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234571"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "usere@domain.com"], ["encrypted_password", "$2a$04$QCT22GaGZ4ZkSX0s9loouun.CdVgm/DybQxuOvpR95urUhxqbkdSe"], ["phone_number", "0701234571"], ["full_name", "first user"], ["created_at", "2019-04-17 08:20:20.403948"], ["updated_at", "2019-04-17 08:20:20.403948"], ["jti", "6dd9060e-d3e6-4aed-b7e5-0cfe4a28c260"]]
  [1m[36mAccount Create (0.4ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 08:20:20.405732"], ["updated_at", "2019-04-17 08:20:20.405732"], ["owner_id", 5], ["owner_type", "User"]]
  [1m[36mAccount Load (0.2ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 5], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  Rendering statement_mailer/send_statement.html.erb within layouts/mailer
  Rendered statement_mailer/send_statement.html.erb within layouts/mailer (0.5ms)
StatementMailer#send_statement: processed outbound mail in 6.7ms
Sent mail to userd@domain.com (6.3ms)
Date: Wed, 17 Apr 2019 08:20:20 +0000
From: from@example.com
To: userd@domain.com
Message-ID: <5cb6e1c46c819_122b091e8e268031792@416386ea621a.mail>
Subject: Statement
Mime-Version: 1.0
Content-Type: text/html;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <style>
      /* Email styles need to be inline */
    </style>
  </head>

  <body>
    <h1>Statement</h1>
    Total balance = 20000.00
  </body>
</html>

  [1m[35m (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
------------------------------------------
UsersControllerTest: test_Can_signup_users
------------------------------------------
Started POST "/users" for 127.0.0.1 at 2019-04-17 08:20:20 +0000
Processing by UsersController#create as JSON
  Parameters: {"data"=>{"type"=>"user", "attributes"=>{"email"=>"userf@domain.com", "password"=>"[FILTERED]", "phone_number"=>"0701234572", "full_name"=>"first user"}}}
Unpermitted parameter: :type
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "userf@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234572"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "userf@domain.com"], ["encrypted_password", "$2a$04$DY85xSq.m27eSBa45XvMeOAtAbIF/Tfs5jkXshrwOuQo.dCYSjZC."], ["phone_number", "0701234572"], ["full_name", "first user"], ["created_at", "2019-04-17 08:20:20.492472"], ["updated_at", "2019-04-17 08:20:20.492472"], ["jti", "86686054-c912-4a9c-967d-a3b1e4aaae0b"]]
  [1m[36mAccount Create (0.6ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 08:20:20.495178"], ["updated_at", "2019-04-17 08:20:20.495178"], ["owner_id", 6], ["owner_type", "User"]]
  [1m[36mAccount Load (0.3ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 6], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 13ms (Views: 0.4ms | ActiveRecord: 2.9ms)
  [1m[35m (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------
AgenciesControllerTest: test_should_show_agency
-----------------------------------------------
  [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "userg@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234573"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "userg@domain.com"], ["encrypted_password", "$2a$04$kjzxcMT8.mzjuVCxh3lr/OpD6x4w86uHwyb.eDsoR6zJz0VxNO7He"], ["phone_number", "0701234573"], ["full_name", "first user"], ["created_at", "2019-04-17 08:20:20.531092"], ["updated_at", "2019-04-17 08:20:20.531092"], ["jti", "fec07a29-9ee0-427f-8ac7-81acfd4a715f"]]
  [1m[36mAccount Create (0.6ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 08:20:20.533811"], ["updated_at", "2019-04-17 08:20:20.533811"], ["owner_id", 7], ["owner_type", "User"]]
  [1m[36mAccount Load (0.4ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 7], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/login" for 127.0.0.1 at 2019-04-17 08:20:20 +0000
Processing by LoginsController#new as JSON
Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------
LoginsControllerTest: test_can_sigin_registered_user
----------------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.0ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "userh@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234574"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "userh@domain.com"], ["encrypted_password", "$2a$04$..7gy0jR5IQSh7apCD/Cl.COkJ9CDGSfVck9/7EM7mp/zjKqDPo4G"], ["phone_number", "0701234574"], ["full_name", "first user"], ["created_at", "2019-04-17 08:20:20.550962"], ["updated_at", "2019-04-17 08:20:20.550962"], ["jti", "a1adbc01-639f-4589-afee-c829a215d349"]]
  [1m[36mAccount Create (0.4ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 08:20:20.554366"], ["updated_at", "2019-04-17 08:20:20.554366"], ["owner_id", 8], ["owner_type", "User"]]
  [1m[36mAccount Load (0.2ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 8], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/login" for 127.0.0.1 at 2019-04-17 08:20:20 +0000
Processing by LoginsController#new as JSON
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "userh@domain.com"], ["LIMIT", 1]]
Completed 200 OK in 4ms (Views: 0.2ms | ActiveRecord: 0.3ms)
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------------------
LoginsControllerTest: test_does_not_sign_in_unregistered_user
-------------------------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "userj@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234576"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "userj@domain.com"], ["encrypted_password", "$2a$04$RV26Rn7bVpNpeZrPmT5cOOYSGYQaSmOi7c7r2TrtIoZ80N.24IEjq"], ["phone_number", "0701234576"], ["full_name", "first user"], ["created_at", "2019-04-17 08:20:20.571208"], ["updated_at", "2019-04-17 08:20:20.571208"], ["jti", "f853a14b-f40b-450e-9d03-8598570ef34a"]]
  [1m[36mAccount Create (0.4ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 08:20:20.573295"], ["updated_at", "2019-04-17 08:20:20.573295"], ["owner_id", 9], ["owner_type", "User"]]
  [1m[36mAccount Load (0.3ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 9], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/login" for 127.0.0.1 at 2019-04-17 08:20:20 +0000
Processing by LoginsController#new as JSON
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "userk@domain.com"], ["LIMIT", 1]]
Completed 401 Unauthorized in 2ms (Views: 0.2ms | ActiveRecord: 0.6ms)
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------
LoginsControllerTest: test_should_logout_user
---------------------------------------------
  [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "userm@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234579"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "userm@domain.com"], ["encrypted_password", "$2a$04$JM1ruc1ZAxjBRBKgbuFTwu5YmhZsv7apf2B2oo7nNmKRd2bCB4oxe"], ["phone_number", "0701234579"], ["full_name", "first user"], ["created_at", "2019-04-17 08:20:20.590325"], ["updated_at", "2019-04-17 08:20:20.590325"], ["jti", "50d81277-cb39-48f1-87f0-680dd22d4d11"]]
  [1m[36mAccount Create (0.6ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 08:20:20.592578"], ["updated_at", "2019-04-17 08:20:20.592578"], ["owner_id", 10], ["owner_type", "User"]]
  [1m[36mAccount Load (0.3ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 10], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------
AccountTest: test_cannot_transfer_if_user_does_not_have_enough_balance
----------------------------------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "usero@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234581"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "usero@domain.com"], ["encrypted_password", "$2a$04$R4VDluAL3KWTayUd9hRS9OsnFORK.YYbeQJwZXAlQ9sxF0g/nO5n."], ["phone_number", "0701234581"], ["full_name", "first user"], ["created_at", "2019-04-17 08:20:20.603947"], ["updated_at", "2019-04-17 08:20:20.603947"], ["jti", "d1feca20-bf65-4cf9-aad3-32b8bdc4b252"]]
  [1m[36mAccount Create (0.5ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 08:20:20.606326"], ["updated_at", "2019-04-17 08:20:20.606326"], ["owner_id", 11], ["owner_type", "User"]]
  [1m[36mAccount Load (0.3ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 11], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "userp@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234582"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "userp@domain.com"], ["encrypted_password", "$2a$04$uZdxdc8rplVVs82rj1t2gO0ZGBWWOCvtXz5450C59rkUvpTShUAPa"], ["phone_number", "0701234582"], ["full_name", "first user"], ["created_at", "2019-04-17 08:20:20.614427"], ["updated_at", "2019-04-17 08:20:20.614427"], ["jti", "c8d1de82-12fd-41ac-a0f2-696ecbee7467"]]
  [1m[36mAccount Create (0.9ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 08:20:20.616754"], ["updated_at", "2019-04-17 08:20:20.616754"], ["owner_id", 12], ["owner_type", "User"]]
  [1m[36mAccount Load (0.3ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 12], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAccount Update (0.6ms)[0m  [1m[33mUPDATE "accounts" SET "balance" = $1, "updated_at" = $2 WHERE "accounts"."id" = $3[0m  [["balance", 100], ["updated_at", "2019-04-17 08:20:20.621437"], ["id", 15]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAccount Load (0.3ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 LIMIT $2[0m  [["id", 14], ["LIMIT", 1]]
  [1m[36mAccount Load (0.3ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "transaktions"[0m
  [1m[36mAccount Load (0.5ms)[0m  [1m[37mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 15], ["LIMIT", 1]]
  [1m[36mAccount Load (0.4ms)[0m  [1m[37mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 14], ["LIMIT", 1]]
  [1m[36mTransaktion Load (0.4ms)[0m  [1m[34mSELECT  "transaktions".* FROM "transaktions" ORDER BY "transaktions"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 11], ["LIMIT", 1]]
  [1m[36mAccount Update (0.7ms)[0m  [1m[33mUPDATE "accounts" SET "balance" = $1, "updated_at" = $2 WHERE "accounts"."id" = $3[0m  [["balance", 1000], ["updated_at", "2019-04-17 08:20:20.684777"], ["id", 14]]
  [1m[36mTransaktion Create (1.5ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 14], ["trans_set", "AAAA0001"], ["balance", 1000.0], ["trans_type", "credit"], ["amount", 1000.0], ["created_at", "2019-04-17 08:20:20.686338"], ["updated_at", "2019-04-17 08:20:20.686338"]]
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 12], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "transaktions"[0m
  [1m[36mAccount Load (0.5ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  [1m[36mAccount Load (0.6ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 LIMIT $2[0m  [["id", 14], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------
AccountTest: test_user_cannot_have_multiple_accounts
----------------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "userq@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234583"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "userq@domain.com"], ["encrypted_password", "$2a$04$q9JmzFJkrTV38qUE9/NAMuT6rhH42f1o8q5Q2PjWTWinoHITVdtNa"], ["phone_number", "0701234583"], ["full_name", "first user"], ["created_at", "2019-04-17 08:20:20.707120"], ["updated_at", "2019-04-17 08:20:20.707120"], ["jti", "120a7921-d1a9-4454-a3f1-d81eaafd28ac"]]
  [1m[36mAccount Create (0.7ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 08:20:20.711456"], ["updated_at", "2019-04-17 08:20:20.711456"], ["owner_id", 13], ["owner_type", "User"]]
  [1m[36mAccount Load (0.4ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 13], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAccount Destroy (1.2ms)[0m  [1m[31mDELETE FROM "accounts" WHERE "accounts"."id" = $1[0m  [["id", 16]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 AND "users"."id" != $2 LIMIT $3[0m  [["phone_number", "0701234583"], ["id", 13], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
---------------------------------------
AccountTest: test_transfer_class_method
---------------------------------------
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "userr@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234584"], ["LIMIT", 1]]
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "userr@domain.com"], ["encrypted_password", "$2a$04$ntcvbOpqp0Mm4CJ3jskCVe7lv2auuKsEOfS2O/B0kzsK2OuvbLih."], ["phone_number", "0701234584"], ["full_name", "first user"], ["created_at", "2019-04-17 08:20:20.727984"], ["updated_at", "2019-04-17 08:20:20.727984"], ["jti", "b6776630-4fec-406e-ae88-1f27ac8f9985"]]
  [1m[36mAccount Create (0.6ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 08:20:20.730799"], ["updated_at", "2019-04-17 08:20:20.730799"], ["owner_id", 14], ["owner_type", "User"]]
  [1m[36mAccount Load (0.3ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 14], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "users@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234585"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "users@domain.com"], ["encrypted_password", "$2a$04$GoAS7LhdMcII0iD0fyI4kOB7KD4rrxPSRJQNt0/XVHAvrcSED1AhS"], ["phone_number", "0701234585"], ["full_name", "first user"], ["created_at", "2019-04-17 08:20:20.739873"], ["updated_at", "2019-04-17 08:20:20.739873"], ["jti", "b5f0d0cb-b59b-44e8-88d6-636f26bd8199"]]
  [1m[36mAccount Create (0.6ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 08:20:20.742752"], ["updated_at", "2019-04-17 08:20:20.742752"], ["owner_id", 15], ["owner_type", "User"]]
  [1m[36mAccount Load (0.4ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 15], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAccount Update (0.6ms)[0m  [1m[33mUPDATE "accounts" SET "balance" = $1, "updated_at" = $2 WHERE "accounts"."id" = $3[0m  [["balance", 10000], ["updated_at", "2019-04-17 08:20:20.747512"], ["id", 18]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAccount Load (0.4ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 LIMIT $2[0m  [["id", 17], ["LIMIT", 1]]
  [1m[36mAccount Load (0.4ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 LIMIT $2[0m  [["id", 18], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "transaktions"[0m
  [1m[36mAccount Load (0.5ms)[0m  [1m[37mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 18], ["LIMIT", 1]]
  [1m[36mAccount Load (0.5ms)[0m  [1m[37mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 17], ["LIMIT", 1]]
  [1m[36mTransaktion Load (0.4ms)[0m  [1m[34mSELECT  "transaktions".* FROM "transaktions" ORDER BY "transaktions"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 14], ["LIMIT", 1]]
  [1m[36mAccount Update (0.6ms)[0m  [1m[33mUPDATE "accounts" SET "balance" = $1, "updated_at" = $2 WHERE "accounts"."id" = $3[0m  [["balance", 100], ["updated_at", "2019-04-17 08:20:20.758854"], ["id", 17]]
  [1m[36mTransaktion Create (0.7ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 17], ["trans_set", "AAAA0001"], ["balance", 100.0], ["trans_type", "credit"], ["amount", 100.0], ["created_at", "2019-04-17 08:20:20.760284"], ["updated_at", "2019-04-17 08:20:20.760284"]]
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  [1m[36mAccount Update (0.6ms)[0m  [1m[33mUPDATE "accounts" SET "balance" = $1, "updated_at" = $2 WHERE "accounts"."id" = $3[0m  [["balance", 9900], ["updated_at", "2019-04-17 08:20:20.763492"], ["id", 18]]
  [1m[36mTransaktion Create (0.7ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 18], ["trans_set", "AAAA0001"], ["balance", 9900.0], ["trans_type", "debit"], ["amount", 100.0], ["created_at", "2019-04-17 08:20:20.765255"], ["updated_at", "2019-04-17 08:20:20.765255"]]
  [1m[36mTransaktion Load (0.6ms)[0m  [1m[34mSELECT  "transaktions".* FROM "transaktions" WHERE "transaktions"."account_id" = $1 ORDER BY "transaktions"."id" DESC LIMIT $2[0m  [["account_id", 18], ["LIMIT", 1]]
  [1m[36mTransaktion Load (0.5ms)[0m  [1m[34mSELECT  "transaktions".* FROM "transaktions" WHERE "transaktions"."account_id" = $1 ORDER BY "transaktions"."id" DESC LIMIT $2[0m  [["account_id", 17], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "transaktions"[0m
  [1m[36mAccount Load (0.3ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 LIMIT $2[0m  [["id", 18], ["LIMIT", 1]]
  [1m[36mAccount Load (0.3ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 LIMIT $2[0m  [["id", 17], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
---------------------------------
UserTest: test_password_is_strong
---------------------------------
  [1m[36mUser Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 AND "users"."id" != $2 LIMIT $3[0m  [["phone_number", "0701234586"], ["id", 1001], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
-----------------------
UserTest: test_withdraw
-----------------------
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "useru@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234587"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "useru@domain.com"], ["encrypted_password", "$2a$04$CgQqvTDb/oAMjK7dzLLn/uEA.7XDq4VjRs9.PPiAYCBTIgFvLa7ky"], ["phone_number", "0701234587"], ["full_name", "first user"], ["created_at", "2019-04-17 08:20:20.786183"], ["updated_at", "2019-04-17 08:20:20.786183"], ["jti", "8943ff5f-5310-4be5-8036-131e57801c12"]]
  [1m[36mAccount Create (0.5ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 08:20:20.788683"], ["updated_at", "2019-04-17 08:20:20.788683"], ["owner_id", 16], ["owner_type", "User"]]
  [1m[36mAccount Load (0.3ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 16], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAgency Create (0.7ms)[0m  [1m[32mINSERT INTO "agencies" ("business_name", "location", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["business_name", "Well chosen"], ["location", "kwa stima"], ["user_id", 16], ["created_at", "2019-04-17 08:20:20.791683"], ["updated_at", "2019-04-17 08:20:20.791683"]]
  [1m[36mAgency Load (0.4ms)[0m  [1m[34mSELECT  "agencies".* FROM "agencies" WHERE "agencies"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  [1m[36mAccount Load (0.3ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 4], ["owner_type", "Agency"], ["LIMIT", 1]]
  [1m[36mAccount Create (0.4ms)[0m  [1m[32mINSERT INTO "accounts" ("balance", "created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["balance", 100000], ["created_at", "2019-04-17 08:20:20.795402"], ["updated_at", "2019-04-17 08:20:20.795402"], ["owner_id", 4], ["owner_type", "Agency"]]
  [1m[36mAccount Load (0.2ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 4], ["owner_type", "Agency"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "userv@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234588"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "userv@domain.com"], ["encrypted_password", "$2a$04$S/Nyuw.5EXpVLfegLAuRS.h2uZwBdUjhGH7y8Nr9H8EArniAWRp7u"], ["phone_number", "0701234588"], ["full_name", "first user"], ["created_at", "2019-04-17 08:20:20.802013"], ["updated_at", "2019-04-17 08:20:20.802013"], ["jti", "957d52f6-c3cc-4925-9303-def4d2c4b6ea"]]
  [1m[36mAccount Create (0.6ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 08:20:20.805049"], ["updated_at", "2019-04-17 08:20:20.805049"], ["owner_id", 17], ["owner_type", "User"]]
  [1m[36mAccount Load (0.3ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 17], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAccount Update (0.5ms)[0m  [1m[33mUPDATE "accounts" SET "balance" = $1, "updated_at" = $2 WHERE "accounts"."id" = $3[0m  [["balance", 1000], ["updated_at", "2019-04-17 08:20:20.808988"], ["id", 21]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "4"], ["LIMIT", 1]]
  [1m[36mAgency Load (0.4ms)[0m  [1m[34mSELECT  "agencies".* FROM "agencies" WHERE "agencies"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  [1m[36mAccount Load (0.3ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 4], ["owner_type", "Agency"], ["LIMIT", 1]]
  [1m[36mAccount Load (0.6ms)[0m  [1m[37mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 21], ["LIMIT", 1]]
  [1m[36mAccount Load (0.5ms)[0m  [1m[37mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 20], ["LIMIT", 1]]
  [1m[36mTransaktion Load (0.3ms)[0m  [1m[34mSELECT  "transaktions".* FROM "transaktions" ORDER BY "transaktions"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAgency Load (0.5ms)[0m  [1m[34mSELECT  "agencies".* FROM "agencies" WHERE "agencies"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  [1m[36mAccount Update (0.6ms)[0m  [1m[33mUPDATE "accounts" SET "balance" = $1, "updated_at" = $2 WHERE "accounts"."id" = $3[0m  [["balance", 101000], ["updated_at", "2019-04-17 08:20:20.822232"], ["id", 20]]
  [1m[36mTransaktion Create (0.8ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 20], ["trans_set", "AAAA0001"], ["balance", 101000.0], ["trans_type", "withdrawal"], ["amount", 1000.0], ["created_at", "2019-04-17 08:20:20.823785"], ["updated_at", "2019-04-17 08:20:20.823785"]]
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 17], ["LIMIT", 1]]
  [1m[36mAccount Update (0.6ms)[0m  [1m[33mUPDATE "accounts" SET "balance" = $1, "updated_at" = $2 WHERE "accounts"."id" = $3[0m  [["balance", 0], ["updated_at", "2019-04-17 08:20:20.827449"], ["id", 21]]
  [1m[36mTransaktion Create (0.7ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 21], ["trans_set", "AAAA0001"], ["balance", 0.0], ["trans_type", "withdrawal"], ["amount", 1000.0], ["created_at", "2019-04-17 08:20:20.828920"], ["updated_at", "2019-04-17 08:20:20.828920"]]
  [1m[36mTransaktion Load (0.5ms)[0m  [1m[34mSELECT  "transaktions".* FROM "transaktions" WHERE "transaktions"."account_id" = $1 ORDER BY "transaktions"."id" DESC LIMIT $2[0m  [["account_id", 21], ["LIMIT", 1]]
  [1m[36mTransaktion Load (0.7ms)[0m  [1m[34mSELECT  "transaktions".* FROM "transaktions" WHERE "transaktions"."account_id" = $1 ORDER BY "transaktions"."id" DESC LIMIT $2[0m  [["account_id", 20], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mAgency Load (0.2ms)[0m  [1m[34mSELECT  "agencies".* FROM "agencies" WHERE "agencies"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  [1m[36mAccount Load (0.2ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 4], ["owner_type", "Agency"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------
UserTest: test_account_is_created_on_user_creation
--------------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "accounts"[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "userw@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234589"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "userw@domain.com"], ["encrypted_password", "$2a$04$KRLeKFGjwNcfJLaVBq5FYOMKVxEPxmYfgTtbDpZtQtupKqnnyFgFC"], ["phone_number", "0701234589"], ["full_name", "first user"], ["created_at", "2019-04-17 08:20:20.845242"], ["updated_at", "2019-04-17 08:20:20.845242"], ["jti", "e53d1934-4926-4bbc-bada-e48e0e84066f"]]
  [1m[36mAccount Create (0.5ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 08:20:20.848808"], ["updated_at", "2019-04-17 08:20:20.848808"], ["owner_id", 18], ["owner_type", "User"]]
  [1m[36mAccount Load (0.3ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 18], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "accounts"[0m
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------
UserTest: test_phone_number_is_of_correct_format
------------------------------------------------
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 AND "users"."id" != $2 LIMIT $3[0m  [["phone_number", "0736234234"], ["id", 1002], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------
UserTest: test_cannot_deposit_or_withdraw_if_not_an_agent
---------------------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
----------------------------
UserTest: test_user_is_valid
----------------------------
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "usery@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234590"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
----------------------
UserTest: test_deposit
----------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "userz@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234591"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "userz@domain.com"], ["encrypted_password", "$2a$04$APEhs41QOhevoOyAXmeNF.1fhe8p3.I1UkfncpAyFzNObBroiFnj6"], ["phone_number", "0701234591"], ["full_name", "first user"], ["created_at", "2019-04-17 08:20:20.877483"], ["updated_at", "2019-04-17 08:20:20.877483"], ["jti", "1d28ce39-2773-4842-9b36-c843d61df920"]]
  [1m[36mAccount Create (0.6ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 08:20:20.879577"], ["updated_at", "2019-04-17 08:20:20.879577"], ["owner_id", 19], ["owner_type", "User"]]
  [1m[36mAccount Load (0.3ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 19], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAgency Create (0.8ms)[0m  [1m[32mINSERT INTO "agencies" ("business_name", "location", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["business_name", "Well chosen"], ["location", "kwa stima"], ["user_id", 19], ["created_at", "2019-04-17 08:20:20.884197"], ["updated_at", "2019-04-17 08:20:20.884197"]]
  [1m[36mAgency Load (0.4ms)[0m  [1m[34mSELECT  "agencies".* FROM "agencies" WHERE "agencies"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  [1m[36mAccount Load (0.4ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 5], ["owner_type", "Agency"], ["LIMIT", 1]]
  [1m[36mAccount Create (0.6ms)[0m  [1m[32mINSERT INTO "accounts" ("balance", "created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["balance", 100000], ["created_at", "2019-04-17 08:20:20.891051"], ["updated_at", "2019-04-17 08:20:20.891051"], ["owner_id", 5], ["owner_type", "Agency"]]
  [1m[36mAccount Load (0.3ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 5], ["owner_type", "Agency"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "useraa@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234592"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "useraa@domain.com"], ["encrypted_password", "$2a$04$ElvOhFnnjuAeVxwW6738nuuqnq7C57gK2oCnqUQ5.uT5wgAHg7BIG"], ["phone_number", "0701234592"], ["full_name", "first user"], ["created_at", "2019-04-17 08:20:20.918779"], ["updated_at", "2019-04-17 08:20:20.918779"], ["jti", "5739f319-752c-4e2b-8d6d-b25441c8b96a"]]
  [1m[36mAccount Create (0.4ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 08:20:20.920637"], ["updated_at", "2019-04-17 08:20:20.920637"], ["owner_id", 20], ["owner_type", "User"]]
  [1m[36mAccount Load (0.2ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 20], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 20], ["LIMIT", 1]]
  [1m[36mAccount Load (0.3ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 20], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234592"], ["LIMIT", 1]]
  [1m[36mAccount Load (0.3ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 20], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[36mAccount Load (0.5ms)[0m  [1m[37mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 24], ["LIMIT", 1]]
  [1m[36mAccount Load (0.5ms)[0m  [1m[37mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 25], ["LIMIT", 1]]
  [1m[36mTransaktion Load (0.4ms)[0m  [1m[34mSELECT  "transaktions".* FROM "transaktions" ORDER BY "transaktions"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 20], ["LIMIT", 1]]
  [1m[36mAccount Update (0.6ms)[0m  [1m[33mUPDATE "accounts" SET "balance" = $1, "updated_at" = $2 WHERE "accounts"."id" = $3[0m  [["balance", 1000], ["updated_at", "2019-04-17 08:20:20.931651"], ["id", 25]]
  [1m[36mTransaktion Create (0.7ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 25], ["trans_set", "AAAA0001"], ["balance", 1000.0], ["trans_type", "deposit"], ["amount", 1000.0], ["created_at", "2019-04-17 08:20:20.933096"], ["updated_at", "2019-04-17 08:20:20.933096"]]
  [1m[36mAgency Load (0.3ms)[0m  [1m[34mSELECT  "agencies".* FROM "agencies" WHERE "agencies"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  [1m[36mAccount Update (0.5ms)[0m  [1m[33mUPDATE "accounts" SET "balance" = $1, "updated_at" = $2 WHERE "accounts"."id" = $3[0m  [["balance", 99000], ["updated_at", "2019-04-17 08:20:20.935887"], ["id", 24]]
  [1m[36mTransaktion Create (0.5ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 24], ["trans_set", "AAAA0001"], ["balance", 99000.0], ["trans_type", "deposit"], ["amount", 1000.0], ["created_at", "2019-04-17 08:20:20.937271"], ["updated_at", "2019-04-17 08:20:20.937271"]]
  [1m[36mTransaktion Load (0.5ms)[0m  [1m[34mSELECT  "transaktions".* FROM "transaktions" WHERE "transaktions"."account_id" = $1 ORDER BY "transaktions"."id" DESC LIMIT $2[0m  [["account_id", 24], ["LIMIT", 1]]
  [1m[36mTransaktion Load (0.4ms)[0m  [1m[34mSELECT  "transaktions".* FROM "transaktions" WHERE "transaktions"."account_id" = $1 ORDER BY "transaktions"."id" DESC LIMIT $2[0m  [["account_id", 25], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 20], ["LIMIT", 1]]
  [1m[36mAccount Load (0.3ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 20], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
-------------------------
UserTest: test_send_money
-------------------------
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "userab@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234593"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "userab@domain.com"], ["encrypted_password", "$2a$04$p5M9M4gSF6eu7h3oyftxk.5G6MjxDVQj76KGvpXaYkuZ6CBBhi41a"], ["phone_number", "0701234593"], ["full_name", "first user"], ["created_at", "2019-04-17 08:20:20.950259"], ["updated_at", "2019-04-17 08:20:20.950259"], ["jti", "e308c5e9-7173-44f8-bae3-3beea78f6d8f"]]
  [1m[36mAccount Create (0.5ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 08:20:20.952941"], ["updated_at", "2019-04-17 08:20:20.952941"], ["owner_id", 21], ["owner_type", "User"]]
  [1m[36mAccount Load (0.2ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 21], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAccount Update (0.6ms)[0m  [1m[33mUPDATE "accounts" SET "balance" = $1, "updated_at" = $2 WHERE "accounts"."id" = $3[0m  [["balance", 10000], ["updated_at", "2019-04-17 08:20:20.956322"], ["id", 26]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "userac@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234594"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "userac@domain.com"], ["encrypted_password", "$2a$04$5pJjBiYqo9ud4jv1YIjNLe6e.FDHLCX1JIYJO0OIA7SetfcJlaZQ."], ["phone_number", "0701234594"], ["full_name", "first user"], ["created_at", "2019-04-17 08:20:20.962117"], ["updated_at", "2019-04-17 08:20:20.962117"], ["jti", "e7ae10a4-a374-483b-8236-14498078c167"]]
  [1m[36mAccount Create (0.5ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 08:20:20.963969"], ["updated_at", "2019-04-17 08:20:20.963969"], ["owner_id", 22], ["owner_type", "User"]]
  [1m[36mAccount Load (0.3ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 22], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 22], ["LIMIT", 1]]
  [1m[36mAccount Load (0.3ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 22], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234594"], ["LIMIT", 1]]
  [1m[36mAccount Load (0.5ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 22], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[36mAccount Load (0.6ms)[0m  [1m[37mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 26], ["LIMIT", 1]]
  [1m[36mAccount Load (0.5ms)[0m  [1m[37mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 27], ["LIMIT", 1]]
  [1m[36mTransaktion Load (0.4ms)[0m  [1m[34mSELECT  "transaktions".* FROM "transaktions" ORDER BY "transaktions"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 22], ["LIMIT", 1]]
  [1m[36mAccount Update (0.6ms)[0m  [1m[33mUPDATE "accounts" SET "balance" = $1, "updated_at" = $2 WHERE "accounts"."id" = $3[0m  [["balance", 1000], ["updated_at", "2019-04-17 08:20:20.979105"], ["id", 27]]
  [1m[36mTransaktion Create (0.6ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 27], ["trans_set", "AAAA0001"], ["balance", 1000.0], ["trans_type", "transfer"], ["amount", 1000.0], ["created_at", "2019-04-17 08:20:20.980954"], ["updated_at", "2019-04-17 08:20:20.980954"]]
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 21], ["LIMIT", 1]]
  [1m[36mAccount Update (0.6ms)[0m  [1m[33mUPDATE "accounts" SET "balance" = $1, "updated_at" = $2 WHERE "accounts"."id" = $3[0m  [["balance", 9000], ["updated_at", "2019-04-17 08:20:20.983880"], ["id", 26]]
  [1m[36mTransaktion Create (0.5ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 26], ["trans_set", "AAAA0001"], ["balance", 9000.0], ["trans_type", "transfer"], ["amount", 1000.0], ["created_at", "2019-04-17 08:20:20.985477"], ["updated_at", "2019-04-17 08:20:20.985477"]]
  [1m[36mTransaktion Load (0.3ms)[0m  [1m[34mSELECT  "transaktions".* FROM "transaktions" WHERE "transaktions"."account_id" = $1 ORDER BY "transaktions"."id" DESC LIMIT $2[0m  [["account_id", 26], ["LIMIT", 1]]
  [1m[36mTransaktion Load (0.2ms)[0m  [1m[34mSELECT  "transaktions".* FROM "transaktions" WHERE "transaktions"."account_id" = $1 ORDER BY "transaktions"."id" DESC LIMIT $2[0m  [["account_id", 27], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 22], ["LIMIT", 1]]
  [1m[36mAccount Load (0.2ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 22], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
----------------------------------------
TransactionsControllerTest: test_deposit
----------------------------------------
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "userad@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234595"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "userad@domain.com"], ["encrypted_password", "$2a$04$T5MH0FjZmbSHuqg3xxLvJu7HuScA91xl80rCMMD6tmosjN5/Qqjy2"], ["phone_number", "0701234595"], ["full_name", "first user"], ["created_at", "2019-04-17 08:20:20.996165"], ["updated_at", "2019-04-17 08:20:20.996165"], ["jti", "e4398c5c-c7b2-438c-8af5-365597a29987"]]
  [1m[36mAccount Create (0.5ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 08:20:20.998168"], ["updated_at", "2019-04-17 08:20:20.998168"], ["owner_id", 23], ["owner_type", "User"]]
  [1m[36mAccount Load (0.3ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 23], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAgency Create (0.8ms)[0m  [1m[32mINSERT INTO "agencies" ("business_name", "location", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["business_name", "Well chosen"], ["location", "kwa stima"], ["user_id", 23], ["created_at", "2019-04-17 08:20:21.002000"], ["updated_at", "2019-04-17 08:20:21.002000"]]
  [1m[36mAgency Load (0.4ms)[0m  [1m[34mSELECT  "agencies".* FROM "agencies" WHERE "agencies"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mAccount Load (0.4ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 6], ["owner_type", "Agency"], ["LIMIT", 1]]
  [1m[36mAccount Create (0.6ms)[0m  [1m[32mINSERT INTO "accounts" ("balance", "created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["balance", 100000], ["created_at", "2019-04-17 08:20:21.007159"], ["updated_at", "2019-04-17 08:20:21.007159"], ["owner_id", 6], ["owner_type", "Agency"]]
  [1m[36mAccount Load (0.4ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 6], ["owner_type", "Agency"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "userae@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234596"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "userae@domain.com"], ["encrypted_password", "$2a$04$Iq3IfHemFihpAlL21A2KuOuIpyWjGLI1ykXsBkVS0x71yDLMYAuZq"], ["phone_number", "0701234596"], ["full_name", "first user"], ["created_at", "2019-04-17 08:20:21.015794"], ["updated_at", "2019-04-17 08:20:21.015794"], ["jti", "bd4b39a7-998d-4353-a38a-21110f3ebca8"]]
  [1m[36mAccount Create (0.6ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 08:20:21.018179"], ["updated_at", "2019-04-17 08:20:21.018179"], ["owner_id", 24], ["owner_type", "User"]]
  [1m[36mAccount Load (0.4ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 24], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/transactions/deposit" for 127.0.0.1 at 2019-04-17 08:20:21 +0000
Processing by TransactionsController#deposit as HTML
  Parameters: {"data"=>{"amount"=>"1000", "phone"=>"0701234596"}}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234596"], ["LIMIT", 1]]
  [1m[36mAccount Load (0.3ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 24], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[36mAccount Load (0.6ms)[0m  [1m[37mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 29], ["LIMIT", 1]]
  [1m[36mAccount Load (0.5ms)[0m  [1m[37mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 30], ["LIMIT", 1]]
  [1m[36mTransaktion Load (0.5ms)[0m  [1m[34mSELECT  "transaktions".* FROM "transaktions" ORDER BY "transaktions"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
Completed 500 Internal Server Error in 6ms (ActiveRecord: 2.5ms)
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------
TransactionsControllerTest: test_send_money
-------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "useraf@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234597"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "useraf@domain.com"], ["encrypted_password", "$2a$04$z7nLAoOsEe/AOtvFkrIKmOMHtoo.1x53n20p6PJBdzB7SrdfinxOa"], ["phone_number", "0701234597"], ["full_name", "first user"], ["created_at", "2019-04-17 08:20:21.038203"], ["updated_at", "2019-04-17 08:20:21.038203"], ["jti", "044f33a1-b482-4b83-a24d-4ca93ccf9bde"]]
  [1m[36mAccount Create (0.5ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 08:20:21.040087"], ["updated_at", "2019-04-17 08:20:21.040087"], ["owner_id", 25], ["owner_type", "User"]]
  [1m[36mAccount Load (0.3ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 25], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAgency Create (0.6ms)[0m  [1m[32mINSERT INTO "agencies" ("business_name", "location", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["business_name", "Well chosen"], ["location", "kwa stima"], ["user_id", 25], ["created_at", "2019-04-17 08:20:21.043073"], ["updated_at", "2019-04-17 08:20:21.043073"]]
  [1m[36mAgency Load (0.4ms)[0m  [1m[34mSELECT  "agencies".* FROM "agencies" WHERE "agencies"."id" = $1 LIMIT $2[0m  [["id", 7], ["LIMIT", 1]]
  [1m[36mAccount Load (0.3ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 7], ["owner_type", "Agency"], ["LIMIT", 1]]
  [1m[36mAccount Create (0.6ms)[0m  [1m[32mINSERT INTO "accounts" ("balance", "created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["balance", 100000], ["created_at", "2019-04-17 08:20:21.047325"], ["updated_at", "2019-04-17 08:20:21.047325"], ["owner_id", 7], ["owner_type", "Agency"]]
  [1m[36mAccount Load (0.4ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 7], ["owner_type", "Agency"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "userag@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234598"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "userag@domain.com"], ["encrypted_password", "$2a$04$dzkxFz3BOUiUMzHUPIdXlOtTQDyH1UwsyX4A7wXseHOuq8mqLO8Ae"], ["phone_number", "0701234598"], ["full_name", "first user"], ["created_at", "2019-04-17 08:20:21.055164"], ["updated_at", "2019-04-17 08:20:21.055164"], ["jti", "de462577-e061-4048-b064-11fa0e3174cf"]]
  [1m[36mAccount Create (0.5ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 08:20:21.057235"], ["updated_at", "2019-04-17 08:20:21.057235"], ["owner_id", 26], ["owner_type", "User"]]
  [1m[36mAccount Load (0.3ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 26], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "userah@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234599"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "userah@domain.com"], ["encrypted_password", "$2a$04$1svqA7SiP8P7tmemdP8q7ehttHx17krWpErqMINj5QzySQ8tlyOna"], ["phone_number", "0701234599"], ["full_name", "first user"], ["created_at", "2019-04-17 08:20:21.063846"], ["updated_at", "2019-04-17 08:20:21.063846"], ["jti", "3b3afb1f-5ccd-439d-8c84-17adf7ac7aee"]]
  [1m[36mAccount Create (0.4ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 08:20:21.065712"], ["updated_at", "2019-04-17 08:20:21.065712"], ["owner_id", 27], ["owner_type", "User"]]
  [1m[36mAccount Load (0.3ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 27], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAccount Update (0.5ms)[0m  [1m[33mUPDATE "accounts" SET "balance" = $1, "updated_at" = $2 WHERE "accounts"."id" = $3[0m  [["balance", 1000], ["updated_at", "2019-04-17 08:20:21.069123"], ["id", 34]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/transactions/send_money" for 127.0.0.1 at 2019-04-17 08:20:21 +0000
Processing by TransactionsController#send_money as HTML
  Parameters: {"data"=>{"amount"=>"1000", "recipient"=>"0701234598"}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234598"], ["LIMIT", 1]]
  [1m[36mAccount Load (0.3ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 26], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[36mAccount Load (0.5ms)[0m  [1m[37mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 34], ["LIMIT", 1]]
  [1m[36mAccount Load (0.5ms)[0m  [1m[37mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 33], ["LIMIT", 1]]
  [1m[36mTransaktion Load (0.4ms)[0m  [1m[34mSELECT  "transaktions".* FROM "transaktions" ORDER BY "transaktions"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
Completed 500 Internal Server Error in 5ms (ActiveRecord: 2.3ms)
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------
TransactionsControllerTest: test_withdraw
-----------------------------------------
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "userai@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234600"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "userai@domain.com"], ["encrypted_password", "$2a$04$mH.T9Rhj9qAqUgpzt4QjzO3582fB/NaKAn9xRFlqxE059nRTPwRK2"], ["phone_number", "0701234600"], ["full_name", "first user"], ["created_at", "2019-04-17 08:20:21.084441"], ["updated_at", "2019-04-17 08:20:21.084441"], ["jti", "92291489-ff3b-4acb-b04e-1dd6aeb89904"]]
  [1m[36mAccount Create (0.5ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 08:20:21.086357"], ["updated_at", "2019-04-17 08:20:21.086357"], ["owner_id", 28], ["owner_type", "User"]]
  [1m[36mAccount Load (0.3ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 28], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAgency Create (0.6ms)[0m  [1m[32mINSERT INTO "agencies" ("business_name", "location", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["business_name", "Well chosen"], ["location", "kwa stima"], ["user_id", 28], ["created_at", "2019-04-17 08:20:21.089027"], ["updated_at", "2019-04-17 08:20:21.089027"]]
  [1m[36mAgency Load (0.6ms)[0m  [1m[34mSELECT  "agencies".* FROM "agencies" WHERE "agencies"."id" = $1 LIMIT $2[0m  [["id", 8], ["LIMIT", 1]]
  [1m[36mAccount Load (0.3ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 8], ["owner_type", "Agency"], ["LIMIT", 1]]
  [1m[36mAccount Create (0.5ms)[0m  [1m[32mINSERT INTO "accounts" ("balance", "created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["balance", 100000], ["created_at", "2019-04-17 08:20:21.093027"], ["updated_at", "2019-04-17 08:20:21.093027"], ["owner_id", 8], ["owner_type", "Agency"]]
  [1m[36mAccount Load (0.3ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 8], ["owner_type", "Agency"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "useraj@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234601"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "useraj@domain.com"], ["encrypted_password", "$2a$04$l8TrV9pG23TtOql4QfoUpek5VWvsG9FRfN1pOK0OMm9ld0s7VV9ai"], ["phone_number", "0701234601"], ["full_name", "first user"], ["created_at", "2019-04-17 08:20:21.099322"], ["updated_at", "2019-04-17 08:20:21.099322"], ["jti", "2d5ace9d-4bd2-4ef7-9fc2-626a5079e2e0"]]
  [1m[36mAccount Create (0.7ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 08:20:21.101741"], ["updated_at", "2019-04-17 08:20:21.101741"], ["owner_id", 29], ["owner_type", "User"]]
  [1m[36mAccount Load (0.3ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 29], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAccount Update (0.6ms)[0m  [1m[33mUPDATE "accounts" SET "balance" = $1, "updated_at" = $2 WHERE "accounts"."id" = $3[0m  [["balance", 2500], ["updated_at", "2019-04-17 08:20:21.104889"], ["id", 37]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/transactions/withdrawal" for 127.0.0.1 at 2019-04-17 08:20:21 +0000
Processing by TransactionsController#withdraw as HTML
  Parameters: {"data"=>{"amount"=>"1000", "phone"=>"0701234601", "agent_number"=>"8"}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "8"], ["LIMIT", 1]]
  [1m[36mAgency Load (0.2ms)[0m  [1m[34mSELECT  "agencies".* FROM "agencies" WHERE "agencies"."id" = $1 LIMIT $2[0m  [["id", 8], ["LIMIT", 1]]
  [1m[36mAccount Load (0.2ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 8], ["owner_type", "Agency"], ["LIMIT", 1]]
  [1m[36mAccount Load (0.5ms)[0m  [1m[37mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 37], ["LIMIT", 1]]
  [1m[36mAccount Load (0.4ms)[0m  [1m[37mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 36], ["LIMIT", 1]]
  [1m[36mTransaktion Load (0.4ms)[0m  [1m[34mSELECT  "transaktions".* FROM "transaktions" ORDER BY "transaktions"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
Completed 500 Internal Server Error in 6ms (ActiveRecord: 2.2ms)
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
-----------------------------------
StatementMailerTest: test_mail_sent
-----------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "usera@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234567"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "usera@domain.com"], ["encrypted_password", "$2a$04$IjZa7l6SSFuPi9qHNYwQQOYWGQpsafJ7HA/2d08TvO6cyqikCRR5u"], ["phone_number", "0701234567"], ["full_name", "first user"], ["created_at", "2019-04-17 08:21:19.251082"], ["updated_at", "2019-04-17 08:21:19.251082"], ["jti", "9646a9f8-1932-4b8a-9b4b-73702e1220dd"]]
  [1m[36mAccount Create (0.7ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 08:21:19.272140"], ["updated_at", "2019-04-17 08:21:19.272140"], ["owner_id", 30], ["owner_type", "User"]]
  [1m[36mAccount Load (0.4ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 30], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  Rendering statement_mailer/send_statement.html.erb within layouts/mailer
  Rendered statement_mailer/send_statement.html.erb within layouts/mailer (0.5ms)
StatementMailer#send_statement: processed outbound mail in 5.8ms
Sent mail to usera@domain.com (2.1ms)
Date: Wed, 17 Apr 2019 08:21:19 +0000
From: from@example.com
To: usera@domain.com
Message-ID: <5cb6e1ff46ab1_202b1dd385a680957d@416386ea621a.mail>
Subject: Statement
Mime-Version: 1.0
Content-Type: text/html;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <style>
      /* Email styles need to be inline */
    </style>
  </head>

  <body>
    <h1>Statement</h1>
    Total balance = 20000.00
  </body>
</html>

  [1m[35m (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
-----------------------------------
StatementMailerTest: test_mail_sent
-----------------------------------
  [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.7ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "usera@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234567"], ["LIMIT", 1]]
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "usera@domain.com"], ["encrypted_password", "$2a$04$f/raI8LfA0BrStgRbtZJc.UYfsLfajSgMPOWhifIICypyz/Sm6qPi"], ["phone_number", "0701234567"], ["full_name", "first user"], ["created_at", "2019-04-17 08:30:13.784436"], ["updated_at", "2019-04-17 08:30:13.784436"], ["jti", "8c4fda4b-cbd2-4ad3-b86b-fb356a67770a"]]
  [1m[36mAccount Create (0.8ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 08:30:13.821385"], ["updated_at", "2019-04-17 08:30:13.821385"], ["owner_id", 31], ["owner_type", "User"]]
  [1m[36mAccount Load (0.4ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 31], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  Rendering statement_mailer/send_statement.html.erb within layouts/mailer
  Rendered statement_mailer/send_statement.html.erb within layouts/mailer (1.0ms)
StatementMailer#send_statement: processed outbound mail in 18.7ms
Sent mail to usera@domain.com (4.7ms)
Date: Wed, 17 Apr 2019 08:30:13 +0000
From: juandsmithj@gmail.com
To: usera@domain.com
Message-ID: <5cb6e415d3ec8_272ac6ee6326a0726ba@416386ea621a.mail>
Subject: Statement
Mime-Version: 1.0
Content-Type: text/html;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <style>
      /* Email styles need to be inline */
    </style>
  </head>

  <body>
    <h1>Statement</h1>
    Total balance = 20000.00
  </body>
</html>

  [1m[35m (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
-----------------------------------
StatementMailerTest: test_mail_sent
-----------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.0ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "usera@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234567"], ["LIMIT", 1]]
  [1m[36mUser Create (1.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "usera@domain.com"], ["encrypted_password", "$2a$04$V6g5Tzc6Q5.gyvpt670C6e6Zutkq1eqtNF8NXe.3J5c8HaMAbl2Ku"], ["phone_number", "0701234567"], ["full_name", "first user"], ["created_at", "2019-04-17 08:37:28.740800"], ["updated_at", "2019-04-17 08:37:28.740800"], ["jti", "75d94ffc-15e3-4a9a-9f2d-caf18d437dc0"]]
  [1m[36mAccount Create (0.6ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 08:37:28.769861"], ["updated_at", "2019-04-17 08:37:28.769861"], ["owner_id", 32], ["owner_type", "User"]]
  [1m[36mAccount Load (0.4ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 32], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
StatementMailer#send_statement: processed outbound mail in 0.3ms
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
-----------------------------------
StatementMailerTest: test_mail_sent
-----------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "usera@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234567"], ["LIMIT", 1]]
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "usera@domain.com"], ["encrypted_password", "$2a$04$x7DlrldMeBXCKScmR5nt4.VjDjcXt04m46bUQlfzk9yX1Wp.uAq1e"], ["phone_number", "0701234567"], ["full_name", "first user"], ["created_at", "2019-04-17 08:39:57.498347"], ["updated_at", "2019-04-17 08:39:57.498347"], ["jti", "4ed998a9-cfd4-4cf2-893f-2d846dbf4e64"]]
  [1m[36mAccount Create (0.9ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 08:39:57.517869"], ["updated_at", "2019-04-17 08:39:57.517869"], ["owner_id", 33], ["owner_type", "User"]]
  [1m[36mAccount Load (0.6ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 33], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
StatementMailer#send_statement: processed outbound mail in 0.2ms
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
-----------------------------------
StatementMailerTest: test_mail_sent
-----------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "usera@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234567"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "usera@domain.com"], ["encrypted_password", "$2a$04$fCYGr7fF54qd2b9ERT9ekuoK6cKQM8oZWkZBckiqHP4XD9ygR26u2"], ["phone_number", "0701234567"], ["full_name", "first user"], ["created_at", "2019-04-17 08:40:25.377030"], ["updated_at", "2019-04-17 08:40:25.377030"], ["jti", "8c7827ef-912d-4a8d-abb3-1674336678a7"]]
  [1m[36mAccount Create (0.8ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 08:40:25.395143"], ["updated_at", "2019-04-17 08:40:25.395143"], ["owner_id", 34], ["owner_type", "User"]]
  [1m[36mAccount Load (0.5ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 34], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  Rendering statement_mailer/send_statement.html.erb within layouts/mailer
  Rendered statement_mailer/send_statement.html.erb within layouts/mailer (0.7ms)
StatementMailer#send_statement: processed outbound mail in 25.5ms
Sent mail to usera@domain.com (20.7ms)
Date: Wed, 17 Apr 2019 08:40:25 +0000
From: juandsmithj@gmail.com
To: usera@domain.com
Message-ID: <5cb6e6796dff6_3c2adebcad0690864ec@416386ea621a.mail>
Subject: Statement
Mime-Version: 1.0
Content-Type: text/html;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <style>
      /* Email styles need to be inline */
    </style>
  </head>

  <body>
    <h1>Statement</h1>
    Total balance = 20000.00
  </body>
</html>

  [1m[35m (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
-----------------------------------
StatementMailerTest: test_mail_sent
-----------------------------------
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.0ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "usera@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234567"], ["LIMIT", 1]]
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "usera@domain.com"], ["encrypted_password", "$2a$04$2dG6twu3iKcZX80gvIXmweITtxrAuooWQ9ZZdq5onsv8miugXZxG2"], ["phone_number", "0701234567"], ["full_name", "first user"], ["created_at", "2019-04-17 08:41:03.566064"], ["updated_at", "2019-04-17 08:41:03.566064"], ["jti", "187012a0-875a-4956-bb8b-1c62ae88be7a"]]
  [1m[36mAccount Create (0.8ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 08:41:03.585028"], ["updated_at", "2019-04-17 08:41:03.585028"], ["owner_id", 35], ["owner_type", "User"]]
  [1m[36mAccount Load (0.5ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 35], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  Rendering statement_mailer/send_statement.html.erb within layouts/mailer
  Rendered statement_mailer/send_statement.html.erb within layouts/mailer (0.5ms)
StatementMailer#send_statement: processed outbound mail in 5.8ms
Sent mail to tomnyongesa5@gmail.com (2.2ms)
Date: Wed, 17 Apr 2019 08:41:03 +0000
From: juandsmithj@gmail.com
To: tomnyongesa5@gmail.com
Message-ID: <5cb6e69f9375d_432b0c8838c6a07810@416386ea621a.mail>
Subject: Statement
Mime-Version: 1.0
Content-Type: text/html;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <style>
      /* Email styles need to be inline */
    </style>
  </head>

  <body>
    <h1>Statement</h1>
    Total balance = 20000.00
  </body>
</html>

  [1m[35m (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (1.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
-----------------------------------
StatementMailerTest: test_mail_sent
-----------------------------------
  [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "usera@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234567"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "usera@domain.com"], ["encrypted_password", "$2a$04$IGfgiu7XpS.yXAtICFuUVutjD7eG6yRjuu.0G9xg7aoy/IXnjaICS"], ["phone_number", "0701234567"], ["full_name", "first user"], ["created_at", "2019-04-17 08:41:36.900236"], ["updated_at", "2019-04-17 08:41:36.900236"], ["jti", "c8968d96-219d-41b5-853e-ea41efa89088"]]
  [1m[36mAccount Create (0.8ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 08:41:36.924653"], ["updated_at", "2019-04-17 08:41:36.924653"], ["owner_id", 36], ["owner_type", "User"]]
  [1m[36mAccount Load (0.5ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 36], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  Rendering statement_mailer/send_statement.html.erb within layouts/mailer
  Rendered statement_mailer/send_statement.html.erb within layouts/mailer (0.5ms)
StatementMailer#send_statement: processed outbound mail in 5.7ms
Sent mail to tomnyongesa5@gmail.com (12.6ms)
Date: Wed, 17 Apr 2019 08:41:36 +0000
From: juandsmithj@gmail.com
To: tomnyongesa5@gmail.com
Message-ID: <5cb6e6c0e8909_4a2b11100a6698266e5@416386ea621a.mail>
Subject: Statement
Mime-Version: 1.0
Content-Type: text/html;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <style>
      /* Email styles need to be inline */
    </style>
  </head>

  <body>
    <h1>Statement</h1>
    Total balance = 20000.00
  </body>
</html>

  [1m[35m (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (1.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
-----------------------------------
StatementMailerTest: test_mail_sent
-----------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (21.0ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "usera@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (1.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234567"], ["LIMIT", 1]]
  [1m[36mUser Create (1.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "usera@domain.com"], ["encrypted_password", "$2a$04$8Qb8bU8bDZk0C9c.HWZmuewnSQldd81OSosGf8YIB3fFX9pTmCWKy"], ["phone_number", "0701234567"], ["full_name", "first user"], ["created_at", "2019-04-17 08:44:39.810198"], ["updated_at", "2019-04-17 08:44:39.810198"], ["jti", "b682f9f5-08b8-4acf-8111-93b4d431b7ed"]]
  [1m[36mAccount Create (0.6ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 08:44:39.840076"], ["updated_at", "2019-04-17 08:44:39.840076"], ["owner_id", 37], ["owner_type", "User"]]
  [1m[36mAccount Load (0.4ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 37], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  Rendering statement_mailer/send_statement.html.erb within layouts/mailer
  Rendered statement_mailer/send_statement.html.erb within layouts/mailer (0.5ms)
StatementMailer#send_statement: processed outbound mail in 6.0ms
Sent mail to tomnyongesa5@gmail.com (21.8ms)
Date: Wed, 17 Apr 2019 08:44:39 +0000
From: juandsmithj@gmail.com
To: tomnyongesa5@gmail.com
Message-ID: <5cb6e777da5da_512b1e36ec4698228a2@416386ea621a.mail>
Subject: Statement
Mime-Version: 1.0
Content-Type: text/html;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <style>
      /* Email styles need to be inline */
    </style>
  </head>

  <body>
    <h1>Statement</h1>
    Total balance = 20000.00
  </body>
</html>

  [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (1.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (1.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
-----------------------------------
StatementMailerTest: test_mail_sent
-----------------------------------
  [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "usera@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234567"], ["LIMIT", 1]]
  [1m[36mUser Create (0.9ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "usera@domain.com"], ["encrypted_password", "$2a$04$X4WNy.PIEIKW39BN1vCK2up/HUN8YziVr92wd3JUTppTTceBMvpKy"], ["phone_number", "0701234567"], ["full_name", "first user"], ["created_at", "2019-04-17 09:22:04.150647"], ["updated_at", "2019-04-17 09:22:04.150647"], ["jti", "7704f5b4-3535-41f3-806e-58303ed26586"]]
  [1m[36mAccount Create (1.0ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 09:22:04.188340"], ["updated_at", "2019-04-17 09:22:04.188340"], ["owner_id", 38], ["owner_type", "User"]]
  [1m[36mAccount Load (0.4ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 38], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  Rendering statement_mailer/send_statement.html.erb within layouts/mailer
  Rendered statement_mailer/send_statement.html.erb within layouts/mailer (0.6ms)
StatementMailer#send_statement: processed outbound mail in 13.3ms
Sent mail to tomnyongesa5@gmail.com (10.2ms)
Date: Wed, 17 Apr 2019 09:22:04 +0000
From: juandsmithj@gmail.com
To: tomnyongesa5@gmail.com
Message-ID: <5cb6f03c3b5f5_652aca6469869887277@416386ea621a.mail>
Subject: Statement
Mime-Version: 1.0
Content-Type: text/html;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <style>
      /* Email styles need to be inline */
    </style>
  </head>

  <body>
    <h1>Statement</h1>
    Total balance = 20000.00
  </body>
</html>

  [1m[35m (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  Rendering statement_mailer/send_statement.html.erb within layouts/mailer
  Rendered statement_mailer/send_statement.html.erb within layouts/mailer (0.5ms)
StatementMailer#send_statement: processed outbound mail in 20.7ms
Sent mail to tomnyongesa5@gmail.com (2.2ms)
Date: Wed, 17 Apr 2019 09:24:48 +0000
From: juandsmithj@gmail.com
To: tomnyongesa5@gmail.com
Message-ID: <5cb6f0e085e2e_712af585a766b0975ab@416386ea621a.mail>
Subject: Statement
Mime-Version: 1.0
Content-Type: text/html;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <style>
      /* Email styles need to be inline */
    </style>
  </head>

  <body>
    <h1>Statement</h1>
    Total balance = 20000.00
  </body>
</html>

  [1m[35m (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (5.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (9.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (1.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (2.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (26.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
-----------------------------------
StatementMailerTest: test_mail_sent
-----------------------------------
  [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (54.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "usera@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234567"], ["LIMIT", 1]]
  [1m[36mUser Create (1.2ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "usera@domain.com"], ["encrypted_password", "$2a$04$DdN6PPVfqBO10Mlv5G.aXuYHnNF.GAcV5/lcVDDKw4sj7d4.WyMb6"], ["phone_number", "0701234567"], ["full_name", "first user"], ["created_at", "2019-04-17 14:22:33.106475"], ["updated_at", "2019-04-17 14:22:33.106475"], ["jti", "40967da0-b4b0-495e-a674-6708941026aa"]]
  [1m[36mAccount Create (42.3ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 14:22:33.259075"], ["updated_at", "2019-04-17 14:22:33.259075"], ["owner_id", 39], ["owner_type", "User"]]
  [1m[36mAccount Load (1.0ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 39], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTransaktion Load (39.1ms)[0m  [1m[34mSELECT "transaktions".* FROM "transaktions"[0m
  [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "userb@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234568"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "userb@domain.com"], ["encrypted_password", "$2a$04$HFUMb4kjA4Tn719LcNRKEevuYCPXz8ENMaYmxmPalfm/V5c4R7l2K"], ["phone_number", "0701234568"], ["full_name", "first user"], ["created_at", "2019-04-17 14:23:22.825767"], ["updated_at", "2019-04-17 14:23:22.825767"], ["jti", "04a8e5e6-436b-49eb-9d2c-56141460a6e3"]]
  [1m[36mAccount Create (0.6ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 14:23:22.828790"], ["updated_at", "2019-04-17 14:23:22.828790"], ["owner_id", 40], ["owner_type", "User"]]
  [1m[36mAccount Load (0.5ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 40], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAccount Create (0.6ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 14:23:22.833708"], ["updated_at", "2019-04-17 14:23:22.833708"], ["owner_id", 40], ["owner_type", "User"]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (28.5ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 49], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-17 14:23:22.838119"], ["updated_at", "2019-04-17 14:23:22.838119"]]
  [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTransaktion Load (29.3ms)[0m  [1m[34mSELECT "transaktions".* FROM "transaktions"[0m
  [1m[36mTransaktion Load (1.4ms)[0m  [1m[34mSELECT "transaktions".* FROM "transaktions" WHERE (account_id=49)[0m
  [1m[36mTransaktion Load (1.0ms)[0m  [1m[34mSELECT "transaktions".* FROM "transaktions" WHERE (account_id=40)[0m
  [1m[36mTransaktion Load (0.8ms)[0m  [1m[34mSELECT "transaktions".* FROM "transaktions" WHERE (account_id=49)[0m
  Rendering statement_mailer/send_statement.html.erb within layouts/mailer
  Rendered statement_mailer/send_statement.html.erb within layouts/mailer (1.6ms)
StatementMailer#send_statement: processed outbound mail in 58.5ms
Sent mail to tomnyongesa5@gmail.com (62.1ms)
Date: Wed, 17 Apr 2019 14:24:46 +0000
From: juandsmithj@gmail.com
To: tomnyongesa5@gmail.com
Message-ID: <5cb7372e6541b_202b25b76c06806184@039811e68908.mail>
Subject: Statement
Mime-Version: 1.0
Content-Type: text/html;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <style>
      /* Email styles need to be inline */
    </style>
  </head>

  <body>
    <h1>Statement</h1>
    Total balance = 20000.00
  </body>
</html>

  [1m[35m (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (1.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------
StatementControllerTest: test_get_statement
-------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "usera@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234567"], ["LIMIT", 1]]
  [1m[36mUser Create (1.2ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "usera@domain.com"], ["encrypted_password", "$2a$04$UxtKdaIcQMmQHzfdiUaG9en7HjPJ1XAnYR6d16XZrfhTb1r9zFaOK"], ["phone_number", "0701234567"], ["full_name", "first user"], ["created_at", "2019-04-17 14:32:01.632337"], ["updated_at", "2019-04-17 14:32:01.632337"], ["jti", "a123c392-7505-4c4e-82c6-33b8299938de"]]
  [1m[36mAccount Create (1.0ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 14:32:01.641741"], ["updated_at", "2019-04-17 14:32:01.641741"], ["owner_id", 41], ["owner_type", "User"]]
  [1m[36mAccount Load (0.6ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 41], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAccount Create (0.6ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 14:32:01.648687"], ["updated_at", "2019-04-17 14:32:01.648687"], ["owner_id", 41], ["owner_type", "User"]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (1.3ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 51], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-17 14:32:01.651733"], ["updated_at", "2019-04-17 14:32:01.651733"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "userb@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234568"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "userb@domain.com"], ["encrypted_password", "$2a$04$HitoLcrS1FUfJJpU6UdOXOZ7V5mYrUl46PpfSwYBVh.K/lw1U2fTW"], ["phone_number", "0701234568"], ["full_name", "first user"], ["created_at", "2019-04-17 14:32:01.659144"], ["updated_at", "2019-04-17 14:32:01.659144"], ["jti", "acd071bd-5a8c-4e9d-a5e0-d59fdb7fcada"]]
  [1m[36mAccount Create (0.7ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 14:32:01.661325"], ["updated_at", "2019-04-17 14:32:01.661325"], ["owner_id", 42], ["owner_type", "User"]]
  [1m[36mAccount Load (0.5ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 42], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAccount Create (0.5ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 14:32:01.664821"], ["updated_at", "2019-04-17 14:32:01.664821"], ["owner_id", 42], ["owner_type", "User"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (0.6ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 53], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-17 14:32:01.666926"], ["updated_at", "2019-04-17 14:32:01.666926"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "userc@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234569"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "userc@domain.com"], ["encrypted_password", "$2a$04$kyfoJpzsQ3FUfuiZTtl6U.Yq/rdTbOn0GNW6Zyq0V7eo5Qkvit8fO"], ["phone_number", "0701234569"], ["full_name", "first user"], ["created_at", "2019-04-17 14:32:01.672978"], ["updated_at", "2019-04-17 14:32:01.672978"], ["jti", "6cffc189-434b-4f38-8a69-7582c12e00a3"]]
  [1m[36mAccount Create (0.5ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 14:32:01.674938"], ["updated_at", "2019-04-17 14:32:01.674938"], ["owner_id", 43], ["owner_type", "User"]]
  [1m[36mAccount Load (0.3ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 43], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAccount Create (0.5ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 14:32:01.677856"], ["updated_at", "2019-04-17 14:32:01.677856"], ["owner_id", 43], ["owner_type", "User"]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (0.7ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 55], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-17 14:32:01.680056"], ["updated_at", "2019-04-17 14:32:01.680056"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "userd@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234570"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "userd@domain.com"], ["encrypted_password", "$2a$04$VLnBJihpJy49I8Xor6TxqO/XiI4.0XpM/mAUGMnhDl.Y29I4YXYB."], ["phone_number", "0701234570"], ["full_name", "first user"], ["created_at", "2019-04-17 14:32:01.689226"], ["updated_at", "2019-04-17 14:32:01.689226"], ["jti", "11f137f0-7c8b-4bea-bea5-b51ec185a471"]]
  [1m[36mAccount Create (0.7ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 14:32:01.692332"], ["updated_at", "2019-04-17 14:32:01.692332"], ["owner_id", 44], ["owner_type", "User"]]
  [1m[36mAccount Load (0.5ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 44], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAccount Create (0.5ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 14:32:01.696200"], ["updated_at", "2019-04-17 14:32:01.696200"], ["owner_id", 44], ["owner_type", "User"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (0.8ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 57], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-17 14:32:01.698365"], ["updated_at", "2019-04-17 14:32:01.698365"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "usere@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234571"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "usere@domain.com"], ["encrypted_password", "$2a$04$igs3S8zLmURZLw7sptLLquLi4vGu9vBlbFXhor537TKN7.zNb732C"], ["phone_number", "0701234571"], ["full_name", "first user"], ["created_at", "2019-04-17 14:32:01.704778"], ["updated_at", "2019-04-17 14:32:01.704778"], ["jti", "0f1b1a28-9c0f-4704-9452-d63bf7f4cf20"]]
  [1m[36mAccount Create (0.5ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 14:32:01.706935"], ["updated_at", "2019-04-17 14:32:01.706935"], ["owner_id", 45], ["owner_type", "User"]]
  [1m[36mAccount Load (0.5ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 45], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAccount Create (0.7ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 14:32:01.711143"], ["updated_at", "2019-04-17 14:32:01.711143"], ["owner_id", 45], ["owner_type", "User"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (0.8ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 59], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-17 14:32:01.714669"], ["updated_at", "2019-04-17 14:32:01.714669"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/statement" for 127.0.0.1 at 2019-04-17 14:32:01 +0000
Processing by StatementController#statement as HTML
  [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  Rendering statement_mailer/send_statement.html.erb within layouts/mailer
  Rendered statement_mailer/send_statement.html.erb within layouts/mailer (0.5ms)
StatementMailer#send_statement: processed outbound mail in 30.0ms
Sent mail to tomnyongesa@outlook.com (2.4ms)
Date: Wed, 17 Apr 2019 14:32:01 +0000
From: juandsmithj@gmail.com
To: tomnyongesa@outlook.com
Message-ID: <5cb738e1d451d_272b18143626b0965b0@039811e68908.mail>
Subject: Statement
Mime-Version: 1.0
Content-Type: text/html;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <style>
      /* Email styles need to be inline */
    </style>
  </head>

  <body>
    <h1>Statement</h1>
    Total balance = 20000.00
  </body>
</html>

Completed 204 No Content in 42ms (ActiveRecord: 1.2ms)
  [1m[35m (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------
StatementControllerTest: test_get_statement
-------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "usera@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234567"], ["LIMIT", 1]]
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "usera@domain.com"], ["encrypted_password", "$2a$04$0ujRAYvX1jjBlv508j6QkOFy1oYKA.7JtrslIXhSTr7vA2cbR/KeW"], ["phone_number", "0701234567"], ["full_name", "first user"], ["created_at", "2019-04-17 14:33:44.151444"], ["updated_at", "2019-04-17 14:33:44.151444"], ["jti", "074e994d-c454-45d6-b761-e15822c581eb"]]
  [1m[36mAccount Create (0.7ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 14:33:44.157509"], ["updated_at", "2019-04-17 14:33:44.157509"], ["owner_id", 46], ["owner_type", "User"]]
  [1m[36mAccount Load (0.4ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 46], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAccount Create (0.4ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 14:33:44.162797"], ["updated_at", "2019-04-17 14:33:44.162797"], ["owner_id", 46], ["owner_type", "User"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (0.8ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 61], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-17 14:33:44.165628"], ["updated_at", "2019-04-17 14:33:44.165628"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "userb@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234568"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "userb@domain.com"], ["encrypted_password", "$2a$04$YrXZ7hkMtQ3uka3x9zkVAugOvMKxE5BI0vUlfbLz8ZuluT9ZwFx42"], ["phone_number", "0701234568"], ["full_name", "first user"], ["created_at", "2019-04-17 14:33:44.172276"], ["updated_at", "2019-04-17 14:33:44.172276"], ["jti", "326b3591-e1e6-4a20-a9c5-f549d517e0b3"]]
  [1m[36mAccount Create (0.4ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 14:33:44.174252"], ["updated_at", "2019-04-17 14:33:44.174252"], ["owner_id", 47], ["owner_type", "User"]]
  [1m[36mAccount Load (0.4ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 47], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAccount Create (0.5ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 14:33:44.177625"], ["updated_at", "2019-04-17 14:33:44.177625"], ["owner_id", 47], ["owner_type", "User"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (0.6ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 63], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-17 14:33:44.179790"], ["updated_at", "2019-04-17 14:33:44.179790"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "userc@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234569"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "userc@domain.com"], ["encrypted_password", "$2a$04$9Pv3d0e6LRqyTeMI.N./Eu08PKHN6kowoVx34RD27H.18x6uOeOvG"], ["phone_number", "0701234569"], ["full_name", "first user"], ["created_at", "2019-04-17 14:33:44.187648"], ["updated_at", "2019-04-17 14:33:44.187648"], ["jti", "e4ee7248-89b8-4c91-9305-5174fb14fc7d"]]
  [1m[36mAccount Create (0.5ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 14:33:44.190070"], ["updated_at", "2019-04-17 14:33:44.190070"], ["owner_id", 48], ["owner_type", "User"]]
  [1m[36mAccount Load (0.3ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 48], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAccount Create (0.5ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 14:33:44.193077"], ["updated_at", "2019-04-17 14:33:44.193077"], ["owner_id", 48], ["owner_type", "User"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (0.7ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 65], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-17 14:33:44.195697"], ["updated_at", "2019-04-17 14:33:44.195697"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "userd@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234570"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "userd@domain.com"], ["encrypted_password", "$2a$04$OopaeHTuG1Qizoeg3Jp8wO6z.okTwH54jaegRuwJLT9Jl6sZMuA2e"], ["phone_number", "0701234570"], ["full_name", "first user"], ["created_at", "2019-04-17 14:33:44.203266"], ["updated_at", "2019-04-17 14:33:44.203266"], ["jti", "d2b4aa6b-2a32-4d73-8509-0e7205153edc"]]
  [1m[36mAccount Create (0.5ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 14:33:44.205531"], ["updated_at", "2019-04-17 14:33:44.205531"], ["owner_id", 49], ["owner_type", "User"]]
  [1m[36mAccount Load (0.4ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 49], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAccount Create (0.4ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 14:33:44.208982"], ["updated_at", "2019-04-17 14:33:44.208982"], ["owner_id", 49], ["owner_type", "User"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (0.7ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 67], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-17 14:33:44.211407"], ["updated_at", "2019-04-17 14:33:44.211407"]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "usere@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234571"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "usere@domain.com"], ["encrypted_password", "$2a$04$2wO2o.VwvO7Lipi54/vmm.7JhEBlGS8x6kD6vRdHbP64/wYiO.sNa"], ["phone_number", "0701234571"], ["full_name", "first user"], ["created_at", "2019-04-17 14:33:44.218205"], ["updated_at", "2019-04-17 14:33:44.218205"], ["jti", "8735f16d-7118-42ef-92e3-e39c67d2947e"]]
  [1m[36mAccount Create (0.5ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 14:33:44.220209"], ["updated_at", "2019-04-17 14:33:44.220209"], ["owner_id", 50], ["owner_type", "User"]]
  [1m[36mAccount Load (0.4ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 50], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAccount Create (0.4ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 14:33:44.223541"], ["updated_at", "2019-04-17 14:33:44.223541"], ["owner_id", 50], ["owner_type", "User"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (0.7ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 69], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-17 14:33:44.225559"], ["updated_at", "2019-04-17 14:33:44.225559"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/statement" for 127.0.0.1 at 2019-04-17 14:33:44 +0000
Processing by StatementController#statement as HTML
  [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  Rendering statement_mailer/send_statement.html.erb within layouts/mailer
  Rendered statement_mailer/send_statement.html.erb within layouts/mailer (0.9ms)
StatementMailer#send_statement: processed outbound mail in 31.0ms
Sent mail to tomnyongesa@outlook.com (3.0ms)
Date: Wed, 17 Apr 2019 14:33:44 +0000
From: juandsmithj@gmail.com
To: tomnyongesa@outlook.com
Message-ID: <5cb73948470d9_2e2aee6e57869013921@039811e68908.mail>
Subject: Statement
Mime-Version: 1.0
Content-Type: text/html;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <style>
      /* Email styles need to be inline */
    </style>
  </head>

  <body>
    <h1>Statement</h1>
    Total balance = 20000.00
  </body>
</html>

Completed 204 No Content in 48ms (ActiveRecord: 1.1ms)
  [1m[35m (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
-----------------------------------
StatementMailerTest: test_mail_sent
-----------------------------------
  [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "usera@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234567"], ["LIMIT", 1]]
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "usera@domain.com"], ["encrypted_password", "$2a$04$zzHX29WFrysZ942knpdTG.sQVmk4xZaXJLlOKz2v.szMnarRpiDgK"], ["phone_number", "0701234567"], ["full_name", "first user"], ["created_at", "2019-04-17 14:33:54.127798"], ["updated_at", "2019-04-17 14:33:54.127798"], ["jti", "92645e9f-9376-4430-840c-5f285f95c7d0"]]
  [1m[36mAccount Create (1.0ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 14:33:54.156826"], ["updated_at", "2019-04-17 14:33:54.156826"], ["owner_id", 51], ["owner_type", "User"]]
  [1m[36mAccount Load (0.6ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 51], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  Rendering statement_mailer/send_statement.html.erb within layouts/mailer
  Rendered statement_mailer/send_statement.html.erb within layouts/mailer (0.5ms)
StatementMailer#send_statement: processed outbound mail in 6.0ms
Sent mail to tomnyongesa5@gmail.com (2.4ms)
Date: Wed, 17 Apr 2019 14:33:54 +0000
From: juandsmithj@gmail.com
To: tomnyongesa5@gmail.com
Message-ID: <5cb739522aff5_352abf8ce666a0289f@039811e68908.mail>
Subject: Statement
Mime-Version: 1.0
Content-Type: text/html;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <style>
      /* Email styles need to be inline */
    </style>
  </head>

  <body>
    <h1>Statement</h1>
    Total balance = 20000.00
  </body>
</html>

  [1m[35m (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (1.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------
StatementControllerTest: test_get_statement
-------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "usera@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234567"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "usera@domain.com"], ["encrypted_password", "$2a$04$VszqZ0cIwCiKYVSKCqxp3eWXD6AIqn7NlGA82S/EvBJ20uA6JiMTa"], ["phone_number", "0701234567"], ["full_name", "first user"], ["created_at", "2019-04-17 14:34:51.269783"], ["updated_at", "2019-04-17 14:34:51.269783"], ["jti", "e87e7a13-e79a-4723-b83b-357280ebff27"]]
  [1m[36mAccount Create (0.7ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 14:34:51.274879"], ["updated_at", "2019-04-17 14:34:51.274879"], ["owner_id", 52], ["owner_type", "User"]]
  [1m[36mAccount Load (0.5ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 52], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (2.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAccount Create (0.7ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 14:34:51.283160"], ["updated_at", "2019-04-17 14:34:51.283160"], ["owner_id", 52], ["owner_type", "User"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (1.3ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 72], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-17 14:34:51.287830"], ["updated_at", "2019-04-17 14:34:51.287830"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "userb@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234568"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "userb@domain.com"], ["encrypted_password", "$2a$04$2SDQYaPZ3/wP5hDbOj42AeB0KpgQ3leIW9I9V1S7i39oyJtIAHTiC"], ["phone_number", "0701234568"], ["full_name", "first user"], ["created_at", "2019-04-17 14:34:51.297919"], ["updated_at", "2019-04-17 14:34:51.297919"], ["jti", "4fdacd2d-f626-4dcf-ad3b-50a6f287366f"]]
  [1m[36mAccount Create (0.4ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 14:34:51.300377"], ["updated_at", "2019-04-17 14:34:51.300377"], ["owner_id", 53], ["owner_type", "User"]]
  [1m[36mAccount Load (0.3ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 53], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAccount Create (0.4ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 14:34:51.303428"], ["updated_at", "2019-04-17 14:34:51.303428"], ["owner_id", 53], ["owner_type", "User"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (0.5ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 74], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-17 14:34:51.305530"], ["updated_at", "2019-04-17 14:34:51.305530"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "userc@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234569"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "userc@domain.com"], ["encrypted_password", "$2a$04$fZryWNXYRP2mWg/hipxyZ.qzQ.srvxpr08v6/t8WRy9KkCeIlsVl2"], ["phone_number", "0701234569"], ["full_name", "first user"], ["created_at", "2019-04-17 14:34:51.313984"], ["updated_at", "2019-04-17 14:34:51.313984"], ["jti", "4d9aef7e-7925-4314-9fbc-d3504172b06e"]]
  [1m[36mAccount Create (0.5ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 14:34:51.317067"], ["updated_at", "2019-04-17 14:34:51.317067"], ["owner_id", 54], ["owner_type", "User"]]
  [1m[36mAccount Load (0.4ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 54], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAccount Create (0.5ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 14:34:51.321355"], ["updated_at", "2019-04-17 14:34:51.321355"], ["owner_id", 54], ["owner_type", "User"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (0.6ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 76], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-17 14:34:51.324397"], ["updated_at", "2019-04-17 14:34:51.324397"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "userd@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234570"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "userd@domain.com"], ["encrypted_password", "$2a$04$NvWrBRrHsAUfmNPmex0nj.OFTbkoV1X56JLWBh7iwmXkoqGonxGva"], ["phone_number", "0701234570"], ["full_name", "first user"], ["created_at", "2019-04-17 14:34:51.332602"], ["updated_at", "2019-04-17 14:34:51.332602"], ["jti", "30e602c0-deec-4ba1-8506-ede20af30a6c"]]
  [1m[36mAccount Create (0.5ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 14:34:51.335613"], ["updated_at", "2019-04-17 14:34:51.335613"], ["owner_id", 55], ["owner_type", "User"]]
  [1m[36mAccount Load (0.4ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 55], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAccount Create (0.5ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 14:34:51.339927"], ["updated_at", "2019-04-17 14:34:51.339927"], ["owner_id", 55], ["owner_type", "User"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (0.6ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 78], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-17 14:34:51.342745"], ["updated_at", "2019-04-17 14:34:51.342745"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "usere@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234571"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "usere@domain.com"], ["encrypted_password", "$2a$04$n/awZL7/v9HeDfHCud5ds.PYjW4rn2bvsICBtWCg0O4IjdsnVIbTq"], ["phone_number", "0701234571"], ["full_name", "first user"], ["created_at", "2019-04-17 14:34:51.350122"], ["updated_at", "2019-04-17 14:34:51.350122"], ["jti", "bec1dfdf-0bb7-4f03-8835-3a3e9ddd9fe1"]]
  [1m[36mAccount Create (0.7ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 14:34:51.352486"], ["updated_at", "2019-04-17 14:34:51.352486"], ["owner_id", 56], ["owner_type", "User"]]
  [1m[36mAccount Load (0.4ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 56], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAccount Create (0.6ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 14:34:51.356520"], ["updated_at", "2019-04-17 14:34:51.356520"], ["owner_id", 56], ["owner_type", "User"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (0.9ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 80], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-17 14:34:51.359478"], ["updated_at", "2019-04-17 14:34:51.359478"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/statement" for 127.0.0.1 at 2019-04-17 14:35:25 +0000
Processing by StatementController#statement as HTML
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  Rendering statement_mailer/send_statement.html.erb within layouts/mailer
  Rendered statement_mailer/send_statement.html.erb within layouts/mailer (0.5ms)
StatementMailer#send_statement: processed outbound mail in 21.8ms
Sent mail to tomnyongesa@outlook.com (2.5ms)
Date: Wed, 17 Apr 2019 14:35:25 +0000
From: juandsmithj@gmail.com
To: tomnyongesa@outlook.com
Message-ID: <5cb739ad830a1_3c2af1326406b0709f6@039811e68908.mail>
Subject: Statement
Mime-Version: 1.0
Content-Type: text/html;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <style>
      /* Email styles need to be inline */
    </style>
  </head>

  <body>
    <h1>Statement</h1>
    Total balance = 20000.00
  </body>
</html>

Completed 204 No Content in 34ms (ActiveRecord: 0.8ms)
  [1m[35m (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (1.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------
StatementControllerTest: test_get_statement
-------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "usera@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234567"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "usera@domain.com"], ["encrypted_password", "$2a$04$W1jIW7C.QymfayfNrwwUQ.TD9UBdOVKGNHYD0cTYiFXftc9vFXUYm"], ["phone_number", "0701234567"], ["full_name", "first user"], ["created_at", "2019-04-17 14:35:35.199664"], ["updated_at", "2019-04-17 14:35:35.199664"], ["jti", "4a250f88-326b-4bfc-8e6d-c80687eb4d4a"]]
  [1m[36mAccount Create (0.7ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 14:35:35.207450"], ["updated_at", "2019-04-17 14:35:35.207450"], ["owner_id", 57], ["owner_type", "User"]]
  [1m[36mAccount Load (0.4ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 57], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAccount Create (0.5ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 14:35:35.214143"], ["updated_at", "2019-04-17 14:35:35.214143"], ["owner_id", 57], ["owner_type", "User"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (0.9ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 82], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-17 14:35:35.217960"], ["updated_at", "2019-04-17 14:35:35.217960"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "userb@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234568"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "userb@domain.com"], ["encrypted_password", "$2a$04$TbuL4ymF9yG/peBRX8oHoe/ioy.uPo6AqtXB7jsmiJVZ1akYZGjN6"], ["phone_number", "0701234568"], ["full_name", "first user"], ["created_at", "2019-04-17 14:35:35.226971"], ["updated_at", "2019-04-17 14:35:35.226971"], ["jti", "0fed6fed-ee73-43c1-877c-f6986284c472"]]
  [1m[36mAccount Create (0.5ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 14:35:35.229999"], ["updated_at", "2019-04-17 14:35:35.229999"], ["owner_id", 58], ["owner_type", "User"]]
  [1m[36mAccount Load (0.3ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 58], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAccount Create (0.4ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 14:35:35.234124"], ["updated_at", "2019-04-17 14:35:35.234124"], ["owner_id", 58], ["owner_type", "User"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (0.7ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 84], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-17 14:35:35.236639"], ["updated_at", "2019-04-17 14:35:35.236639"]]
  [1m[35m (1.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "userc@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234569"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "userc@domain.com"], ["encrypted_password", "$2a$04$A6S7ZESnUYRAeaF1B4Wk5uRf0b5D4ZKz85TbBxQO0vH3F2DsDxEWy"], ["phone_number", "0701234569"], ["full_name", "first user"], ["created_at", "2019-04-17 14:35:35.245557"], ["updated_at", "2019-04-17 14:35:35.245557"], ["jti", "06e214f7-2b1d-450e-b8ea-c561b817ff0c"]]
  [1m[36mAccount Create (0.5ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 14:35:35.247792"], ["updated_at", "2019-04-17 14:35:35.247792"], ["owner_id", 59], ["owner_type", "User"]]
  [1m[36mAccount Load (0.3ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 59], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAccount Create (0.5ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 14:35:35.251065"], ["updated_at", "2019-04-17 14:35:35.251065"], ["owner_id", 59], ["owner_type", "User"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (0.6ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 86], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-17 14:35:35.253156"], ["updated_at", "2019-04-17 14:35:35.253156"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "userd@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234570"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "userd@domain.com"], ["encrypted_password", "$2a$04$p1WuVRzg0LB88cdtRjJXYelhjaEBKDmrdgGqZacs9D/dl6RuLDFne"], ["phone_number", "0701234570"], ["full_name", "first user"], ["created_at", "2019-04-17 14:35:35.259662"], ["updated_at", "2019-04-17 14:35:35.259662"], ["jti", "5cbfa8fc-8a7f-4e5f-b193-bd9787e8b917"]]
  [1m[36mAccount Create (0.6ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 14:35:35.261648"], ["updated_at", "2019-04-17 14:35:35.261648"], ["owner_id", 60], ["owner_type", "User"]]
  [1m[36mAccount Load (0.4ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 60], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAccount Create (0.5ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 14:35:35.265925"], ["updated_at", "2019-04-17 14:35:35.265925"], ["owner_id", 60], ["owner_type", "User"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (2.2ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 88], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-17 14:35:35.269366"], ["updated_at", "2019-04-17 14:35:35.269366"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "usere@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234571"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "usere@domain.com"], ["encrypted_password", "$2a$04$uFZvC0rpYQorWX8sReaVJOeeXYze.8rIi6OjKt4T8y6kKMPIl5Zqa"], ["phone_number", "0701234571"], ["full_name", "first user"], ["created_at", "2019-04-17 14:35:35.280059"], ["updated_at", "2019-04-17 14:35:35.280059"], ["jti", "e4144738-4f30-405d-8b95-5825da638ff9"]]
  [1m[36mAccount Create (0.4ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 14:35:35.282993"], ["updated_at", "2019-04-17 14:35:35.282993"], ["owner_id", 61], ["owner_type", "User"]]
  [1m[36mAccount Load (0.3ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 61], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAccount Create (0.6ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 14:35:35.286994"], ["updated_at", "2019-04-17 14:35:35.286994"], ["owner_id", 61], ["owner_type", "User"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (0.6ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 90], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-17 14:35:35.290375"], ["updated_at", "2019-04-17 14:35:35.290375"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTransaktion Load (0.7ms)[0m  [1m[34mSELECT "transaktions".* FROM "transaktions"[0m
Started GET "/statement" for 127.0.0.1 at 2019-04-17 14:36:33 +0000
Processing by StatementController#statement as HTML
  [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  Rendering statement_mailer/send_statement.html.erb within layouts/mailer
  Rendered statement_mailer/send_statement.html.erb within layouts/mailer (0.5ms)
StatementMailer#send_statement: processed outbound mail in 24.6ms
Sent mail to tomnyongesa@outlook.com (3.5ms)
Date: Wed, 17 Apr 2019 14:36:34 +0000
From: juandsmithj@gmail.com
To: tomnyongesa@outlook.com
Message-ID: <5cb739f2b312_432ad00ba7e69846745@039811e68908.mail>
Subject: Statement
Mime-Version: 1.0
Content-Type: text/html;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <style>
      /* Email styles need to be inline */
    </style>
  </head>

  <body>
    <h1>Statement</h1>
    Total balance = 20000.00
  </body>
</html>

Completed 204 No Content in 39ms (ActiveRecord: 1.2ms)
  [1m[35m (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (1.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------
StatementControllerTest: test_get_statement
-------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "usera@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234567"], ["LIMIT", 1]]
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "usera@domain.com"], ["encrypted_password", "$2a$04$pYxKxZvv6QY2vu9D7kSCQOIqaZyMhlQJK4UCO3fimXoGeA7os/Egq"], ["phone_number", "0701234567"], ["full_name", "first user"], ["created_at", "2019-04-17 14:50:08.179182"], ["updated_at", "2019-04-17 14:50:08.179182"], ["jti", "0e08669e-90ea-423d-b386-954496268082"]]
  [1m[36mAccount Create (1.0ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 14:50:08.184630"], ["updated_at", "2019-04-17 14:50:08.184630"], ["owner_id", 62], ["owner_type", "User"]]
  [1m[36mAccount Load (0.5ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 62], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAccount Create (0.5ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 14:50:08.190269"], ["updated_at", "2019-04-17 14:50:08.190269"], ["owner_id", 62], ["owner_type", "User"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (1.1ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 92], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-17 14:50:08.192906"], ["updated_at", "2019-04-17 14:50:08.192906"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "userb@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234568"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "userb@domain.com"], ["encrypted_password", "$2a$04$06XDZ2UnePK8PinfTXuxQOejhdgHlBlzn1BrTAF95tse2Z3j9ulZW"], ["phone_number", "0701234568"], ["full_name", "first user"], ["created_at", "2019-04-17 14:50:08.199820"], ["updated_at", "2019-04-17 14:50:08.199820"], ["jti", "4724c556-22ea-46c0-95f1-9bfff83e4524"]]
  [1m[36mAccount Create (0.5ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 14:50:08.201748"], ["updated_at", "2019-04-17 14:50:08.201748"], ["owner_id", 63], ["owner_type", "User"]]
  [1m[36mAccount Load (0.4ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 63], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAccount Create (0.5ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 14:50:08.204614"], ["updated_at", "2019-04-17 14:50:08.204614"], ["owner_id", 63], ["owner_type", "User"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (0.6ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 94], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-17 14:50:08.206487"], ["updated_at", "2019-04-17 14:50:08.206487"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "userc@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234569"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "userc@domain.com"], ["encrypted_password", "$2a$04$Od55YrjY.sT/CYk7n6hwxO39XFiV3nq1uq.axMShXpWELv1xdr3l6"], ["phone_number", "0701234569"], ["full_name", "first user"], ["created_at", "2019-04-17 14:50:08.212685"], ["updated_at", "2019-04-17 14:50:08.212685"], ["jti", "3933e722-0ab7-45bc-beb9-33b92cb9b8b2"]]
  [1m[36mAccount Create (0.5ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 14:50:08.214658"], ["updated_at", "2019-04-17 14:50:08.214658"], ["owner_id", 64], ["owner_type", "User"]]
  [1m[36mAccount Load (0.4ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 64], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAccount Create (0.5ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 14:50:08.217534"], ["updated_at", "2019-04-17 14:50:08.217534"], ["owner_id", 64], ["owner_type", "User"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (0.6ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 96], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-17 14:50:08.219482"], ["updated_at", "2019-04-17 14:50:08.219482"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "userd@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234570"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "userd@domain.com"], ["encrypted_password", "$2a$04$wxTOOrtLizvCmbStNguLCeTWrISZvP.UnFQ2Bze8RVcg1ojI9S4ui"], ["phone_number", "0701234570"], ["full_name", "first user"], ["created_at", "2019-04-17 14:50:08.225378"], ["updated_at", "2019-04-17 14:50:08.225378"], ["jti", "479376b4-1874-42e1-8e2a-34b8eae6921f"]]
  [1m[36mAccount Create (0.5ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 14:50:08.227441"], ["updated_at", "2019-04-17 14:50:08.227441"], ["owner_id", 65], ["owner_type", "User"]]
  [1m[36mAccount Load (0.4ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 65], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAccount Create (0.5ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 14:50:08.230373"], ["updated_at", "2019-04-17 14:50:08.230373"], ["owner_id", 65], ["owner_type", "User"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (0.7ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 98], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-17 14:50:08.232365"], ["updated_at", "2019-04-17 14:50:08.232365"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "usere@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234571"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "usere@domain.com"], ["encrypted_password", "$2a$04$RuV64Zk45mZ7nD5XE1Ffs.hF4wEpzPGsnz7YXdgDnQjHVaPduDufm"], ["phone_number", "0701234571"], ["full_name", "first user"], ["created_at", "2019-04-17 14:50:08.238696"], ["updated_at", "2019-04-17 14:50:08.238696"], ["jti", "63a660c7-7160-4598-9c0e-0d385986d54c"]]
  [1m[36mAccount Create (0.6ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 14:50:08.240701"], ["updated_at", "2019-04-17 14:50:08.240701"], ["owner_id", 66], ["owner_type", "User"]]
  [1m[36mAccount Load (0.5ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 66], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAccount Create (0.5ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 14:50:08.243700"], ["updated_at", "2019-04-17 14:50:08.243700"], ["owner_id", 66], ["owner_type", "User"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (0.7ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 100], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-17 14:50:08.245605"], ["updated_at", "2019-04-17 14:50:08.245605"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/statement" for 127.0.0.1 at 2019-04-17 14:51:44 +0000
Processing by StatementController#statement as HTML
  [1m[36mUser Load (1.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  Rendering statement_mailer/send_statement.html.erb within layouts/mailer
  Rendered statement_mailer/send_statement.html.erb within layouts/mailer (0.4ms)
StatementMailer#send_statement: processed outbound mail in 20.8ms
Sent mail to tomnyongesa@outlook.com (2.1ms)
Date: Wed, 17 Apr 2019 14:51:44 +0000
From: juandsmithj@gmail.com
To: tomnyongesa@outlook.com
Message-ID: <5cb73d801cf98_4a2b23e52fe6b06996@039811e68908.mail>
Subject: Statement
Mime-Version: 1.0
Content-Type: text/html;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <style>
      /* Email styles need to be inline */
    </style>
  </head>

  <body>
    <h1>Statement</h1>
    Total balance = 20000.00
  </body>
</html>

Completed 204 No Content in 34ms (ActiveRecord: 1.3ms)
  [1m[35m (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (1.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------
StatementControllerTest: test_get_statement
-------------------------------------------
  [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "usera@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234567"], ["LIMIT", 1]]
  [1m[36mUser Create (1.0ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "usera@domain.com"], ["encrypted_password", "$2a$04$W8gfmcGR4mcATQe1ZWPnXe5YIhKHfn7UsiFfYgwTqVNaY3iR3NAoC"], ["phone_number", "0701234567"], ["full_name", "first user"], ["created_at", "2019-04-17 14:51:45.255674"], ["updated_at", "2019-04-17 14:51:45.255674"], ["jti", "e966aa6b-c971-4669-bcf6-a2c10247935d"]]
  [1m[36mAccount Create (1.1ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 14:51:45.260911"], ["updated_at", "2019-04-17 14:51:45.260911"], ["owner_id", 67], ["owner_type", "User"]]
  [1m[36mAccount Load (0.7ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 67], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAccount Create (0.7ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 14:51:45.267438"], ["updated_at", "2019-04-17 14:51:45.267438"], ["owner_id", 67], ["owner_type", "User"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (1.6ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 102], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-17 14:51:45.270722"], ["updated_at", "2019-04-17 14:51:45.270722"]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "userb@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234568"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "userb@domain.com"], ["encrypted_password", "$2a$04$sSPLg1tVpM0d5rgCjFuaRe6PD/FLIrfKP2IwZHSfKsEuvTxziBmUi"], ["phone_number", "0701234568"], ["full_name", "first user"], ["created_at", "2019-04-17 14:51:45.279570"], ["updated_at", "2019-04-17 14:51:45.279570"], ["jti", "7c130997-d1d2-47ba-adf2-628b061fa2bc"]]
  [1m[36mAccount Create (0.5ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 14:51:45.281855"], ["updated_at", "2019-04-17 14:51:45.281855"], ["owner_id", 68], ["owner_type", "User"]]
  [1m[36mAccount Load (0.3ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 68], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAccount Create (0.4ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 14:51:45.284822"], ["updated_at", "2019-04-17 14:51:45.284822"], ["owner_id", 68], ["owner_type", "User"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (0.6ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 104], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-17 14:51:45.286745"], ["updated_at", "2019-04-17 14:51:45.286745"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "userc@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234569"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "userc@domain.com"], ["encrypted_password", "$2a$04$XFnl.aWt27hBov/IM5xVwuY2WFkxjdJfgh0L8Q00k5W7nsKSeINs."], ["phone_number", "0701234569"], ["full_name", "first user"], ["created_at", "2019-04-17 14:51:45.292587"], ["updated_at", "2019-04-17 14:51:45.292587"], ["jti", "5bad454e-bbd2-4d83-9ab1-bea78103fa33"]]
  [1m[36mAccount Create (0.4ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 14:51:45.294421"], ["updated_at", "2019-04-17 14:51:45.294421"], ["owner_id", 69], ["owner_type", "User"]]
  [1m[36mAccount Load (0.3ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 69], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAccount Create (0.4ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 14:51:45.296962"], ["updated_at", "2019-04-17 14:51:45.296962"], ["owner_id", 69], ["owner_type", "User"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (0.6ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 106], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-17 14:51:45.298768"], ["updated_at", "2019-04-17 14:51:45.298768"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "userd@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234570"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "userd@domain.com"], ["encrypted_password", "$2a$04$by/hkMw8n.tW61l1ywLsvOuE9By/.mCHXLpV0JwzJMoflPRwrlH7S"], ["phone_number", "0701234570"], ["full_name", "first user"], ["created_at", "2019-04-17 14:51:45.304589"], ["updated_at", "2019-04-17 14:51:45.304589"], ["jti", "8d4e2b0e-395a-4ec3-927d-7ffb674bc039"]]
  [1m[36mAccount Create (0.5ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 14:51:45.306516"], ["updated_at", "2019-04-17 14:51:45.306516"], ["owner_id", 70], ["owner_type", "User"]]
  [1m[36mAccount Load (0.4ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 70], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAccount Create (0.6ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 14:51:45.309660"], ["updated_at", "2019-04-17 14:51:45.309660"], ["owner_id", 70], ["owner_type", "User"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (0.7ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 108], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-17 14:51:45.312015"], ["updated_at", "2019-04-17 14:51:45.312015"]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "usere@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234571"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "usere@domain.com"], ["encrypted_password", "$2a$04$dn/JF.MOx.VV02J7nWYSFu40z6MWG2iYzkJtIGFi1iTjA7lmN/V96"], ["phone_number", "0701234571"], ["full_name", "first user"], ["created_at", "2019-04-17 14:51:45.318809"], ["updated_at", "2019-04-17 14:51:45.318809"], ["jti", "7b15b43d-b80b-4f20-bd65-e931de36a48e"]]
  [1m[36mAccount Create (0.6ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 14:51:45.320926"], ["updated_at", "2019-04-17 14:51:45.320926"], ["owner_id", 71], ["owner_type", "User"]]
  [1m[36mAccount Load (0.5ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 71], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAccount Create (0.6ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-17 14:51:45.324312"], ["updated_at", "2019-04-17 14:51:45.324312"], ["owner_id", 71], ["owner_type", "User"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (0.8ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 110], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-17 14:51:45.326687"], ["updated_at", "2019-04-17 14:51:45.326687"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/statement" for 127.0.0.1 at 2019-04-17 14:51:45 +0000
Processing by StatementController#statement as HTML
  [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
  Rendering statement_mailer/send_statement.html.erb within layouts/mailer
  Rendered statement_mailer/send_statement.html.erb within layouts/mailer (0.5ms)
StatementMailer#send_statement: processed outbound mail in 21.2ms
Sent mail to tomnyongesa@outlook.com (2.5ms)
Date: Wed, 17 Apr 2019 14:51:45 +0000
From: juandsmithj@gmail.com
To: tomnyongesa@outlook.com
Message-ID: <5cb73d815c0ff_502ae420d2e680774c9@039811e68908.mail>
Subject: Statement
Mime-Version: 1.0
Content-Type: text/html;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <style>
      /* Email styles need to be inline */
    </style>
  </head>

  <body>
    <h1>Statement</h1>
    Total balance = 20000.00
  </body>
</html>

Completed 204 No Content in 33ms (ActiveRecord: 1.1ms)
  [1m[35m (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (20.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------
StatementControllerTest: test_send_Statement
--------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (63.9ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "usera@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (1.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234567"], ["LIMIT", 1]]
  [1m[36mUser Create (42.7ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "usera@domain.com"], ["encrypted_password", "$2a$04$70.PLZUilLXEerJ7FNG7NuUhnVTwGgX.HPq9MZYLLmEAwmG78Q0RS"], ["phone_number", "0701234567"], ["full_name", "first user"], ["created_at", "2019-04-25 12:37:51.314749"], ["updated_at", "2019-04-25 12:37:51.314749"], ["jti", "cd7ea4e8-7307-46d5-95e4-67b8212cb337"]]
  [1m[36mAccount Create (62.3ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-25 12:37:51.507069"], ["updated_at", "2019-04-25 12:37:51.507069"], ["owner_id", 72], ["owner_type", "User"]]
  [1m[36mAccount Load (0.9ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 72], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "userb@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234568"], ["LIMIT", 1]]
  [1m[36mUser Create (1.0ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "userb@domain.com"], ["encrypted_password", "$2a$04$OVLXXZLqAEmMPJp6gxGWm.07lO20373tZK2JeEn8s.0vW.hufESz2"], ["phone_number", "0701234568"], ["full_name", "first user"], ["created_at", "2019-04-25 12:37:51.601999"], ["updated_at", "2019-04-25 12:37:51.601999"], ["jti", "6b1d7789-0091-47aa-9f17-7fe7a57af9ec"]]
  [1m[36mAccount Create (1.2ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-25 12:37:51.606462"], ["updated_at", "2019-04-25 12:37:51.606462"], ["owner_id", 73], ["owner_type", "User"]]
  [1m[36mAccount Load (0.8ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 73], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAccount Create (0.8ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-25 12:37:51.614983"], ["updated_at", "2019-04-25 12:37:51.614983"], ["owner_id", 73], ["owner_type", "User"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (38.1ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 113], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-25 12:37:51.669040"], ["updated_at", "2019-04-25 12:37:51.669040"]]
  [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (1.2ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 113], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-25 12:37:51.710980"], ["updated_at", "2019-04-25 12:37:51.710980"]]
  [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (1.2ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 113], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-25 12:37:51.716185"], ["updated_at", "2019-04-25 12:37:51.716185"]]
  [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (1.0ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 113], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-25 12:37:51.720342"], ["updated_at", "2019-04-25 12:37:51.720342"]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (1.0ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 113], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-25 12:37:51.723508"], ["updated_at", "2019-04-25 12:37:51.723508"]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/accounts/113/statement?email=usera%40domain.com&start_date=2019-04-25+12%3A37%3A51+UTC&end_date=2019-04-25+12%3A37%3A51+%2B0000" for 127.0.0.1 at 2019-04-25 12:37:51 +0000
Processing by StatementController#get_statement as HTML
  Parameters: {"email"=>"usera@domain.com", "start_date"=>"2019-04-25 12:37:51 UTC", "end_date"=>"2019-04-25 12:37:51 +0000", "account_id"=>"113"}
Completed 500 Internal Server Error in 6ms (ActiveRecord: 0.0ms)
  [1m[35m (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (1.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------
StatementControllerTest: test_send_Statement
--------------------------------------------
  [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "usera@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234567"], ["LIMIT", 1]]
  [1m[36mUser Create (1.0ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "usera@domain.com"], ["encrypted_password", "$2a$04$CAmrwD9D9dUs/Lvll3si2exbDHsIfppWgjjuuNlJj7nA3DBgyqdVi"], ["phone_number", "0701234567"], ["full_name", "first user"], ["created_at", "2019-04-25 12:38:37.322492"], ["updated_at", "2019-04-25 12:38:37.322492"], ["jti", "34e11ee1-39ca-48f3-a2ea-de3c8b324ac7"]]
  [1m[36mAccount Create (0.8ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-25 12:38:37.341805"], ["updated_at", "2019-04-25 12:38:37.341805"], ["owner_id", 74], ["owner_type", "User"]]
  [1m[36mAccount Load (0.6ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 74], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "userb@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234568"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "userb@domain.com"], ["encrypted_password", "$2a$04$ZJ7LmoFX5XAo//TQ8xiP2OTQXdTXpsSGenRFiOkBTVZhwx3Cya4xC"], ["phone_number", "0701234568"], ["full_name", "first user"], ["created_at", "2019-04-25 12:38:37.352105"], ["updated_at", "2019-04-25 12:38:37.352105"], ["jti", "70947944-d24a-444f-b59d-51e7f6ee0c72"]]
  [1m[36mAccount Create (0.6ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-25 12:38:37.354286"], ["updated_at", "2019-04-25 12:38:37.354286"], ["owner_id", 75], ["owner_type", "User"]]
  [1m[36mAccount Load (0.6ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 75], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAccount Create (0.6ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-25 12:38:37.358753"], ["updated_at", "2019-04-25 12:38:37.358753"], ["owner_id", 75], ["owner_type", "User"]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (1.0ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 116], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-25 12:38:37.380961"], ["updated_at", "2019-04-25 12:38:37.380961"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (0.8ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 116], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-25 12:38:37.384301"], ["updated_at", "2019-04-25 12:38:37.384301"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (0.7ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 116], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-25 12:38:37.387164"], ["updated_at", "2019-04-25 12:38:37.387164"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (0.4ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 116], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-25 12:38:37.389699"], ["updated_at", "2019-04-25 12:38:37.389699"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (0.4ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 116], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-25 12:38:37.391572"], ["updated_at", "2019-04-25 12:38:37.391572"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/accounts/116/statement?email=usera%40domain.com&start_date=2019-04-25+12%3A38%3A37+UTC&end_date=2019-04-25+12%3A38%3A37+%2B0000" for 127.0.0.1 at 2019-04-25 12:38:37 +0000
Processing by StatementController#get_statement as HTML
  Parameters: {"email"=>"usera@domain.com", "start_date"=>"2019-04-25 12:38:37 UTC", "end_date"=>"2019-04-25 12:38:37 +0000", "account_id"=>"116"}
  [1m[36mAccount Load (0.4ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 LIMIT $2[0m  [["id", 116], ["LIMIT", 1]]
Completed 500 Internal Server Error in 71ms (ActiveRecord: 0.4ms)
  [1m[35m (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (1.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------
StatementControllerTest: test_send_Statement
--------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "usera@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234567"], ["LIMIT", 1]]
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "usera@domain.com"], ["encrypted_password", "$2a$04$8OgLzXL4XiqaCyIL8LruzO7.NxS8SV2VjLOieE41rRHyhanhuz0mu"], ["phone_number", "0701234567"], ["full_name", "first user"], ["created_at", "2019-04-25 12:38:46.932302"], ["updated_at", "2019-04-25 12:38:46.932302"], ["jti", "761587f9-6aa0-45c0-9ff8-1ae589d5e523"]]
  [1m[36mAccount Create (0.9ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-25 12:38:46.952410"], ["updated_at", "2019-04-25 12:38:46.952410"], ["owner_id", 76], ["owner_type", "User"]]
  [1m[36mAccount Load (0.6ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 76], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (5.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "userb@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234568"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "userb@domain.com"], ["encrypted_password", "$2a$04$2eNERIFiQpR3HaLpL52P2O/R2m4Fj77fK8T6An0DblO06gTmCrQgq"], ["phone_number", "0701234568"], ["full_name", "first user"], ["created_at", "2019-04-25 12:38:46.971346"], ["updated_at", "2019-04-25 12:38:46.971346"], ["jti", "334f4997-b50f-4894-9531-c0b14979adfd"]]
  [1m[36mAccount Create (0.6ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-25 12:38:46.973589"], ["updated_at", "2019-04-25 12:38:46.973589"], ["owner_id", 77], ["owner_type", "User"]]
  [1m[36mAccount Load (0.4ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 77], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAccount Create (0.6ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-25 12:38:46.977406"], ["updated_at", "2019-04-25 12:38:46.977406"], ["owner_id", 77], ["owner_type", "User"]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (1.1ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 119], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-25 12:38:46.995338"], ["updated_at", "2019-04-25 12:38:46.995338"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (0.7ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 119], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-25 12:38:46.998802"], ["updated_at", "2019-04-25 12:38:46.998802"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (0.6ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 119], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-25 12:38:47.001628"], ["updated_at", "2019-04-25 12:38:47.001628"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (0.7ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 119], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-25 12:38:47.004457"], ["updated_at", "2019-04-25 12:38:47.004457"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (0.6ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 119], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-25 12:38:47.008131"], ["updated_at", "2019-04-25 12:38:47.008131"]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/accounts/119/statement?email=usera%40domain.com&start_date=2019-04-25+12%3A38%3A46+UTC&end_date=2019-04-25+12%3A38%3A47+%2B0000" for 127.0.0.1 at 2019-04-25 12:38:47 +0000
Processing by StatementController#get_statement as HTML
  Parameters: {"email"=>"usera@domain.com", "start_date"=>"2019-04-25 12:38:46 UTC", "end_date"=>"2019-04-25 12:38:47 +0000", "account_id"=>"119"}
  [1m[36mAccount Load (0.3ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 LIMIT $2[0m  [["id", 119], ["LIMIT", 1]]
Completed 500 Internal Server Error in 19ms (ActiveRecord: 0.3ms)
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------
StatementControllerTest: test_send_Statement
--------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.0ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "usera@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234567"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "usera@domain.com"], ["encrypted_password", "$2a$04$NKPlhHiX3iB5uSZGwPCk8uY5yoDanxaiQwzULqabhXq70J.3ygdTO"], ["phone_number", "0701234567"], ["full_name", "first user"], ["created_at", "2019-04-25 12:39:06.672379"], ["updated_at", "2019-04-25 12:39:06.672379"], ["jti", "f41ac6c2-7934-4958-998e-0f1a570c0cda"]]
  [1m[36mAccount Create (0.7ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-25 12:39:06.690887"], ["updated_at", "2019-04-25 12:39:06.690887"], ["owner_id", 78], ["owner_type", "User"]]
  [1m[36mAccount Load (0.4ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 78], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "userb@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234568"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "userb@domain.com"], ["encrypted_password", "$2a$04$vB.earUaJhDNGph5ogmwfOeEt8ySczJMJNJ4sc74/6qzCLFbujDdC"], ["phone_number", "0701234568"], ["full_name", "first user"], ["created_at", "2019-04-25 12:39:06.700031"], ["updated_at", "2019-04-25 12:39:06.700031"], ["jti", "7ed5039e-0b53-4d47-a8e8-8a2bacd0ced0"]]
  [1m[36mAccount Create (0.5ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-25 12:39:06.702443"], ["updated_at", "2019-04-25 12:39:06.702443"], ["owner_id", 79], ["owner_type", "User"]]
  [1m[36mAccount Load (0.4ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 79], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAccount Create (0.8ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-25 12:39:06.706506"], ["updated_at", "2019-04-25 12:39:06.706506"], ["owner_id", 79], ["owner_type", "User"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (1.0ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 122], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-25 12:39:06.725557"], ["updated_at", "2019-04-25 12:39:06.725557"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (0.6ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 122], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-25 12:39:06.728979"], ["updated_at", "2019-04-25 12:39:06.728979"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (0.5ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 122], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-25 12:39:06.732206"], ["updated_at", "2019-04-25 12:39:06.732206"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (0.4ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 122], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-25 12:39:06.734472"], ["updated_at", "2019-04-25 12:39:06.734472"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (0.6ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 122], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-25 12:39:06.736916"], ["updated_at", "2019-04-25 12:39:06.736916"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/accounts/122/statement?email=usera%40domain.com&start_date=2019-04-25+12%3A39%3A06+UTC&end_date=2019-04-25+12%3A39%3A06+%2B0000" for 127.0.0.1 at 2019-04-25 12:39:06 +0000
Processing by StatementController#get_statement as HTML
  Parameters: {"email"=>"usera@domain.com", "start_date"=>"2019-04-25 12:39:06 UTC", "end_date"=>"2019-04-25 12:39:06 +0000", "account_id"=>"122"}
  [1m[36mAccount Load (0.3ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 LIMIT $2[0m  [["id", 122], ["LIMIT", 1]]
Completed 500 Internal Server Error in 19ms (ActiveRecord: 0.3ms)
  [1m[35m (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------
StatementControllerTest: test_send_Statement
--------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "usera@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234567"], ["LIMIT", 1]]
  [1m[36mUser Create (0.9ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "usera@domain.com"], ["encrypted_password", "$2a$04$QIewo/qVj1M8uRAVWALtqOY0rl5zc.Vro/Jxorzw0.taXMkXSm3nK"], ["phone_number", "0701234567"], ["full_name", "first user"], ["created_at", "2019-04-25 12:39:42.509152"], ["updated_at", "2019-04-25 12:39:42.509152"], ["jti", "d7103522-531f-47eb-98c2-9bd3a83ad978"]]
  [1m[36mAccount Create (1.0ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-25 12:39:42.531097"], ["updated_at", "2019-04-25 12:39:42.531097"], ["owner_id", 80], ["owner_type", "User"]]
  [1m[36mAccount Load (0.7ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 80], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "userb@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234568"], ["LIMIT", 1]]
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "userb@domain.com"], ["encrypted_password", "$2a$04$9OlHt8C/pa1cF6tCV2lBe.bCgOkodUHrZFSa5e/D7l/u4mc60.itG"], ["phone_number", "0701234568"], ["full_name", "first user"], ["created_at", "2019-04-25 12:39:42.542485"], ["updated_at", "2019-04-25 12:39:42.542485"], ["jti", "71ae96ec-d92c-4481-a875-78708fbe0bd7"]]
  [1m[36mAccount Create (0.6ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-25 12:39:42.544709"], ["updated_at", "2019-04-25 12:39:42.544709"], ["owner_id", 81], ["owner_type", "User"]]
  [1m[36mAccount Load (0.5ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 81], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAccount Create (0.4ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-25 12:39:42.548015"], ["updated_at", "2019-04-25 12:39:42.548015"], ["owner_id", 81], ["owner_type", "User"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (1.2ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 125], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-25 12:39:42.565110"], ["updated_at", "2019-04-25 12:39:42.565110"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (0.6ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 125], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-25 12:39:42.568432"], ["updated_at", "2019-04-25 12:39:42.568432"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (0.5ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 125], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-25 12:39:42.570900"], ["updated_at", "2019-04-25 12:39:42.570900"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (0.7ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 125], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-25 12:39:42.573044"], ["updated_at", "2019-04-25 12:39:42.573044"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (0.8ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 125], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-25 12:39:42.575739"], ["updated_at", "2019-04-25 12:39:42.575739"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/accounts/125/statement?email=usera%40domain.com&start_date=2019-04-25+12%3A39%3A42+UTC&end_date=2019-04-25+12%3A39%3A42+%2B0000" for 127.0.0.1 at 2019-04-25 12:39:42 +0000
Processing by StatementController#get_statement as HTML
  Parameters: {"email"=>"usera@domain.com", "start_date"=>"2019-04-25 12:39:42 UTC", "end_date"=>"2019-04-25 12:39:42 +0000", "account_id"=>"125"}
  [1m[36mAccount Load (0.4ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 LIMIT $2[0m  [["id", 125], ["LIMIT", 1]]
Completed 500 Internal Server Error in 19513ms (ActiveRecord: 0.4ms)
  [1m[35m (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
----------------------------------------
TransactionsControllerTest: test_deposit
----------------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "usera@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234567"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "usera@domain.com"], ["encrypted_password", "$2a$04$AMPuPMcZwSy17jqy/RKuIegUOF71TnxRLJTBI8hZ/amMmCAF2qQjS"], ["phone_number", "0701234567"], ["full_name", "first user"], ["created_at", "2019-04-25 12:40:27.780727"], ["updated_at", "2019-04-25 12:40:27.780727"], ["jti", "48a6ec42-bde4-4dfa-a69f-3cf06535fe32"]]
  [1m[36mAccount Create (0.8ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-25 12:40:27.799017"], ["updated_at", "2019-04-25 12:40:27.799017"], ["owner_id", 82], ["owner_type", "User"]]
  [1m[36mAccount Load (0.7ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 82], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAgency Create (34.3ms)[0m  [1m[32mINSERT INTO "agencies" ("business_name", "location", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["business_name", "Well chosen"], ["location", "kwa stima"], ["user_id", 82], ["created_at", "2019-04-25 12:40:27.805664"], ["updated_at", "2019-04-25 12:40:27.805664"]]
  [1m[36mAgency Load (1.1ms)[0m  [1m[34mSELECT  "agencies".* FROM "agencies" WHERE "agencies"."id" = $1 LIMIT $2[0m  [["id", 9], ["LIMIT", 1]]
  [1m[36mAccount Load (0.8ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 9], ["owner_type", "Agency"], ["LIMIT", 1]]
  [1m[36mAccount Create (0.8ms)[0m  [1m[32mINSERT INTO "accounts" ("balance", "created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["balance", 100000], ["created_at", "2019-04-25 12:40:27.853195"], ["updated_at", "2019-04-25 12:40:27.853195"], ["owner_id", 9], ["owner_type", "Agency"]]
  [1m[36mAccount Load (0.7ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 9], ["owner_type", "Agency"], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "userb@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234568"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "userb@domain.com"], ["encrypted_password", "$2a$04$T4VCwW9230vMlyh2t.sTreCpiGz.lLerpu9rqWq3mmuazc8dDFHYy"], ["phone_number", "0701234568"], ["full_name", "first user"], ["created_at", "2019-04-25 12:40:27.862356"], ["updated_at", "2019-04-25 12:40:27.862356"], ["jti", "a936c8f0-3928-449b-bda3-02838ebadd0f"]]
  [1m[36mAccount Create (0.7ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-25 12:40:27.864611"], ["updated_at", "2019-04-25 12:40:27.864611"], ["owner_id", 83], ["owner_type", "User"]]
  [1m[36mAccount Load (0.6ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 83], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/transactions/deposit" for 127.0.0.1 at 2019-04-25 12:40:27 +0000
Processing by TransactionsController#deposit as HTML
  Parameters: {"data"=>{"amount"=>"1000", "phone"=>"0701234568"}}
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234568"], ["LIMIT", 1]]
  [1m[36mAccount Load (0.8ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 83], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[36mAccount Load (1.0ms)[0m  [1m[37mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 127], ["LIMIT", 1]]
  [1m[36mAccount Load (0.8ms)[0m  [1m[37mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 128], ["LIMIT", 1]]
  [1m[36mTransaktion Load (1.6ms)[0m  [1m[34mSELECT  "transaktions".* FROM "transaktions" ORDER BY "transaktions"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 83], ["LIMIT", 1]]
  [1m[36mAccount Update (0.5ms)[0m  [1m[33mUPDATE "accounts" SET "balance" = $1, "updated_at" = $2 WHERE "accounts"."id" = $3[0m  [["balance", 1000], ["updated_at", "2019-04-25 12:40:29.813473"], ["id", 128]]
  [1m[36mTransaktion Create (0.7ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 128], ["trans_set", "AAAA0001"], ["balance", 1000.0], ["trans_type", "deposit"], ["amount", 1000.0], ["created_at", "2019-04-25 12:40:29.814942"], ["updated_at", "2019-04-25 12:40:29.814942"]]
  [1m[36mAgency Load (0.3ms)[0m  [1m[34mSELECT  "agencies".* FROM "agencies" WHERE "agencies"."id" = $1 LIMIT $2[0m  [["id", 9], ["LIMIT", 1]]
  [1m[36mAccount Update (0.5ms)[0m  [1m[33mUPDATE "accounts" SET "balance" = $1, "updated_at" = $2 WHERE "accounts"."id" = $3[0m  [["balance", 99000], ["updated_at", "2019-04-25 12:40:29.818120"], ["id", 127]]
  [1m[36mTransaktion Create (0.6ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 127], ["trans_set", "AAAA0001"], ["balance", 99000.0], ["trans_type", "deposit"], ["amount", 1000.0], ["created_at", "2019-04-25 12:40:29.819425"], ["updated_at", "2019-04-25 12:40:29.819425"]]
  [1m[36mTransaktion Load (0.6ms)[0m  [1m[34mSELECT  "transaktions".* FROM "transaktions" WHERE "transaktions"."account_id" = $1 ORDER BY "transaktions"."id" DESC LIMIT $2[0m  [["account_id", 127], ["LIMIT", 1]]
  [1m[36mTransaktion Load (0.5ms)[0m  [1m[34mSELECT  "transaktions".* FROM "transaktions" WHERE "transaktions"."account_id" = $1 ORDER BY "transaktions"."id" DESC LIMIT $2[0m  [["account_id", 128], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mCACHE Transaktion Load (0.0ms)[0m  [1m[34mSELECT  "transaktions".* FROM "transaktions" WHERE "transaktions"."account_id" = $1 ORDER BY "transaktions"."id" DESC LIMIT $2[0m  [["account_id", 127], ["LIMIT", 1]]
Completed 200 OK in 1905ms (Views: 0.5ms | ActiveRecord: 14.5ms)
  [1m[35m (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------
TransactionsControllerTest: test_withdraw
-----------------------------------------
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "userc@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234569"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "userc@domain.com"], ["encrypted_password", "$2a$04$I/3ULSed.E1gbcRmhb39xeDp9VCd/TkSZS2PYLu6AOu4X0.mdimIa"], ["phone_number", "0701234569"], ["full_name", "first user"], ["created_at", "2019-04-25 12:40:29.889515"], ["updated_at", "2019-04-25 12:40:29.889515"], ["jti", "3c46b4af-1b90-472b-8084-d1ec7304be45"]]
  [1m[36mAccount Create (0.6ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-25 12:40:29.891996"], ["updated_at", "2019-04-25 12:40:29.891996"], ["owner_id", 84], ["owner_type", "User"]]
  [1m[36mAccount Load (0.4ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 84], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAgency Create (0.8ms)[0m  [1m[32mINSERT INTO "agencies" ("business_name", "location", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["business_name", "Well chosen"], ["location", "kwa stima"], ["user_id", 84], ["created_at", "2019-04-25 12:40:29.895791"], ["updated_at", "2019-04-25 12:40:29.895791"]]
  [1m[36mAgency Load (0.5ms)[0m  [1m[34mSELECT  "agencies".* FROM "agencies" WHERE "agencies"."id" = $1 LIMIT $2[0m  [["id", 10], ["LIMIT", 1]]
  [1m[36mAccount Load (0.3ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 10], ["owner_type", "Agency"], ["LIMIT", 1]]
  [1m[36mAccount Create (0.5ms)[0m  [1m[32mINSERT INTO "accounts" ("balance", "created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["balance", 100000], ["created_at", "2019-04-25 12:40:29.900012"], ["updated_at", "2019-04-25 12:40:29.900012"], ["owner_id", 10], ["owner_type", "Agency"]]
  [1m[36mAccount Load (0.3ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 10], ["owner_type", "Agency"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "userd@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234570"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "userd@domain.com"], ["encrypted_password", "$2a$04$0QUtbXgXEzDOe.an4/9iGerFCsj4Vv7jzV2917iD6504kwagYFYp6"], ["phone_number", "0701234570"], ["full_name", "first user"], ["created_at", "2019-04-25 12:40:29.906628"], ["updated_at", "2019-04-25 12:40:29.906628"], ["jti", "bd6e91a9-dd32-4ce4-99a6-02d5211f0edc"]]
  [1m[36mAccount Create (0.6ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-25 12:40:29.908683"], ["updated_at", "2019-04-25 12:40:29.908683"], ["owner_id", 85], ["owner_type", "User"]]
  [1m[36mAccount Load (0.3ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 85], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAccount Update (0.6ms)[0m  [1m[33mUPDATE "accounts" SET "balance" = $1, "updated_at" = $2 WHERE "accounts"."id" = $3[0m  [["balance", 2500], ["updated_at", "2019-04-25 12:40:29.911614"], ["id", 131]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/transactions/withdrawal" for 127.0.0.1 at 2019-04-25 12:40:29 +0000
Processing by TransactionsController#withdraw as HTML
  Parameters: {"data"=>{"amount"=>"1000", "phone"=>"0701234570", "agent_number"=>"10"}}
  [1m[35m (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
----------------------------------------
TransactionsControllerTest: test_deposit
----------------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "usera@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234567"], ["LIMIT", 1]]
  [1m[36mUser Create (0.9ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "usera@domain.com"], ["encrypted_password", "$2a$04$d8yKia0DclyqpSvDB9rqseZZXnM3wOpU7QVbYU0di9OZ3A0PWc0wO"], ["phone_number", "0701234567"], ["full_name", "first user"], ["created_at", "2019-04-25 12:41:41.271806"], ["updated_at", "2019-04-25 12:41:41.271806"], ["jti", "7fea88fb-a9df-400d-b13e-d42ed6cef245"]]
  [1m[36mAccount Create (0.7ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-25 12:41:41.293299"], ["updated_at", "2019-04-25 12:41:41.293299"], ["owner_id", 86], ["owner_type", "User"]]
  [1m[36mAccount Load (0.4ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 86], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAgency Create (1.0ms)[0m  [1m[32mINSERT INTO "agencies" ("business_name", "location", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["business_name", "Well chosen"], ["location", "kwa stima"], ["user_id", 86], ["created_at", "2019-04-25 12:41:41.298992"], ["updated_at", "2019-04-25 12:41:41.298992"]]
  [1m[36mAgency Load (0.4ms)[0m  [1m[34mSELECT  "agencies".* FROM "agencies" WHERE "agencies"."id" = $1 LIMIT $2[0m  [["id", 11], ["LIMIT", 1]]
  [1m[36mAccount Load (0.4ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 11], ["owner_type", "Agency"], ["LIMIT", 1]]
  [1m[36mAccount Create (0.4ms)[0m  [1m[32mINSERT INTO "accounts" ("balance", "created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["balance", 100000], ["created_at", "2019-04-25 12:41:41.304726"], ["updated_at", "2019-04-25 12:41:41.304726"], ["owner_id", 11], ["owner_type", "Agency"]]
  [1m[36mAccount Load (0.5ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 11], ["owner_type", "Agency"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "userb@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234568"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "userb@domain.com"], ["encrypted_password", "$2a$04$B/tcDnP.YRhBKTVEfan4YOsT6Y0wT0G6zPaF.EobHm0kJqeoRUG/W"], ["phone_number", "0701234568"], ["full_name", "first user"], ["created_at", "2019-04-25 12:41:41.311827"], ["updated_at", "2019-04-25 12:41:41.311827"], ["jti", "652c6b39-c531-41ed-bb02-a958c12166db"]]
  [1m[36mAccount Create (0.4ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-25 12:41:41.313737"], ["updated_at", "2019-04-25 12:41:41.313737"], ["owner_id", 87], ["owner_type", "User"]]
  [1m[36mAccount Load (0.3ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 87], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/transactions/deposit" for 127.0.0.1 at 2019-04-25 12:41:41 +0000
Processing by TransactionsController#deposit as HTML
  Parameters: {"data"=>{"amount"=>"1000", "phone"=>"0701234568"}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234568"], ["LIMIT", 1]]
  [1m[36mAccount Load (0.3ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 87], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[36mAccount Load (0.3ms)[0m  [1m[37mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 133], ["LIMIT", 1]]
  [1m[36mAccount Load (1.0ms)[0m  [1m[37mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 134], ["LIMIT", 1]]
  [1m[36mTransaktion Load (0.8ms)[0m  [1m[34mSELECT  "transaktions".* FROM "transaktions" ORDER BY "transaktions"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 87], ["LIMIT", 1]]
  [1m[36mAccount Update (0.9ms)[0m  [1m[33mUPDATE "accounts" SET "balance" = $1, "updated_at" = $2 WHERE "accounts"."id" = $3[0m  [["balance", 1000], ["updated_at", "2019-04-25 12:42:06.349534"], ["id", 134]]
  [1m[36mTransaktion Create (1.3ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 134], ["trans_set", "AAAA0001"], ["balance", 1000.0], ["trans_type", "deposit"], ["amount", 1000.0], ["created_at", "2019-04-25 12:42:06.351532"], ["updated_at", "2019-04-25 12:42:06.351532"]]
  [1m[36mAgency Load (0.7ms)[0m  [1m[34mSELECT  "agencies".* FROM "agencies" WHERE "agencies"."id" = $1 LIMIT $2[0m  [["id", 11], ["LIMIT", 1]]
  [1m[36mAccount Update (0.8ms)[0m  [1m[33mUPDATE "accounts" SET "balance" = $1, "updated_at" = $2 WHERE "accounts"."id" = $3[0m  [["balance", 99000], ["updated_at", "2019-04-25 12:42:06.355809"], ["id", 133]]
  [1m[36mTransaktion Create (1.0ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 133], ["trans_set", "AAAA0001"], ["balance", 99000.0], ["trans_type", "deposit"], ["amount", 1000.0], ["created_at", "2019-04-25 12:42:06.357529"], ["updated_at", "2019-04-25 12:42:06.357529"]]
  [1m[36mTransaktion Load (0.9ms)[0m  [1m[34mSELECT  "transaktions".* FROM "transaktions" WHERE "transaktions"."account_id" = $1 ORDER BY "transaktions"."id" DESC LIMIT $2[0m  [["account_id", 133], ["LIMIT", 1]]
  [1m[36mTransaktion Load (0.8ms)[0m  [1m[34mSELECT  "transaktions".* FROM "transaktions" WHERE "transaktions"."account_id" = $1 ORDER BY "transaktions"."id" DESC LIMIT $2[0m  [["account_id", 134], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mCACHE Transaktion Load (0.0ms)[0m  [1m[34mSELECT  "transaktions".* FROM "transaktions" WHERE "transaktions"."account_id" = $1 ORDER BY "transaktions"."id" DESC LIMIT $2[0m  [["account_id", 133], ["LIMIT", 1]]
Completed 200 OK in 25019ms (Views: 0.5ms | ActiveRecord: 15.7ms)
  [1m[35m (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------
TransactionsControllerTest: test_send_money
-------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "userc@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234569"], ["LIMIT", 1]]
  [1m[36mUser Create (7122.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "userc@domain.com"], ["encrypted_password", "$2a$04$OReE9iEwf5jFcVIMgIzmwuOSBFbXMQLolp0Qu6ixXLc6RbQ5GneNu"], ["phone_number", "0701234569"], ["full_name", "first user"], ["created_at", "2019-04-25 12:42:06.372131"], ["updated_at", "2019-04-25 12:42:06.372131"], ["jti", "5cb73d38-97fc-411b-92ad-0fde109d8044"]]
  [1m[35m (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
----------------------------------------
TransactionsControllerTest: test_deposit
----------------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "usera@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234567"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "usera@domain.com"], ["encrypted_password", "$2a$04$6mU4.atgyBtN1IWGm9x.k.GcBG9Kilo.mezVS1uguOCBAm//V6A7a"], ["phone_number", "0701234567"], ["full_name", "first user"], ["created_at", "2019-04-25 12:42:29.308586"], ["updated_at", "2019-04-25 12:42:29.308586"], ["jti", "03442e2e-a8d6-427d-9cf0-9c159902aad8"]]
  [1m[36mAccount Create (0.8ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-25 12:42:29.325915"], ["updated_at", "2019-04-25 12:42:29.325915"], ["owner_id", 89], ["owner_type", "User"]]
  [1m[36mAccount Load (0.4ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 89], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAgency Create (1.2ms)[0m  [1m[32mINSERT INTO "agencies" ("business_name", "location", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["business_name", "Well chosen"], ["location", "kwa stima"], ["user_id", 89], ["created_at", "2019-04-25 12:42:29.332877"], ["updated_at", "2019-04-25 12:42:29.332877"]]
  [1m[36mAgency Load (0.3ms)[0m  [1m[34mSELECT  "agencies".* FROM "agencies" WHERE "agencies"."id" = $1 LIMIT $2[0m  [["id", 12], ["LIMIT", 1]]
  [1m[36mAccount Load (0.3ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 12], ["owner_type", "Agency"], ["LIMIT", 1]]
  [1m[36mAccount Create (0.4ms)[0m  [1m[32mINSERT INTO "accounts" ("balance", "created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["balance", 100000], ["created_at", "2019-04-25 12:42:29.339303"], ["updated_at", "2019-04-25 12:42:29.339303"], ["owner_id", 12], ["owner_type", "Agency"]]
  [1m[36mAccount Load (0.3ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 12], ["owner_type", "Agency"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "userb@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234568"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "userb@domain.com"], ["encrypted_password", "$2a$04$VWJNspyYrfpeps5YQZmSY.flj/yNListF7BXcdoGnXDD7ostP50c2"], ["phone_number", "0701234568"], ["full_name", "first user"], ["created_at", "2019-04-25 12:42:29.347341"], ["updated_at", "2019-04-25 12:42:29.347341"], ["jti", "114f9cd8-5fbf-4d59-8e51-6ccc830b4ed8"]]
  [1m[36mAccount Create (0.4ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-25 12:42:29.349776"], ["updated_at", "2019-04-25 12:42:29.349776"], ["owner_id", 90], ["owner_type", "User"]]
  [1m[36mAccount Load (0.3ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 90], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/transactions/deposit" for 127.0.0.1 at 2019-04-25 12:42:29 +0000
Processing by TransactionsController#deposit as HTML
  Parameters: {"data"=>{"amount"=>"1000", "phone"=>"0701234568"}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234568"], ["LIMIT", 1]]
  [1m[36mAccount Load (0.5ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 90], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[36mAccount Load (0.6ms)[0m  [1m[37mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 136], ["LIMIT", 1]]
  [1m[36mAccount Load (0.5ms)[0m  [1m[37mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 137], ["LIMIT", 1]]
  [1m[36mTransaktion Load (0.9ms)[0m  [1m[34mSELECT  "transaktions".* FROM "transaktions" ORDER BY "transaktions"."id" DESC LIMIT $1[0m  [["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 90], ["LIMIT", 1]]
  [1m[36mAccount Update (0.7ms)[0m  [1m[33mUPDATE "accounts" SET "balance" = $1, "updated_at" = $2 WHERE "accounts"."id" = $3[0m  [["balance", 1000], ["updated_at", "2019-04-25 12:42:29.405612"], ["id", 137]]
  [1m[36mTransaktion Create (1.1ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 137], ["trans_set", "AAAA0001"], ["balance", 1000.0], ["trans_type", "deposit"], ["amount", 1000.0], ["created_at", "2019-04-25 12:42:29.407909"], ["updated_at", "2019-04-25 12:42:29.407909"]]
  [1m[36mAgency Load (0.7ms)[0m  [1m[34mSELECT  "agencies".* FROM "agencies" WHERE "agencies"."id" = $1 LIMIT $2[0m  [["id", 12], ["LIMIT", 1]]
  [1m[36mAccount Update (0.7ms)[0m  [1m[33mUPDATE "accounts" SET "balance" = $1, "updated_at" = $2 WHERE "accounts"."id" = $3[0m  [["balance", 99000], ["updated_at", "2019-04-25 12:42:29.413728"], ["id", 136]]
  [1m[36mTransaktion Create (0.8ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 136], ["trans_set", "AAAA0001"], ["balance", 99000.0], ["trans_type", "deposit"], ["amount", 1000.0], ["created_at", "2019-04-25 12:42:29.416003"], ["updated_at", "2019-04-25 12:42:29.416003"]]
  [1m[36mTransaktion Load (0.7ms)[0m  [1m[34mSELECT  "transaktions".* FROM "transaktions" WHERE "transaktions"."account_id" = $1 ORDER BY "transaktions"."id" DESC LIMIT $2[0m  [["account_id", 136], ["LIMIT", 1]]
  [1m[36mTransaktion Load (0.6ms)[0m  [1m[34mSELECT  "transaktions".* FROM "transaktions" WHERE "transaktions"."account_id" = $1 ORDER BY "transaktions"."id" DESC LIMIT $2[0m  [["account_id", 137], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mCACHE Transaktion Load (0.0ms)[0m  [1m[34mSELECT  "transaktions".* FROM "transaktions" WHERE "transaktions"."account_id" = $1 ORDER BY "transaktions"."id" DESC LIMIT $2[0m  [["account_id", 136], ["LIMIT", 1]]
Completed 200 OK in 58ms (Views: 0.6ms | ActiveRecord: 13.3ms)
  [1m[35m (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------
TransactionsControllerTest: test_send_money
-------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "userc@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234569"], ["LIMIT", 1]]
  [1m[36mUser Create (130907.7ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "userc@domain.com"], ["encrypted_password", "$2a$04$I4qnnGQXawPv0CQDjj0yKOsAiKuY4NERlP3R6w2BKLJ5xHeYzwePC"], ["phone_number", "0701234569"], ["full_name", "first user"], ["created_at", "2019-04-25 12:42:29.429849"], ["updated_at", "2019-04-25 12:42:29.429849"], ["jti", "84a88737-a6a2-429d-a9c9-3f0e4de04fd7"]]
  [1m[35m (1.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------
StatementControllerTest: test_send_Statement
--------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "usera@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234567"], ["LIMIT", 1]]
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "usera@domain.com"], ["encrypted_password", "$2a$04$Ha.T0wxO37nKVo5C4vseBemmO8mgb2wV5.EjpZwYTexISb/WSnLe6"], ["phone_number", "0701234567"], ["full_name", "first user"], ["created_at", "2019-04-25 12:44:41.518467"], ["updated_at", "2019-04-25 12:44:41.518467"], ["jti", "34ef3f72-7c95-4d9d-9543-db7e83648af4"]]
  [1m[36mAccount Create (1.0ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-25 12:44:41.537924"], ["updated_at", "2019-04-25 12:44:41.537924"], ["owner_id", 92], ["owner_type", "User"]]
  [1m[36mAccount Load (0.6ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 92], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "userb@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234568"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "userb@domain.com"], ["encrypted_password", "$2a$04$O.LSG80y7A1rC3xTFQM3N.YbgSVNZDx89vyqbOUnkb7PxwGd.X/MC"], ["phone_number", "0701234568"], ["full_name", "first user"], ["created_at", "2019-04-25 12:44:41.548473"], ["updated_at", "2019-04-25 12:44:41.548473"], ["jti", "decd5eaa-2bd4-433b-a5a7-bf89bff5b3b7"]]
  [1m[36mAccount Create (0.5ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-25 12:44:41.550479"], ["updated_at", "2019-04-25 12:44:41.550479"], ["owner_id", 93], ["owner_type", "User"]]
  [1m[36mAccount Load (0.5ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 93], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAccount Create (0.5ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-25 12:44:41.553811"], ["updated_at", "2019-04-25 12:44:41.553811"], ["owner_id", 93], ["owner_type", "User"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (1.4ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 140], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-25 12:44:41.570871"], ["updated_at", "2019-04-25 12:44:41.570871"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (0.8ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 140], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-25 12:44:41.574643"], ["updated_at", "2019-04-25 12:44:41.574643"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (0.8ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 140], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-25 12:44:41.577592"], ["updated_at", "2019-04-25 12:44:41.577592"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (0.7ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 140], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-25 12:44:41.580420"], ["updated_at", "2019-04-25 12:44:41.580420"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (0.6ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 140], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-25 12:44:41.583229"], ["updated_at", "2019-04-25 12:44:41.583229"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/accounts/140/statement?email=usera%40domain.com&start_date=2019-04-25+12%3A44%3A41+UTC&end_date=2019-04-25+12%3A44%3A41+%2B0000" for 127.0.0.1 at 2019-04-25 12:44:41 +0000
Processing by StatementController#get_statement as HTML
  Parameters: {"email"=>"usera@domain.com", "start_date"=>"2019-04-25 12:44:41 UTC", "end_date"=>"2019-04-25 12:44:41 +0000", "account_id"=>"140"}
Completed 401 Unauthorized in 6ms (ActiveRecord: 0.0ms)
  [1m[35m (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------
StatementControllerTest: test_send_Statement
--------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.0ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "usera@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234567"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "usera@domain.com"], ["encrypted_password", "$2a$04$HgdRaj0gtIaWTOkk1Uu2JeobnYYoO3Xm.kS1i6pjaW9PwJghdVFlG"], ["phone_number", "0701234567"], ["full_name", "first user"], ["created_at", "2019-04-25 12:45:17.593902"], ["updated_at", "2019-04-25 12:45:17.593902"], ["jti", "fd89ca47-bc9e-4324-9952-6f4ce6482001"]]
  [1m[36mAccount Create (0.8ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-25 12:45:17.612089"], ["updated_at", "2019-04-25 12:45:17.612089"], ["owner_id", 94], ["owner_type", "User"]]
  [1m[36mAccount Load (0.5ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 94], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "userb@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234568"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "userb@domain.com"], ["encrypted_password", "$2a$04$.hUv29FZjahMx15b7EjVJOc8K/yGZK6cyr1tXmWVqCBSA7BxcBW6e"], ["phone_number", "0701234568"], ["full_name", "first user"], ["created_at", "2019-04-25 12:45:17.621299"], ["updated_at", "2019-04-25 12:45:17.621299"], ["jti", "d79ff86a-8d63-4b4d-b81e-60c0ca7b1f53"]]
  [1m[36mAccount Create (0.5ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-25 12:45:17.623278"], ["updated_at", "2019-04-25 12:45:17.623278"], ["owner_id", 95], ["owner_type", "User"]]
  [1m[36mAccount Load (0.4ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 95], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAccount Create (0.8ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-25 12:45:17.626647"], ["updated_at", "2019-04-25 12:45:17.626647"], ["owner_id", 95], ["owner_type", "User"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (1.1ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 143], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-25 12:45:17.651383"], ["updated_at", "2019-04-25 12:45:17.651383"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (0.7ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 143], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-25 12:45:17.655850"], ["updated_at", "2019-04-25 12:45:17.655850"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (0.7ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 143], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-25 12:45:17.659525"], ["updated_at", "2019-04-25 12:45:17.659525"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (0.7ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 143], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-25 12:45:17.663230"], ["updated_at", "2019-04-25 12:45:17.663230"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (0.7ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 143], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-25 12:45:17.666974"], ["updated_at", "2019-04-25 12:45:17.666974"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/accounts/143/statement?email=usera%40domain.com&start_date=2019-04-25+12%3A45%3A17+UTC&end_date=2019-04-25+12%3A45%3A17+%2B0000" for 127.0.0.1 at 2019-04-25 12:45:17 +0000
Processing by StatementController#get_statement as HTML
  Parameters: {"email"=>"usera@domain.com", "start_date"=>"2019-04-25 12:45:17 UTC", "end_date"=>"2019-04-25 12:45:17 +0000", "account_id"=>"143"}
  [1m[36mAccount Load (0.3ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 LIMIT $2[0m  [["id", 143], ["LIMIT", 1]]
  Rendering statement_mailer/send_statement.html.erb within layouts/mailer
  Rendered statement_mailer/send_statement.html.erb within layouts/mailer (0.9ms)
  [1m[36mTransaktion Load (21.3ms)[0m  [1m[34mSELECT "transaktions".* FROM "transaktions" WHERE "transaktions"."created_at" BETWEEN $1 AND $2 AND "transaktions"."account_id" = $3[0m  [["created_at", "2019-04-25"], ["created_at", "2019-04-25"], ["account_id", 143]]
StatementMailer#send_statement: processed outbound mail in 1180.6ms
Sent mail to usera@domain.com (58.3ms)
Date: Thu, 25 Apr 2019 12:45:34 +0000
From: juandsmithj@gmail.com
To: usera@domain.com
Message-ID: <5cc1abee8f56f_292ac7331966b0568de@82989b450a8b.mail>
Subject: Statement
Mime-Version: 1.0
Content-Type: text/html;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <style>
      /* Email styles need to be inline */
    </style>
  </head>

  <body>
    
    <table border="1px" cellspacing="0">
      <thead>
        <th>Transaction</th>
        <th>Account</th>
        <th>Transaction type</th>
        <th>Amount</th>
        <th>Date</th>
      </thead>
      <tbody>
  </body>

</html>

Completed 204 No Content in 16915ms (ActiveRecord: 21.6ms)
  [1m[35m (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (1.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------
StatementControllerTest: test_send_Statement
--------------------------------------------
  [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "usera@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234567"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "usera@domain.com"], ["encrypted_password", "$2a$04$bPyOzuQr8vWADg1cNGvm4uX1WEnq7AKyWUCVBYGC8ntpncQta.aX."], ["phone_number", "0701234567"], ["full_name", "first user"], ["created_at", "2019-04-25 12:46:10.549557"], ["updated_at", "2019-04-25 12:46:10.549557"], ["jti", "f05670c4-0064-441d-8995-b56ce3065e2b"]]
  [1m[36mAccount Create (0.5ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-25 12:46:10.569225"], ["updated_at", "2019-04-25 12:46:10.569225"], ["owner_id", 96], ["owner_type", "User"]]
  [1m[36mAccount Load (0.4ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 96], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "userb@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234568"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "userb@domain.com"], ["encrypted_password", "$2a$04$G8OcAyiVMNfXnEhJFvGxOuegEuziG3fLga7pXwS5eBzUCNgugGpxC"], ["phone_number", "0701234568"], ["full_name", "first user"], ["created_at", "2019-04-25 12:46:10.578079"], ["updated_at", "2019-04-25 12:46:10.578079"], ["jti", "0aa086a1-ba10-49e1-ae33-6cfcd4ac179d"]]
  [1m[36mAccount Create (0.4ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-25 12:46:10.579959"], ["updated_at", "2019-04-25 12:46:10.579959"], ["owner_id", 97], ["owner_type", "User"]]
  [1m[36mAccount Load (0.3ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 97], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAccount Create (0.4ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-25 12:46:10.582607"], ["updated_at", "2019-04-25 12:46:10.582607"], ["owner_id", 97], ["owner_type", "User"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (1.2ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 146], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-25 12:46:10.598735"], ["updated_at", "2019-04-25 12:46:10.598735"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (0.7ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 146], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-25 12:46:10.602088"], ["updated_at", "2019-04-25 12:46:10.602088"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (0.7ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 146], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-25 12:46:10.604698"], ["updated_at", "2019-04-25 12:46:10.604698"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (0.7ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 146], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-25 12:46:10.607114"], ["updated_at", "2019-04-25 12:46:10.607114"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (0.7ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 146], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-25 12:46:10.609477"], ["updated_at", "2019-04-25 12:46:10.609477"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/accounts/146/statement?email=usera%40domain.com&start_date=2019-04-25+12%3A46%3A10+UTC&end_date=2019-04-25+12%3A46%3A10+%2B0000" for 127.0.0.1 at 2019-04-25 12:46:10 +0000
Processing by StatementController#get_statement as HTML
  Parameters: {"email"=>"usera@domain.com", "start_date"=>"2019-04-25 12:46:10 UTC", "end_date"=>"2019-04-25 12:46:10 +0000", "account_id"=>"146"}
  [1m[36mAccount Load (0.5ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 LIMIT $2[0m  [["id", 146], ["LIMIT", 1]]
  Rendering statement_mailer/send_statement.html.erb within layouts/mailer
  Rendered statement_mailer/send_statement.html.erb within layouts/mailer (0.6ms)
  [1m[36mTransaktion Load (1.0ms)[0m  [1m[34mSELECT "transaktions".* FROM "transaktions" WHERE "transaktions"."created_at" BETWEEN $1 AND $2 AND "transaktions"."account_id" = $3[0m  [["created_at", "2019-04-25"], ["created_at", "2019-04-25"], ["account_id", 146]]
StatementMailer#send_statement: processed outbound mail in 24.5ms
Sent mail to tomnyongesa5@gmail.com (2.5ms)
Date: Thu, 25 Apr 2019 12:46:12 +0000
From: juandsmithj@gmail.com
To: tomnyongesa5@gmail.com
Message-ID: <5cc1ac14a7e4c_302ad42957c6a0758ee@82989b450a8b.mail>
Subject: Statement
Mime-Version: 1.0
Content-Type: text/html;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <style>
      /* Email styles need to be inline */
    </style>
  </head>

  <body>
    
    <table border="1px" cellspacing="0">
      <thead>
        <th>Transaction</th>
        <th>Account</th>
        <th>Transaction type</th>
        <th>Amount</th>
        <th>Date</th>
      </thead>
      <tbody>
  </body>

</html>

Completed 204 No Content in 2068ms (ActiveRecord: 1.5ms)
  [1m[35m (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (1.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------
StatementControllerTest: test_send_Statement
--------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "usera@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234567"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "usera@domain.com"], ["encrypted_password", "$2a$04$ELk4K.aT9FHv6gBYJaTdF.e7FRSFkt4aaYC9EUkX5Lsi1PK.qN/ke"], ["phone_number", "0701234567"], ["full_name", "first user"], ["created_at", "2019-04-25 12:46:23.247066"], ["updated_at", "2019-04-25 12:46:23.247066"], ["jti", "12d1109a-ab5b-4af7-bc05-f5bfd8e1ed7e"]]
  [1m[36mAccount Create (0.8ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-25 12:46:23.264382"], ["updated_at", "2019-04-25 12:46:23.264382"], ["owner_id", 98], ["owner_type", "User"]]
  [1m[36mAccount Load (0.4ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 98], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "userb@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234568"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "userb@domain.com"], ["encrypted_password", "$2a$04$W8sSWAIqG5IEdWGEnqYAy.HNdVa145Bxljz/od/1vyldqctA/mYfu"], ["phone_number", "0701234568"], ["full_name", "first user"], ["created_at", "2019-04-25 12:46:23.273332"], ["updated_at", "2019-04-25 12:46:23.273332"], ["jti", "fd015764-a6ba-412e-8465-dde2d04381bb"]]
  [1m[36mAccount Create (0.4ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-25 12:46:23.275195"], ["updated_at", "2019-04-25 12:46:23.275195"], ["owner_id", 99], ["owner_type", "User"]]
  [1m[36mAccount Load (0.4ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 99], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAccount Create (0.5ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-25 12:46:23.278045"], ["updated_at", "2019-04-25 12:46:23.278045"], ["owner_id", 99], ["owner_type", "User"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (0.9ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 149], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-25 12:46:23.295823"], ["updated_at", "2019-04-25 12:46:23.295823"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (0.6ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 149], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-25 12:46:23.298660"], ["updated_at", "2019-04-25 12:46:23.298660"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (0.6ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 149], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-25 12:46:23.300997"], ["updated_at", "2019-04-25 12:46:23.300997"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (0.6ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 149], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-25 12:46:23.303186"], ["updated_at", "2019-04-25 12:46:23.303186"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (0.6ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 149], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-25 12:46:23.305390"], ["updated_at", "2019-04-25 12:46:23.305390"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/accounts/149/statement?email=usera%40domain.com&start_date=2019-04-25+12%3A46%3A23+UTC&end_date=2019-04-25+12%3A46%3A23+%2B0000" for 127.0.0.1 at 2019-04-25 12:46:23 +0000
Processing by StatementController#get_statement as HTML
  Parameters: {"email"=>"usera@domain.com", "start_date"=>"2019-04-25 12:46:23 UTC", "end_date"=>"2019-04-25 12:46:23 +0000", "account_id"=>"149"}
  [1m[36mAccount Load (0.4ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 LIMIT $2[0m  [["id", 149], ["LIMIT", 1]]
  Rendering statement_mailer/send_statement.html.erb within layouts/mailer
  Rendered statement_mailer/send_statement.html.erb within layouts/mailer (0.5ms)
StatementMailer#send_statement: processed outbound mail in 69.1ms
  Rendering statement_mailer/send_statement.html.erb within layouts/mailer
  Rendered statement_mailer/send_statement.html.erb within layouts/mailer (0.2ms)
  [1m[36mTransaktion Load (1.8ms)[0m  [1m[34mSELECT "transaktions".* FROM "transaktions" WHERE "transaktions"."created_at" BETWEEN $1 AND $2 AND "transaktions"."account_id" = $3[0m  [["created_at", "2019-04-25"], ["created_at", "2019-04-25"], ["account_id", 149]]
StatementMailer#send_statement: processed outbound mail in 29.1ms
Sent mail to usera@domain.com (4.4ms)
Date: Thu, 25 Apr 2019 12:46:51 +0000
From: juandsmithj@gmail.com
To: usera@domain.com
Message-ID: <5cc1ac3be4574_372add50f52690886c5@82989b450a8b.mail>
Subject: Statement
Mime-Version: 1.0
Content-Type: text/html;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <style>
      /* Email styles need to be inline */
    </style>
  </head>

  <body>
    
    <table border="1px" cellspacing="0">
      <thead>
        <th>Transaction</th>
        <th>Account</th>
        <th>Transaction type</th>
        <th>Amount</th>
        <th>Date</th>
      </thead>
      <tbody>
  </body>

</html>

Completed 204 No Content in 28620ms (ActiveRecord: 2.2ms)
  [1m[35m (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------
StatementControllerTest: test_send_Statement
--------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "usera@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234567"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "usera@domain.com"], ["encrypted_password", "$2a$04$XiCEHSf71Y3yY6NGBpNajeoe9DBcBCOu5sw2lMhfP6.56dSf0UtIW"], ["phone_number", "0701234567"], ["full_name", "first user"], ["created_at", "2019-04-25 12:47:25.553819"], ["updated_at", "2019-04-25 12:47:25.553819"], ["jti", "d5cc528f-b125-4ba6-8ad6-6eb52d328328"]]
  [1m[36mAccount Create (0.8ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-25 12:47:25.570789"], ["updated_at", "2019-04-25 12:47:25.570789"], ["owner_id", 100], ["owner_type", "User"]]
  [1m[36mAccount Load (0.6ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 100], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "userb@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234568"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "userb@domain.com"], ["encrypted_password", "$2a$04$V08iJZzf4mL.qHOt8eMHK..z9BtLtehFnMSB8Ecty8ilpHnTIrsp2"], ["phone_number", "0701234568"], ["full_name", "first user"], ["created_at", "2019-04-25 12:47:25.581201"], ["updated_at", "2019-04-25 12:47:25.581201"], ["jti", "d2950c56-7a71-466b-997d-be81cdb5c211"]]
  [1m[36mAccount Create (0.6ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-25 12:47:25.583357"], ["updated_at", "2019-04-25 12:47:25.583357"], ["owner_id", 101], ["owner_type", "User"]]
  [1m[36mAccount Load (0.5ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 101], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAccount Create (0.6ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-25 12:47:25.586824"], ["updated_at", "2019-04-25 12:47:25.586824"], ["owner_id", 101], ["owner_type", "User"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (1.1ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 152], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-25 12:47:25.606384"], ["updated_at", "2019-04-25 12:47:25.606384"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (0.7ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 152], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-25 12:47:25.609722"], ["updated_at", "2019-04-25 12:47:25.609722"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (0.7ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 152], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-25 12:47:25.612290"], ["updated_at", "2019-04-25 12:47:25.612290"]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (0.8ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 152], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-25 12:47:25.615210"], ["updated_at", "2019-04-25 12:47:25.615210"]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (0.8ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 152], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-25 12:47:25.618122"], ["updated_at", "2019-04-25 12:47:25.618122"]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/accounts/152/statement?email=usera%40domain.com&start_date=2019-04-25+12%3A47%3A25+UTC&end_date=2019-04-25+12%3A47%3A25+%2B0000" for 127.0.0.1 at 2019-04-25 12:47:25 +0000
Processing by StatementController#get_statement as HTML
  Parameters: {"email"=>"usera@domain.com", "start_date"=>"2019-04-25 12:47:25 UTC", "end_date"=>"2019-04-25 12:47:25 +0000", "account_id"=>"152"}
  [1m[36mAccount Load (0.5ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 LIMIT $2[0m  [["id", 152], ["LIMIT", 1]]
  Rendering statement_mailer/send_statement.html.erb within layouts/mailer
  Rendered statement_mailer/send_statement.html.erb within layouts/mailer (0.5ms)
  [1m[36mTransaktion Load (1.1ms)[0m  [1m[34mSELECT "transaktions".* FROM "transaktions" WHERE "transaktions"."created_at" BETWEEN $1 AND $2 AND "transaktions"."account_id" = $3[0m  [["created_at", "2019-04-25"], ["created_at", "2019-04-25"], ["account_id", 152]]
StatementMailer#send_statement: processed outbound mail in 33.9ms
Sent mail to usera@domain.com (2.6ms)
Date: Thu, 25 Apr 2019 12:47:25 +0000
From: juandsmithj@gmail.com
To: usera@domain.com
Message-ID: <5cc1ac5da506c_3e2b20b04726a082362@82989b450a8b.mail>
Subject: Statement
Mime-Version: 1.0
Content-Type: text/html;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <style>
      /* Email styles need to be inline */
    </style>
  </head>

  <body>
    
    <table border="1px" cellspacing="0">
      <thead>
        <th>Transaction</th>
        <th>Account</th>
        <th>Transaction type</th>
        <th>Amount</th>
        <th>Date</th>
      </thead>
      <tbody>
  </body>

</html>

Completed 204 No Content in 47ms (ActiveRecord: 1.6ms)
  [1m[35m (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (1.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------
StatementControllerTest: test_send_Statement
--------------------------------------------
  [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "usera@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234567"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "usera@domain.com"], ["encrypted_password", "$2a$04$NQLZFJ3eTqPZQJIEN544KuqVFyT5RcKRgXwYTjgNsqleVF8HzdDlS"], ["phone_number", "0701234567"], ["full_name", "first user"], ["created_at", "2019-04-25 13:06:29.238689"], ["updated_at", "2019-04-25 13:06:29.238689"], ["jti", "d11779cd-6c25-48f6-94d8-1d3a55324594"]]
  [1m[36mAccount Create (0.7ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-25 13:06:29.270293"], ["updated_at", "2019-04-25 13:06:29.270293"], ["owner_id", 102], ["owner_type", "User"]]
  [1m[36mAccount Load (0.3ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 102], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "userb@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234568"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "userb@domain.com"], ["encrypted_password", "$2a$04$ZvB72BIdQfvoZmp62.vph.7aujIh9.D/JzjvWUf980dj.CtDIGkue"], ["phone_number", "0701234568"], ["full_name", "first user"], ["created_at", "2019-04-25 13:06:29.279730"], ["updated_at", "2019-04-25 13:06:29.279730"], ["jti", "051a9be7-042d-4492-9f92-3ed8044cb93f"]]
  [1m[36mAccount Create (0.7ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-25 13:06:29.281997"], ["updated_at", "2019-04-25 13:06:29.281997"], ["owner_id", 103], ["owner_type", "User"]]
  [1m[36mAccount Load (0.7ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 103], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAccount Create (0.8ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-25 13:06:29.286972"], ["updated_at", "2019-04-25 13:06:29.286972"], ["owner_id", 103], ["owner_type", "User"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (1.4ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 155], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-25 13:06:29.321250"], ["updated_at", "2019-04-25 13:06:29.321250"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (0.6ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 155], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-25 13:06:29.324683"], ["updated_at", "2019-04-25 13:06:29.324683"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (0.6ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 155], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-25 13:06:29.326985"], ["updated_at", "2019-04-25 13:06:29.326985"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (0.6ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 155], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-25 13:06:29.329292"], ["updated_at", "2019-04-25 13:06:29.329292"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (1.0ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 155], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-25 13:06:29.331866"], ["updated_at", "2019-04-25 13:06:29.331866"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/accounts/155/statement?email=usera%40domain.com&start_date=2019-04-25+13%3A06%3A29+UTC&end_date=2019-04-25+13%3A06%3A29+%2B0000" for 127.0.0.1 at 2019-04-25 13:06:29 +0000
Processing by StatementController#get_statement as HTML
  Parameters: {"email"=>"usera@domain.com", "start_date"=>"2019-04-25 13:06:29 UTC", "end_date"=>"2019-04-25 13:06:29 +0000", "account_id"=>"155"}
  [1m[36mAccount Load (0.3ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 LIMIT $2[0m  [["id", 155], ["LIMIT", 1]]
  Rendering statement_mailer/send_statement.html.erb within layouts/mailer
  Rendered statement_mailer/send_statement.html.erb within layouts/mailer (1.1ms)
  [1m[36mTransaktion Load (1.1ms)[0m  [1m[34mSELECT "transaktions".* FROM "transaktions" WHERE "transaktions"."created_at" BETWEEN $1 AND $2 AND "transaktions"."account_id" = $3[0m  [["created_at", "2019-04-25"], ["created_at", "2019-04-25"], ["account_id", 155]]
StatementMailer#send_statement: processed outbound mail in 137.5ms
Sent mail to usera@domain.com (3.9ms)
Date: Thu, 25 Apr 2019 13:06:29 +0000
From: juandsmithj@gmail.com
To: usera@domain.com
Message-ID: <5cc1b0d582943_452afedd23e680568cd@82989b450a8b.mail>
Subject: Statement
Mime-Version: 1.0
Content-Type: text/html;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <style>
      /* Email styles need to be inline */
    </style>
  </head>

  <body>
    
    <table border="1px" cellspacing="0">
      <thead>
        <th>Transaction</th>
        <th>Account</th>
        <th>Transaction type</th>
        <th>Amount</th>
        <th>Date</th>
      </thead>
      <tbody>
  </body>

</html>

Completed 204 No Content in 166ms (ActiveRecord: 1.4ms)
  [1m[35m (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
-----------------------------------
StatementMailerTest: test_mail_sent
-----------------------------------
  [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (30.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "usera@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (1.0ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234567"], ["LIMIT", 1]]
  [1m[36mUser Create (1.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "usera@domain.com"], ["encrypted_password", "$2a$04$SHMybbc.qPpBMHuzmUEuQOMSReTiLbY30XH2h1G8hMSWTlXq.y3vC"], ["phone_number", "0701234567"], ["full_name", "first user"], ["created_at", "2019-04-25 13:39:12.414004"], ["updated_at", "2019-04-25 13:39:12.414004"], ["jti", "0291093d-a14d-4c06-8dbf-e1c00179874b"]]
  [1m[36mAccount Create (0.8ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-25 13:39:12.468205"], ["updated_at", "2019-04-25 13:39:12.468205"], ["owner_id", 104], ["owner_type", "User"]]
  [1m[36mAccount Load (0.6ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 104], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  Rendering statement_mailer/send_statement.html.erb within layouts/mailer
  Rendered statement_mailer/send_statement.html.erb within layouts/mailer (1.4ms)
  [1m[36mTransaktion Load (1.4ms)[0m  [1m[34mSELECT "transaktions".* FROM "transaktions"[0m
StatementMailer#send_statement: processed outbound mail in 97.9ms
Sent mail to usera@domain.com (12.6ms)
Date: Thu, 25 Apr 2019 13:39:12 +0000
From: juandsmithj@gmail.com
To: usera@domain.com
Message-ID: <5cc1b88098705_4c2ab0b46b06903988f@82989b450a8b.mail>
Subject: Statement
Mime-Version: 1.0
Content-Type: text/html;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <style>
      /* Email styles need to be inline */
    </style>
  </head>

  <body>
    
    <table border="1px" cellspacing="0">
      <thead>
        <th>Transaction</th>
        <th>Account</th>
        <th>Transaction type</th>
        <th>Amount</th>
        <th>Date</th>
      </thead>
      <tbody>
  </body>

</html>

  [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
-----------------------------------
StatementMailerTest: test_mail_sent
-----------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "usera@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234567"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "usera@domain.com"], ["encrypted_password", "$2a$04$N0AB46bZRfd76vQFLCGgAOhG0OlWIsxCGBQtNrBJ3ZNXiR2opxve2"], ["phone_number", "0701234567"], ["full_name", "first user"], ["created_at", "2019-04-25 13:40:16.685631"], ["updated_at", "2019-04-25 13:40:16.685631"], ["jti", "d05c9433-a14c-4ece-8d03-fbe0161d05fa"]]
  [1m[36mAccount Create (0.9ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-25 13:40:16.704866"], ["updated_at", "2019-04-25 13:40:16.704866"], ["owner_id", 105], ["owner_type", "User"]]
  [1m[36mAccount Load (0.6ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 105], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  Rendering statement_mailer/send_statement.html.erb within layouts/mailer
  Rendered statement_mailer/send_statement.html.erb within layouts/mailer (0.5ms)
  [1m[36mTransaktion Load (1.1ms)[0m  [1m[34mSELECT "transaktions".* FROM "transaktions"[0m
StatementMailer#send_statement: processed outbound mail in 11.1ms
Sent mail to usera@domain.com (2.7ms)
Date: Thu, 25 Apr 2019 13:40:16 +0000
From: juandsmithj@gmail.com
To: usera@domain.com
Message-ID: <5cc1b8c0b41d7_532abc9c5ca6b042356@82989b450a8b.mail>
Subject: Statement
Mime-Version: 1.0
Content-Type: text/html;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <style>
      /* Email styles need to be inline */
    </style>
  </head>

  <body>
    
    <table border="1px" cellspacing="0">
      <thead>
        <th>Transaction</th>
        <th>Account</th>
        <th>Transaction type</th>
        <th>Amount</th>
        <th>Date</th>
      </thead>
      <tbody>
  </body>

</html>

  [1m[35m (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
-----------------------------------
StatementMailerTest: test_mail_sent
-----------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "usera@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234567"], ["LIMIT", 1]]
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "usera@domain.com"], ["encrypted_password", "$2a$04$1zmT96g39jZiruPVNOP.2etUU3wcEphQ3670yVAVr3epiK.IZ72RW"], ["phone_number", "0701234567"], ["full_name", "first user"], ["created_at", "2019-04-25 13:40:31.987373"], ["updated_at", "2019-04-25 13:40:31.987373"], ["jti", "21df7150-f413-4585-a694-fba4c04239ee"]]
  [1m[36mAccount Create (0.7ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-25 13:40:32.007526"], ["updated_at", "2019-04-25 13:40:32.007526"], ["owner_id", 106], ["owner_type", "User"]]
  [1m[36mAccount Load (0.4ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 106], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  Rendering statement_mailer/send_statement.html.erb within layouts/mailer
  Rendered statement_mailer/send_statement.html.erb within layouts/mailer (0.8ms)
  [1m[36mTransaktion Load (0.8ms)[0m  [1m[34mSELECT "transaktions".* FROM "transaktions"[0m
StatementMailer#send_statement: processed outbound mail in 11.9ms
Sent mail to usera@domain.com (11.7ms)
Date: Thu, 25 Apr 2019 13:40:32 +0000
From: statements@greenmamba.com
To: usera@domain.com
Message-ID: <5cc1b8d089dc_5a2b04108086a0778e9@82989b450a8b.mail>
Subject: Statement
Mime-Version: 1.0
Content-Type: text/html;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <style>
      /* Email styles need to be inline */
    </style>
  </head>

  <body>
    
    <table border="1px" cellspacing="0">
      <thead>
        <th>Transaction</th>
        <th>Account</th>
        <th>Transaction type</th>
        <th>Amount</th>
        <th>Date</th>
      </thead>
      <tbody>
  </body>

</html>

  [1m[35m (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (1.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
-----------------------------------
StatementMailerTest: test_mail_sent
-----------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.0ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "usera@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234567"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "usera@domain.com"], ["encrypted_password", "$2a$04$swHrvvdHq/XkF5AuucGX.uCRO1U2cndXNF8XIwC6aMhENYSgcP6wi"], ["phone_number", "0701234567"], ["full_name", "first user"], ["created_at", "2019-04-25 13:40:35.856016"], ["updated_at", "2019-04-25 13:40:35.856016"], ["jti", "f1e4456b-bb61-4b10-8233-cb419a0f1b84"]]
  [1m[36mAccount Create (0.8ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-25 13:40:35.875034"], ["updated_at", "2019-04-25 13:40:35.875034"], ["owner_id", 107], ["owner_type", "User"]]
  [1m[36mAccount Load (0.5ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 107], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  Rendering statement_mailer/send_statement.html.erb within layouts/mailer
  Rendered statement_mailer/send_statement.html.erb within layouts/mailer (0.5ms)
  [1m[36mTransaktion Load (0.9ms)[0m  [1m[34mSELECT "transaktions".* FROM "transaktions"[0m
StatementMailer#send_statement: processed outbound mail in 10.1ms
Sent mail to usera@domain.com (2.4ms)
Date: Thu, 25 Apr 2019 13:40:35 +0000
From: statements@greenmamba.com
To: usera@domain.com
Message-ID: <5cc1b8d3dd2f5_612add7ec8e6b084620@82989b450a8b.mail>
Subject: Statement
Mime-Version: 1.0
Content-Type: text/html;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <style>
      /* Email styles need to be inline */
    </style>
  </head>

  <body>
    
    <table border="1px" cellspacing="0">
      <thead>
        <th>Transaction</th>
        <th>Account</th>
        <th>Transaction type</th>
        <th>Amount</th>
        <th>Date</th>
      </thead>
      <tbody>
  </body>

</html>

  [1m[35m (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------
StatementControllerTest: test_send_Statement
--------------------------------------------
  [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "usera@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234567"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "usera@domain.com"], ["encrypted_password", "$2a$04$AjpoAb2eCyltno8IBJFsUOGOV3oCKsXfb7knGc02Sth0soP/8zS5u"], ["phone_number", "0701234567"], ["full_name", "first user"], ["created_at", "2019-04-25 13:41:09.664581"], ["updated_at", "2019-04-25 13:41:09.664581"], ["jti", "360b0215-57c1-4c90-a887-cfd0bdd598f2"]]
  [1m[36mAccount Create (0.9ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-25 13:41:09.681724"], ["updated_at", "2019-04-25 13:41:09.681724"], ["owner_id", 108], ["owner_type", "User"]]
  [1m[36mAccount Load (0.5ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 108], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "userb@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234568"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "userb@domain.com"], ["encrypted_password", "$2a$04$GXh.ahRVmOZ9C57zloTQeebDSXjelWaU2Wg69oxZu.yJ50eI9rLCe"], ["phone_number", "0701234568"], ["full_name", "first user"], ["created_at", "2019-04-25 13:41:09.691937"], ["updated_at", "2019-04-25 13:41:09.691937"], ["jti", "1aa67c89-ab61-4d30-a03a-099b1092a933"]]
  [1m[36mAccount Create (0.5ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-25 13:41:09.693993"], ["updated_at", "2019-04-25 13:41:09.693993"], ["owner_id", 109], ["owner_type", "User"]]
  [1m[36mAccount Load (0.5ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 109], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mAccount Create (0.5ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-25 13:41:09.697334"], ["updated_at", "2019-04-25 13:41:09.697334"], ["owner_id", 109], ["owner_type", "User"]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (1.0ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 162], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-25 13:41:09.715226"], ["updated_at", "2019-04-25 13:41:09.715226"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (0.7ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 162], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-25 13:41:09.718578"], ["updated_at", "2019-04-25 13:41:09.718578"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (0.8ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 162], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-25 13:41:09.721269"], ["updated_at", "2019-04-25 13:41:09.721269"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (0.7ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 162], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-25 13:41:09.724052"], ["updated_at", "2019-04-25 13:41:09.724052"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTransaktion Create (0.7ms)[0m  [1m[32mINSERT INTO "transaktions" ("account_id", "trans_set", "balance", "trans_type", "amount", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["account_id", 162], ["trans_set", "MyString"], ["balance", 1.5], ["trans_type", "MyString"], ["amount", 1.5], ["created_at", "2019-04-25 13:41:09.726730"], ["updated_at", "2019-04-25 13:41:09.726730"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/accounts/162/statement?email=usera%40domain.com&start_date=2019-04-25+13%3A41%3A09+UTC&end_date=2019-04-25+13%3A41%3A09+%2B0000" for 127.0.0.1 at 2019-04-25 13:41:09 +0000
Processing by StatementController#get_statement as HTML
  Parameters: {"email"=>"usera@domain.com", "start_date"=>"2019-04-25 13:41:09 UTC", "end_date"=>"2019-04-25 13:41:09 +0000", "account_id"=>"162"}
  [1m[36mAccount Load (0.5ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."id" = $1 LIMIT $2[0m  [["id", 162], ["LIMIT", 1]]
  Rendering statement_mailer/send_statement.html.erb within layouts/mailer
  Rendered statement_mailer/send_statement.html.erb within layouts/mailer (0.5ms)
  [1m[36mTransaktion Load (1.2ms)[0m  [1m[34mSELECT "transaktions".* FROM "transaktions" WHERE "transaktions"."created_at" BETWEEN $1 AND $2 AND "transaktions"."account_id" = $3[0m  [["created_at", "2019-04-25"], ["created_at", "2019-04-25"], ["account_id", 162]]
StatementMailer#send_statement: processed outbound mail in 34.7ms
Sent mail to usera@domain.com (2.4ms)
Date: Thu, 25 Apr 2019 13:41:09 +0000
From: statements@greenmamba.com
To: usera@domain.com
Message-ID: <5cc1b8f5cb055_682b0acbbc869820441@82989b450a8b.mail>
Subject: Statement
Mime-Version: 1.0
Content-Type: text/html;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <style>
      /* Email styles need to be inline */
    </style>
  </head>

  <body>
    
    <table border="1px" cellspacing="0">
      <thead>
        <th>Transaction</th>
        <th>Account</th>
        <th>Transaction type</th>
        <th>Amount</th>
        <th>Date</th>
      </thead>
      <tbody>
  </body>

</html>

Completed 204 No Content in 58ms (ActiveRecord: 1.7ms)
  [1m[35m (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (4463049.6ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (4609892.4ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (27.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
-----------------------------------
StatementMailerTest: test_mail_sent
-----------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (64.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "usera@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (1.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234567"], ["LIMIT", 1]]
  [1m[36mUser Create (25.9ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "usera@domain.com"], ["encrypted_password", "$2a$04$ITaCJ.9xN2KTjasBJ5djCOYrp9ZYZIwTl9/7KslYFWoPx0e2iglSe"], ["phone_number", "0701234567"], ["full_name", "first user"], ["created_at", "2019-04-26 13:05:59.922930"], ["updated_at", "2019-04-26 13:05:59.922930"], ["jti", "0f3aec90-cc60-4959-a82a-6708d47e25e9"]]
  [1m[36mAccount Create (57.2ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-26 13:06:00.053464"], ["updated_at", "2019-04-26 13:06:00.053464"], ["owner_id", 110], ["owner_type", "User"]]
  [1m[36mAccount Load (0.5ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 110], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  Rendering statement_mailer/send_statement.html.erb within layouts/mailer
  Rendered statement_mailer/send_statement.html.erb within layouts/mailer (31.5ms)
  [1m[36mTransaktion Load (37.4ms)[0m  [1m[34mSELECT "transaktions".* FROM "transaktions"[0m
StatementMailer#send_statement: processed outbound mail in 207.8ms
Sent mail to usera@domain.com (81.1ms)
Date: Fri, 26 Apr 2019 13:06:00 +0000
From: statements@greenmamba.com
To: usera@domain.com
Message-ID: <5cc30238634f1_132b06145186b01424@6e2644a40dca.mail>
Subject: Statement
Mime-Version: 1.0
Content-Type: text/html;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <style>
      /* Email styles need to be inline */
    </style>
  </head>

  <body>
    
    <table border="1px" cellspacing="0">
      <thead>
        <th>Transaction</th>
        <th>Account</th>
        <th>Transaction type</th>
        <th>Amount</th>
        <th>Date</th>
      </thead>
      <tbody>
  </body>

</html>

  [1m[35m (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------
UsersControllerTest: test_show_account_information
--------------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "usera@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234567"], ["LIMIT", 1]]
  [1m[36mUser Create (15.1ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "usera@domain.com"], ["encrypted_password", "$2a$04$mmOAVOOovNwcZInFFSAiL.YKBExAlptcHjKXXzivUD2OO256tbRvu"], ["phone_number", "0701234567"], ["full_name", "first user"], ["created_at", "2019-04-26 13:11:18.639661"], ["updated_at", "2019-04-26 13:11:18.639661"], ["jti", "e442f6a7-c41c-4149-b139-e9464e6ab7b3"]]
  [1m[36mAccount Create (0.7ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-26 13:11:18.675911"], ["updated_at", "2019-04-26 13:11:18.675911"], ["owner_id", 111], ["owner_type", "User"]]
  [1m[36mAccount Load (0.5ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 111], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
------------------------------------------
UsersControllerTest: test_Can_signup_users
------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "userb@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234568"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "userb@domain.com"], ["encrypted_password", "$2a$04$jU8quXCidZpBBI5svMdNqeK6qkzmLiyBliBHaoySflfTOHvgaDrJ2"], ["phone_number", "0701234568"], ["full_name", "first user"], ["created_at", "2019-04-26 13:11:18.698268"], ["updated_at", "2019-04-26 13:11:18.698268"], ["jti", "40d56be9-6ccc-44ab-97c1-e135fd27f368"]]
  [1m[36mAccount Create (0.4ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-26 13:11:18.700195"], ["updated_at", "2019-04-26 13:11:18.700195"], ["owner_id", 112], ["owner_type", "User"]]
  [1m[36mAccount Load (0.4ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 112], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/users" for 127.0.0.1 at 2019-04-26 13:11:18 +0000
Processing by UsersController#create as JSON
  Parameters: {"data"=>{"type"=>"users", "attributes"=>{"full_name"=>"some user", "phone_number"=>"0701234567", "email"=>"user100@domain.com", "password"=>"[FILTERED]"}}}
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.7ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user100@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234567"], ["LIMIT", 1]]
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "user100@domain.com"], ["encrypted_password", "$2a$04$l57IeGkGiVZDz1LxUGnlGOASMsxJydvWcNUlVfVUQrnv5A.KF8Ziu"], ["phone_number", "0701234567"], ["full_name", "some user"], ["created_at", "2019-04-26 13:11:18.934057"], ["updated_at", "2019-04-26 13:11:18.934057"], ["jti", "9056b34a-0846-4f50-b4a6-7792894b3482"]]
  [1m[36mAccount Create (0.5ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-26 13:11:18.937306"], ["updated_at", "2019-04-26 13:11:18.937306"], ["owner_id", 113], ["owner_type", "User"]]
  [1m[36mAccount Load (0.4ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 113], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 25ms (Views: 0.3ms | ActiveRecord: 3.4ms)
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
------------------------------------------
UsersControllerTest: test_Can_signup_users
------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "usera@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234567"], ["LIMIT", 1]]
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "usera@domain.com"], ["encrypted_password", "$2a$04$FTGLWS.P7KxxTrsa.DOAvOsL1DptohF/AWkW2BaLFE1/NnXxdbOZy"], ["phone_number", "0701234567"], ["full_name", "first user"], ["created_at", "2019-04-26 13:11:44.501878"], ["updated_at", "2019-04-26 13:11:44.501878"], ["jti", "c04e61f4-bec4-4c44-a7e8-2aa09c4439e8"]]
  [1m[36mAccount Create (0.8ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-26 13:11:44.519701"], ["updated_at", "2019-04-26 13:11:44.519701"], ["owner_id", 114], ["owner_type", "User"]]
  [1m[36mAccount Load (0.4ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 114], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/users" for 127.0.0.1 at 2019-04-26 13:11:44 +0000
Processing by UsersController#create as JSON
  Parameters: {"data"=>{"type"=>"users", "attributes"=>{"full_name"=>"some user", "phone_number"=>"0701234567", "email"=>"user100@domain.com", "password"=>"[FILTERED]"}}}
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user100@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234567"], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 88268ms (ActiveRecord: 1.7ms)
  [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------
UsersControllerTest: test_show_account_information
--------------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "userb@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234568"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "userb@domain.com"], ["encrypted_password", "$2a$04$iwEUys7QaYFw3jMsXDIhh.HexzF7zqTQQ7SacEoqGnT0moNWnvkDW"], ["phone_number", "0701234568"], ["full_name", "first user"], ["created_at", "2019-04-26 13:13:12.815868"], ["updated_at", "2019-04-26 13:13:12.815868"], ["jti", "44cc7a99-d357-4560-84e7-f1c410c85b5a"]]
  [1m[36mAccount Create (0.3ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-26 13:13:12.818104"], ["updated_at", "2019-04-26 13:13:12.818104"], ["owner_id", 115], ["owner_type", "User"]]
  [1m[36mAccount Load (0.3ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 115], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------
UsersControllerTest: test_show_account_information
--------------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "usera@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234567"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "usera@domain.com"], ["encrypted_password", "$2a$04$upl4QQguNWN4NShyhUYyBeQj.iSnNlNcO22o50XCmex8NTVixkl1."], ["phone_number", "0701234567"], ["full_name", "first user"], ["created_at", "2019-04-26 13:13:45.936130"], ["updated_at", "2019-04-26 13:13:45.936130"], ["jti", "a84ccacb-52fc-4fb9-aaa9-034ece7e2d9c"]]
  [1m[36mAccount Create (0.9ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-26 13:13:45.957594"], ["updated_at", "2019-04-26 13:13:45.957594"], ["owner_id", 116], ["owner_type", "User"]]
  [1m[36mAccount Load (0.6ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 116], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
------------------------------------------
UsersControllerTest: test_Can_signup_users
------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "userb@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234568"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "userb@domain.com"], ["encrypted_password", "$2a$04$ekG8NLGbcMUTJmAWvLzl9ePNFUYOmWXtyfbzxLlONOpai8qRIScoi"], ["phone_number", "0701234568"], ["full_name", "first user"], ["created_at", "2019-04-26 13:14:03.162794"], ["updated_at", "2019-04-26 13:14:03.162794"], ["jti", "23e9ae59-f0d8-49eb-bab7-0b1ef07b5edd"]]
  [1m[36mAccount Create (0.8ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-26 13:14:03.165148"], ["updated_at", "2019-04-26 13:14:03.165148"], ["owner_id", 117], ["owner_type", "User"]]
  [1m[36mAccount Load (0.4ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 117], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/users" for 127.0.0.1 at 2019-04-26 13:14:03 +0000
Processing by UsersController#create as JSON
  Parameters: {"data"=>{"type"=>"users", "attributes"=>{"full_name"=>"some user", "phone_number"=>"0701234567", "email"=>"user100@domain.com", "password"=>"[FILTERED]"}}}
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user100@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234567"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "user100@domain.com"], ["encrypted_password", "$2a$04$dSHr.qvpyqboofa73tS0S.Ywm0nGvE7eNvEvRmj0eXJ/ZU.lz3LKy"], ["phone_number", "0701234567"], ["full_name", "some user"], ["created_at", "2019-04-26 13:14:03.188067"], ["updated_at", "2019-04-26 13:14:03.188067"], ["jti", "7dffa4d3-b004-4d09-b03a-dd211674c83c"]]
  [1m[36mAccount Create (0.5ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-26 13:14:03.190181"], ["updated_at", "2019-04-26 13:14:03.190181"], ["owner_id", 118], ["owner_type", "User"]]
  [1m[36mAccount Load (0.4ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 118], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 11ms (Views: 0.3ms | ActiveRecord: 2.9ms)
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
------------------------------------------
UsersControllerTest: test_Can_signup_users
------------------------------------------
  [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "usera@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234567"], ["LIMIT", 1]]
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "usera@domain.com"], ["encrypted_password", "$2a$04$/kraW6tEjolbdqxDw5jdF.bhGUW04XTyfM0o2g74WsVVFZhekcF7m"], ["phone_number", "0701234567"], ["full_name", "first user"], ["created_at", "2019-04-26 13:14:04.315193"], ["updated_at", "2019-04-26 13:14:04.315193"], ["jti", "b0d45c6d-895f-4dd4-b337-d66345dbc586"]]
  [1m[36mAccount Create (0.8ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-26 13:14:04.334730"], ["updated_at", "2019-04-26 13:14:04.334730"], ["owner_id", 119], ["owner_type", "User"]]
  [1m[36mAccount Load (0.5ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 119], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/users" for 127.0.0.1 at 2019-04-26 13:14:04 +0000
Processing by UsersController#create as JSON
  Parameters: {"data"=>{"type"=>"users", "attributes"=>{"full_name"=>"some user", "phone_number"=>"0701234567", "email"=>"user100@domain.com", "password"=>"[FILTERED]"}}}
  [1m[35m (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user100@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234567"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 6025ms (ActiveRecord: 1.9ms)
  [1m[35m (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------
UsersControllerTest: test_show_account_information
--------------------------------------------------
  [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "userb@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234568"], ["LIMIT", 1]]
  [1m[36mUser Create (0.9ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "userb@domain.com"], ["encrypted_password", "$2a$04$VUnGOcFB56aSOHswg1nsZuoojODRJKs61Bg4DhkDZGssg96TMW.w2"], ["phone_number", "0701234568"], ["full_name", "first user"], ["created_at", "2019-04-26 13:14:10.391319"], ["updated_at", "2019-04-26 13:14:10.391319"], ["jti", "16fb9e87-f53e-4545-a0da-6f9066705e56"]]
  [1m[36mAccount Create (0.6ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-26 13:14:10.394286"], ["updated_at", "2019-04-26 13:14:10.394286"], ["owner_id", 120], ["owner_type", "User"]]
  [1m[36mAccount Load (0.5ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 120], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
------------------------------------------
UsersControllerTest: test_Can_signup_users
------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.1ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "usera@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234567"], ["LIMIT", 1]]
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "usera@domain.com"], ["encrypted_password", "$2a$04$rLyQ7dOsvXAFInKak.lD/uoa1uuwOoMDrAlBCwJySpeyEMSe7J3u."], ["phone_number", "0701234567"], ["full_name", "first user"], ["created_at", "2019-04-26 13:14:18.049108"], ["updated_at", "2019-04-26 13:14:18.049108"], ["jti", "586120a6-6625-438c-8d4e-b51f92ec71d8"]]
  [1m[36mAccount Create (0.7ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-26 13:14:18.068843"], ["updated_at", "2019-04-26 13:14:18.068843"], ["owner_id", 121], ["owner_type", "User"]]
  [1m[36mAccount Load (0.4ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 121], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/users" for 127.0.0.1 at 2019-04-26 13:14:18 +0000
Processing by UsersController#create as JSON
  Parameters: {"data"=>{"type"=>"users", "attributes"=>{"full_name"=>"some user", "phone_number"=>"0701234567", "email"=>"user100@domain.com", "password"=>"[FILTERED]"}}}
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user100@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234567"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 14286ms (ActiveRecord: 1.3ms)
  [1m[35m (1.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------
UsersControllerTest: test_show_account_information
--------------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "userb@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234568"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "userb@domain.com"], ["encrypted_password", "$2a$04$oIL8qOSrYYaYvFqO5RZBlurO1MkDpxa2mHdNPi4/5pPm2jmuxNJrO"], ["phone_number", "0701234568"], ["full_name", "first user"], ["created_at", "2019-04-26 13:14:32.383203"], ["updated_at", "2019-04-26 13:14:32.383203"], ["jti", "5630df11-dd96-49ce-b1d8-2fe129596f9a"]]
  [1m[36mAccount Create (0.5ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-26 13:14:32.385427"], ["updated_at", "2019-04-26 13:14:32.385427"], ["owner_id", 122], ["owner_type", "User"]]
  [1m[36mAccount Load (0.4ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 122], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
------------------------------------------
UsersControllerTest: test_Can_signup_users
------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.0ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "usera@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234567"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "usera@domain.com"], ["encrypted_password", "$2a$04$xHNxpzArgl/zHxGWF9gmPeCOzu8bjiIFr1.Iobdf2W7aSPmKzx9MW"], ["phone_number", "0701234567"], ["full_name", "first user"], ["created_at", "2019-04-26 13:14:33.481969"], ["updated_at", "2019-04-26 13:14:33.481969"], ["jti", "6f96ed91-d185-4b05-b1a8-0f492323032c"]]
  [1m[36mAccount Create (0.7ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-26 13:14:33.499455"], ["updated_at", "2019-04-26 13:14:33.499455"], ["owner_id", 123], ["owner_type", "User"]]
  [1m[36mAccount Load (0.5ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 123], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/users" for 127.0.0.1 at 2019-04-26 13:14:33 +0000
Processing by UsersController#create as JSON
  Parameters: {"data"=>{"type"=>"users", "attributes"=>{"full_name"=>"some user", "phone_number"=>"0701234567", "email"=>"user100@domain.com", "password"=>"[FILTERED]"}}}
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user100@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234567"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 8ms (ActiveRecord: 1.3ms)
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------
UsersControllerTest: test_show_account_information
--------------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "userb@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234568"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "userb@domain.com"], ["encrypted_password", "$2a$04$94ZM.7QKsGflc.6ApGsI4uzJRaeQn3ITvP6iFb/pqZupmGFYOCfhy"], ["phone_number", "0701234568"], ["full_name", "first user"], ["created_at", "2019-04-26 13:14:33.535984"], ["updated_at", "2019-04-26 13:14:33.535984"], ["jti", "8abd09b4-f2ab-494e-8e43-eb2a38d4ab9f"]]
  [1m[36mAccount Create (0.5ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-26 13:14:33.538034"], ["updated_at", "2019-04-26 13:14:33.538034"], ["owner_id", 124], ["owner_type", "User"]]
  [1m[36mAccount Load (0.4ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 124], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
------------------------------------------
UsersControllerTest: test_Can_signup_users
------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.8ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "usera@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234567"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "usera@domain.com"], ["encrypted_password", "$2a$04$WmbfHlssMD/rJ.gY1NWteubSE9pQocwTIvotpB2WwOBSBXeLmFUFa"], ["phone_number", "0701234567"], ["full_name", "first user"], ["created_at", "2019-04-26 13:14:57.783337"], ["updated_at", "2019-04-26 13:14:57.783337"], ["jti", "6e951880-d10e-469c-ba5c-0cc48ed6bd31"]]
  [1m[36mAccount Create (0.7ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-26 13:14:57.800801"], ["updated_at", "2019-04-26 13:14:57.800801"], ["owner_id", 125], ["owner_type", "User"]]
  [1m[36mAccount Load (0.4ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 125], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/users" for 127.0.0.1 at 2019-04-26 13:14:57 +0000
Processing by UsersController#create as JSON
  Parameters: {"data"=>{"type"=>"users", "attributes"=>{"full_name"=>"some user", "phone_number"=>"0701234567", "email"=>"user100@domain.com", "password"=>"[FILTERED]"}}}
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user100@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234567"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 8ms (ActiveRecord: 1.4ms)
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------
UsersControllerTest: test_show_account_information
--------------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "userb@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234568"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "userb@domain.com"], ["encrypted_password", "$2a$04$sqc9OPtQtzq53WGhBItIFuCWcWp9LgVIf503ZnsixS3Grg.6706Ya"], ["phone_number", "0701234568"], ["full_name", "first user"], ["created_at", "2019-04-26 13:14:57.837669"], ["updated_at", "2019-04-26 13:14:57.837669"], ["jti", "805076ef-b5ee-4212-a8a8-18a91079353a"]]
  [1m[36mAccount Create (0.5ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-26 13:14:57.840859"], ["updated_at", "2019-04-26 13:14:57.840859"], ["owner_id", 126], ["owner_type", "User"]]
  [1m[36mAccount Load (0.7ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 126], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (1.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
------------------------------------------
UsersControllerTest: test_Can_signup_users
------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.0ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "usera@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234567"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "usera@domain.com"], ["encrypted_password", "$2a$04$6uHwxnx.abYAyxYRuMRFt.7.Lf.aM0Y5sFHAnYeIa3xUp8t8FRN4y"], ["phone_number", "0701234567"], ["full_name", "first user"], ["created_at", "2019-04-26 13:15:29.736943"], ["updated_at", "2019-04-26 13:15:29.736943"], ["jti", "5af31edb-70a3-4bf0-ac35-f5adf2a59975"]]
  [1m[36mAccount Create (0.8ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-26 13:15:29.758980"], ["updated_at", "2019-04-26 13:15:29.758980"], ["owner_id", 127], ["owner_type", "User"]]
  [1m[36mAccount Load (0.6ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 127], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/users" for 127.0.0.1 at 2019-04-26 13:15:29 +0000
Processing by UsersController#create as JSON
  Parameters: {"data"=>{"type"=>"users", "attributes"=>{"full_name"=>"some user", "phone_number"=>"0701234567", "email"=>"user100@domain.com", "password"=>"[FILTERED]"}}}
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user100@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234567"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 9ms (ActiveRecord: 1.6ms)
  [1m[35m (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------
UsersControllerTest: test_show_account_information
--------------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "userb@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234568"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "userb@domain.com"], ["encrypted_password", "$2a$04$gWXap0kdPzoYojFN6aXJ3OlFEd78aSIMeBQbgle3jOef8WKkONWyu"], ["phone_number", "0701234568"], ["full_name", "first user"], ["created_at", "2019-04-26 13:15:29.791113"], ["updated_at", "2019-04-26 13:15:29.791113"], ["jti", "841314be-ec01-4f16-be42-93e914660396"]]
  [1m[36mAccount Create (0.5ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-26 13:15:29.793186"], ["updated_at", "2019-04-26 13:15:29.793186"], ["owner_id", 128], ["owner_type", "User"]]
  [1m[36mAccount Load (0.4ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 128], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/users/181/account" for 127.0.0.1 at 2019-04-26 13:15:29 +0000
  [1m[35m (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
------------------------------------------
UsersControllerTest: test_Can_signup_users
------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.0ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "usera@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234567"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "usera@domain.com"], ["encrypted_password", "$2a$04$VUN6NtZJRoa8Fjn71KwbIO550yiR0IV4Wz4CvQi0d7Anq4KajyL0m"], ["phone_number", "0701234567"], ["full_name", "first user"], ["created_at", "2019-04-26 13:17:15.529537"], ["updated_at", "2019-04-26 13:17:15.529537"], ["jti", "6ffb304f-8eb9-4ea2-9c80-b6d2351c6cf2"]]
  [1m[36mAccount Create (0.9ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-26 13:17:15.549782"], ["updated_at", "2019-04-26 13:17:15.549782"], ["owner_id", 129], ["owner_type", "User"]]
  [1m[36mAccount Load (0.8ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 129], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/users" for 127.0.0.1 at 2019-04-26 13:17:15 +0000
Processing by UsersController#create as JSON
  Parameters: {"data"=>{"type"=>"users", "attributes"=>"{:full_name=>\"some user\", :phone_number=>\"0701234567\", :email=>\"user100@domain.com\", :password=>\"astrongpassword\"}"}}
Completed 500 Internal Server Error in 3ms (ActiveRecord: 0.0ms)
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------
UsersControllerTest: test_show_account_information
--------------------------------------------------
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "userb@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234568"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "userb@domain.com"], ["encrypted_password", "$2a$04$XVRiuCTnTJvbxF4KdAYoNujhr2icH.Qz5ovwDsNk7Qr6cDOjQn1Xq"], ["phone_number", "0701234568"], ["full_name", "first user"], ["created_at", "2019-04-26 13:17:15.578642"], ["updated_at", "2019-04-26 13:17:15.578642"], ["jti", "c82859e3-5ca1-4c57-be59-7a1428702098"]]
  [1m[36mAccount Create (0.4ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-26 13:17:15.580447"], ["updated_at", "2019-04-26 13:17:15.580447"], ["owner_id", 130], ["owner_type", "User"]]
  [1m[36mAccount Load (0.3ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 130], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------
UsersControllerTest: test_show_account_information
--------------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.0ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "usera@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234567"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "usera@domain.com"], ["encrypted_password", "$2a$04$Vpfj46f/QSgn45pm.W4KROJNV7rPaoytodVp0eSeoN9buo5F5A4FG"], ["phone_number", "0701234567"], ["full_name", "first user"], ["created_at", "2019-04-26 13:23:19.857797"], ["updated_at", "2019-04-26 13:23:19.857797"], ["jti", "9becd673-bd48-48e2-bf8f-b19033abe1d7"]]
  [1m[36mAccount Create (0.7ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-26 13:23:19.876077"], ["updated_at", "2019-04-26 13:23:19.876077"], ["owner_id", 131], ["owner_type", "User"]]
  [1m[36mAccount Load (0.3ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 131], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
------------------------------------------
UsersControllerTest: test_Can_signup_users
------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "userb@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234568"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "userb@domain.com"], ["encrypted_password", "$2a$04$6/N6DV0DAoOekz4jiSTdEOec7KsqSnOBF/O91AZ3tAMFzXxTJg/p."], ["phone_number", "0701234568"], ["full_name", "first user"], ["created_at", "2019-04-26 13:23:19.889185"], ["updated_at", "2019-04-26 13:23:19.889185"], ["jti", "8b12291c-c541-44e1-bce5-ddf0a1585ff8"]]
  [1m[36mAccount Create (0.8ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-26 13:23:19.892385"], ["updated_at", "2019-04-26 13:23:19.892385"], ["owner_id", 132], ["owner_type", "User"]]
  [1m[36mAccount Load (0.4ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 132], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/users" for 127.0.0.1 at 2019-04-26 13:35:55 +0000
Processing by UsersController#create as JSON
  Parameters: {"data"=>{"type"=>"users"}}
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" IS NULL LIMIT $1[0m  [["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 10ms (ActiveRecord: 1.0ms)
  [1m[35m (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (1.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------
UsersControllerTest: test_show_account_information
--------------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "usera@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234567"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "usera@domain.com"], ["encrypted_password", "$2a$04$mUlV4PkwHNNjjZ9CzbJQ/eNRuM0lJHxdBV8MP6dt40AwK0mcKXqkG"], ["phone_number", "0701234567"], ["full_name", "first user"], ["created_at", "2019-04-26 13:35:56.202466"], ["updated_at", "2019-04-26 13:35:56.202466"], ["jti", "28210c32-97c1-45d2-8105-bdc4a258f306"]]
  [1m[36mAccount Create (0.9ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-26 13:35:56.220203"], ["updated_at", "2019-04-26 13:35:56.220203"], ["owner_id", 133], ["owner_type", "User"]]
  [1m[36mAccount Load (0.6ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 133], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/users/133/account" for 127.0.0.1 at 2019-04-26 13:35:56 +0000
  [1m[35m (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
------------------------------------------
UsersControllerTest: test_Can_signup_users
------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "userb@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234568"], ["LIMIT", 1]]
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "userb@domain.com"], ["encrypted_password", "$2a$04$Pacmj.RvPOKb2ssrRoOzyuJIsYa33AnIgA/t6vQKPjKsGqyZD4orC"], ["phone_number", "0701234568"], ["full_name", "first user"], ["created_at", "2019-04-26 13:35:56.243455"], ["updated_at", "2019-04-26 13:35:56.243455"], ["jti", "dfdfde12-7bfc-4aa9-9dca-7999e4d1b676"]]
  [1m[36mAccount Create (0.6ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-26 13:35:56.245736"], ["updated_at", "2019-04-26 13:35:56.245736"], ["owner_id", 134], ["owner_type", "User"]]
  [1m[36mAccount Load (0.5ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 134], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (1.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (1.3ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------
UsersControllerTest: test_show_account_information
--------------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.2ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "usera@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234567"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "usera@domain.com"], ["encrypted_password", "$2a$04$wTjh8l0O4Oil2Tv4.XQgkupeL2wUDhMglxDJULBUL6YafHtrmNFeG"], ["phone_number", "0701234567"], ["full_name", "first user"], ["created_at", "2019-04-26 13:40:48.977111"], ["updated_at", "2019-04-26 13:40:48.977111"], ["jti", "78245e4b-edd5-4ff0-813c-4059a0ac63eb"]]
  [1m[36mAccount Create (0.7ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-26 13:40:48.995551"], ["updated_at", "2019-04-26 13:40:48.995551"], ["owner_id", 135], ["owner_type", "User"]]
  [1m[36mAccount Load (0.5ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 135], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/users/user_id/accounts.135" for 127.0.0.1 at 2019-04-26 13:40:49 +0000
Processing by UsersController#show as 
  [1m[36mUser Load (1.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" IS NULL ORDER BY "users"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
Completed 404 Not Found in 6ms (Views: 0.3ms | ActiveRecord: 1.3ms)
  [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
------------------------------------------
UsersControllerTest: test_Can_signup_users
------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "userb@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.3ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234568"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "userb@domain.com"], ["encrypted_password", "$2a$04$UhXYIj5BYn5ZeDPdyIqfEuAgUq7gU0YWjbW8ke9yic5Uh/ofDhGdq"], ["phone_number", "0701234568"], ["full_name", "first user"], ["created_at", "2019-04-26 13:40:49.032299"], ["updated_at", "2019-04-26 13:40:49.032299"], ["jti", "471e6f2a-e6e7-418e-a110-569a8b55e39e"]]
  [1m[36mAccount Create (0.5ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-26 13:40:49.034819"], ["updated_at", "2019-04-26 13:40:49.034819"], ["owner_id", 136], ["owner_type", "User"]]
  [1m[36mAccount Load (0.5ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 136], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (1.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------
UsersControllerTest: test_show_account_information
--------------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.9ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "usera@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234567"], ["LIMIT", 1]]
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "usera@domain.com"], ["encrypted_password", "$2a$04$FqX0X5hJReJOGdynQK6fT.y8Yu6kbJ7U3TXGLRn3xbuuYzncRmxJu"], ["phone_number", "0701234567"], ["full_name", "first user"], ["created_at", "2019-04-26 13:41:21.747805"], ["updated_at", "2019-04-26 13:41:21.747805"], ["jti", "55eb3d9a-6a0d-4d34-ade3-db5ea36f8439"]]
  [1m[36mAccount Create (0.9ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-26 13:41:21.771644"], ["updated_at", "2019-04-26 13:41:21.771644"], ["owner_id", 137], ["owner_type", "User"]]
  [1m[36mAccount Load (0.8ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 137], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/users/user_id/accounts.137" for 127.0.0.1 at 2019-04-26 13:41:34 +0000
Processing by UsersController#show as 
  [1m[36mUser Load (1.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" IS NULL ORDER BY "users"."id" ASC LIMIT $1[0m  [["LIMIT", 1]]
Completed 404 Not Found in 6ms (Views: 0.2ms | ActiveRecord: 1.4ms)
  [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
------------------------------------------
UsersControllerTest: test_Can_signup_users
------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.6ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "userb@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234568"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "userb@domain.com"], ["encrypted_password", "$2a$04$SWXZBldMhM/ZUxO3WQQ5oePVZZO/YTluxGOO1qXxLgYv/DjKWt436"], ["phone_number", "0701234568"], ["full_name", "first user"], ["created_at", "2019-04-26 13:41:34.406986"], ["updated_at", "2019-04-26 13:41:34.406986"], ["jti", "5d28813a-1744-4d8a-944a-7bd4b02baafd"]]
  [1m[36mAccount Create (0.7ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-26 13:41:34.410394"], ["updated_at", "2019-04-26 13:41:34.410394"], ["owner_id", 138], ["owner_type", "User"]]
  [1m[36mAccount Load (0.4ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 138], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (1.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
------------------------------------------
UsersControllerTest: test_Can_signup_users
------------------------------------------
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (1.0ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "usera@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234567"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "usera@domain.com"], ["encrypted_password", "$2a$04$m1YDZTYFE810jKnzH29amuhVDHcE4WSaMYh/RfylL1MitFRsaVYiG"], ["phone_number", "0701234567"], ["full_name", "first user"], ["created_at", "2019-04-26 14:52:47.409966"], ["updated_at", "2019-04-26 14:52:47.409966"], ["jti", "b47d315c-7f53-4fc5-8bd0-87bd39bac690"]]
  [1m[36mAccount Create (0.6ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-26 14:52:47.433547"], ["updated_at", "2019-04-26 14:52:47.433547"], ["owner_id", 139], ["owner_type", "User"]]
  [1m[36mAccount Load (0.5ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 139], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------
UsersControllerTest: test_show_account_information
--------------------------------------------------
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists (0.5ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "userb@domain.com"], ["LIMIT", 1]]
  [1m[36mUser Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "users" WHERE "users"."phone_number" = $1 LIMIT $2[0m  [["phone_number", "0701234568"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("email", "encrypted_password", "phone_number", "full_name", "created_at", "updated_at", "jti") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["email", "userb@domain.com"], ["encrypted_password", "$2a$04$3ZS1FNAH/8HvmSiqk.qGY.aIpqK1MFe43s54avR9GQaEYEHCTqNPy"], ["phone_number", "0701234568"], ["full_name", "first user"], ["created_at", "2019-04-26 14:52:47.445561"], ["updated_at", "2019-04-26 14:52:47.445561"], ["jti", "6ae70e68-08b6-48b0-9f96-3dbc77fb84f9"]]
  [1m[36mAccount Create (0.6ms)[0m  [1m[32mINSERT INTO "accounts" ("created_at", "updated_at", "owner_id", "owner_type") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2019-04-26 14:52:47.450727"], ["updated_at", "2019-04-26 14:52:47.450727"], ["owner_id", 140], ["owner_type", "User"]]
  [1m[36mAccount Load (0.3ms)[0m  [1m[34mSELECT  "accounts".* FROM "accounts" WHERE "accounts"."owner_id" = $1 AND "accounts"."owner_type" = $2 LIMIT $3[0m  [["owner_id", 140], ["owner_type", "User"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/users/user_id/accounts.140" for 127.0.0.1 at 2019-04-26 14:53:03 +0000
  [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
